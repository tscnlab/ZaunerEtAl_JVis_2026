<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Johannes Zauner">
<meta name="author" content="Aaron Nicholls">
<meta name="author" content="Lisa A. Ostrin">
<meta name="author" content="Manuel Spitschan">
<meta name="dcterms.date" content="2025-12-13">
<meta name="keywords" content="wearable, light logging, viewing-distance, visual experience, metrics, circadian, myopia, risk factors, spectral analysis, open-source, reproducibility">

<title>Analysis of human visual experience data</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-db0de7fc7be64a998c1447a8adc91d91.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Analysis of human visual experience data</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link active" href="./index.html" aria-current="page"> 
<span class="menu-text">Manuscript</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./supplement.html"> 
<span class="menu-text">Supplement</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/tscnlab/ZaunerEtAl_JVis_2026"> <i class="bi bi-github" role="img" aria-label="Quarto GitHub">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="2">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">1</span> Introduction</a></li>
  <li><a href="#methods-and-materials" id="toc-methods-and-materials" class="nav-link" data-scroll-target="#methods-and-materials"><span class="header-section-number">2</span> Methods and materials</a>
  <ul class="collapse">
  <li><a href="#software" id="toc-software" class="nav-link" data-scroll-target="#software"><span class="header-section-number">2.1</span> Software</a></li>
  <li><a href="#metric-selection-and-definitions" id="toc-metric-selection-and-definitions" class="nav-link" data-scroll-target="#metric-selection-and-definitions"><span class="header-section-number">2.2</span> Metric selection and definitions</a></li>
  <li><a href="#devices" id="toc-devices" class="nav-link" data-scroll-target="#devices"><span class="header-section-number">2.3</span> Devices</a></li>
  <li><a href="#data-processing-summary" id="toc-data-processing-summary" class="nav-link" data-scroll-target="#data-processing-summary"><span class="header-section-number">2.4</span> Data processing summary</a></li>
  </ul></li>
  <li><a href="#results" id="toc-results" class="nav-link" data-scroll-target="#results"><span class="header-section-number">3</span> Results</a>
  <ul class="collapse">
  <li><a href="#distance" id="toc-distance" class="nav-link" data-scroll-target="#distance"><span class="header-section-number">3.1</span> Distance</a></li>
  <li><a href="#light" id="toc-light" class="nav-link" data-scroll-target="#light"><span class="header-section-number">3.2</span> Light</a></li>
  <li><a href="#spectrum" id="toc-spectrum" class="nav-link" data-scroll-target="#spectrum"><span class="header-section-number">3.3</span> Spectrum</a></li>
  </ul></li>
  <li><a href="#discussion-and-conclusion" id="toc-discussion-and-conclusion" class="nav-link" data-scroll-target="#discussion-and-conclusion"><span class="header-section-number">4</span> Discussion and conclusion</a></li>
  <li><a href="#sessioninfo" id="toc-sessioninfo" class="nav-link" data-scroll-target="#sessioninfo"><span class="header-section-number">5</span> Session info</a></li>
  <li><a href="#statements" id="toc-statements" class="nav-link" data-scroll-target="#statements"><span class="header-section-number">6</span> Statements</a>
  <ul class="collapse">
  <li><a href="#data-availability-statement" id="toc-data-availability-statement" class="nav-link" data-scroll-target="#data-availability-statement"><span class="header-section-number">6.1</span> Data availability statement</a></li>
  <li><a href="#funding-statement" id="toc-funding-statement" class="nav-link" data-scroll-target="#funding-statement"><span class="header-section-number">6.2</span> Funding statement</a></li>
  <li><a href="#conflict-of-interest-statement" id="toc-conflict-of-interest-statement" class="nav-link" data-scroll-target="#conflict-of-interest-statement"><span class="header-section-number">6.3</span> Conflict of interest statement</a></li>
  <li><a href="#statement-of-generative-ai-and-ai-assisted-technologies-in-the-writing-process" id="toc-statement-of-generative-ai-and-ai-assisted-technologies-in-the-writing-process" class="nav-link" data-scroll-target="#statement-of-generative-ai-and-ai-assisted-technologies-in-the-writing-process"><span class="header-section-number">6.4</span> Statement of generative AI and AI-assisted technologies in the writing process</a></li>
  </ul></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references"><span class="header-section-number">7</span> References</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/tscnlab/ZaunerEtAl_JVis_2026/edit/main/index.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/tscnlab/ZaunerEtAl_JVis_2026/issues" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Analysis of human visual experience data</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Authors</div>
  <div class="quarto-title-meta-heading">Affiliations</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author">Johannes Zauner <a href="mailto:johannes.zauner@tum.de" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> <a href="https://orcid.org/0000-0003-2171-4566" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            Technical University of Munich, Germany
          </p>
        <p class="affiliation">
            Max Planck Institute for Biological Cybernetics, Germany
          </p>
      </div>
    <div class="quarto-title-meta-contents">
    <p class="author">Aaron Nicholls <a href="https://orcid.org/0009-0001-6683-6826" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            Reality Labs Research, USA
          </p>
      </div>
    <div class="quarto-title-meta-contents">
    <p class="author">Lisa A. Ostrin <a href="https://orcid.org/0000-0001-8675-1478" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            University of Houston College of Optometry, USA
          </p>
      </div>
    <div class="quarto-title-meta-contents">
    <p class="author">Manuel Spitschan <a href="https://orcid.org/0000-0002-8572-9268" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            Technical University of Munich, Germany
          </p>
        <p class="affiliation">
            Max Planck Institute for Biological Cybernetics, Germany
          </p>
        <p class="affiliation">
            Technical University of Munich, Institute for Advanced Study (TUM-IAS), Germany
          </p>
      </div>
  </div>

<div class="quarto-title-meta">

      
    <div>
    <div class="quarto-title-meta-heading">Last modified:</div>
    <div class="quarto-title-meta-contents">
      <p class="date">December 13, 2025</p>
    </div>
  </div>
  
    
    <div>
    <div class="quarto-title-meta-heading">Doi</div>
    <div class="quarto-title-meta-contents">
      <p class="doi">
        <a href="https://doi.org/10.5281/zenodo.16566014">10.5281/zenodo.16566014</a>
      </p>
    </div>
  </div>
  </div>
  
<div>
  <div class="abstract">
    <div class="block-title">Abstract</div>
    <p>Exposure to the optical environment — often referred to as <em>visual experience</em> — profoundly influences human physiology and behavior across multiple time scales. In controlled laboratory settings, stimuli can be held constant or manipulated parametrically. However, such exposures rarely replicate real-world conditions, which are inherently complex and dynamic, generating high-dimensional datasets that demand rigorous and flexible analysis strategies. This tutorial presents an analysis pipeline for visual experience datasets, with a focus on reproducible workflows for human chronobiology and myopia research. Light exposure and its retinal encoding affect human physiology and behavior across multiple time scales. Here we provide step-by-step instructions for importing, visualizing, and processing viewing distance and light exposure data. This includes time-series analyses for working distance, biologically relevant light metrics, and spectral characteristics. The tasks are standardized through the open-source R package <a href="https://tscnlab.github.io/LightLogR/"><strong>LightLogR</strong></a>. By leveraging a modular approach, the tutorial supports researchers in building flexible and robust pipelines that accommodate diverse experimental paradigms and measurement systems.</p>
  </div>
</div>

<div>
  <div class="keywords">
    <div class="block-title">Keywords</div>
    <p>wearable, light logging, viewing-distance, visual experience, metrics, circadian, myopia, risk factors, spectral analysis, open-source, reproducibility</p>
  </div>
</div>

</header>


<section id="introduction" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="introduction"><span class="header-section-number">1</span> Introduction</h2>
<p><a href="assets/abstract_med.gif" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="assets/abstract_med.gif" class="img-fluid" style="width:40.0%"></a></p>
<p>Exposure to the optical environment — often referred to as <em>visual experience</em> — profoundly influences human physiology and behavior across multiple time scales. Two notable examples, from distinct research domains, can be understood through a common retinally-referenced framework.</p>
<p>The first example relates to the non-visual effects of light on human circadian and neuroendocrine physiology. The light–dark cycle entrains the circadian clock, and light exposure at night suppresses melatonin production <span class="citation" data-cites="Brown2022PLoSBiol Blume2019Somnologie">(<a href="#ref-Brown2022PLoSBiol" role="doc-biblioref">Brown et al. 2022</a>; <a href="#ref-Blume2019Somnologie" role="doc-biblioref">Blume, Garbazza, and Spitschan 2019</a>)</span>. The second example concerns the influence of visual experience on ocular development, particularly myopia. Time spent outdoors — which features distinct optical environments — has been consistently associated with protective effects on ocular growth and health outcomes <span class="citation" data-cites="DahlmannNoor2025GraefesArchClinExpOphthal">(<a href="#ref-DahlmannNoor2025GraefesArchClinExpOphthal" role="doc-biblioref">Dahlmann-Noor et al. 2025</a>)</span>.</p>
<p>In controlled laboratory settings, light exposure can be held constant or manipulated parametrically. In contrast, real-world conditions are inherently complex and dynamic, and cannot be captured by single spot measurements. As people move in and between spaces (indoors and outdoors) and move their body, head, and eyes, exposure to the optical environment varies significantly <span class="citation" data-cites="Webler2019CurrOpinBehavSci">(<a href="#ref-Webler2019CurrOpinBehavSci" role="doc-biblioref">Webler et al. 2019</a>)</span> and is modulated by behavior <span class="citation" data-cites="Biller2024CommunPsychol">(<a href="#ref-Biller2024CommunPsychol" role="doc-biblioref">Biller, Balakrishnan, and Spitschan 2024</a>)</span>. Wearable devices for measuring light exposure have thus emerged as vital tools to capture the ecological visual experience. These tools generate high-dimensional datasets that demand rigorous and flexible analysis strategies.</p>
<p>Starting in the 1980s <span class="citation" data-cites="Okudaira1983AmJPhysiol">(<a href="#ref-Okudaira1983AmJPhysiol" role="doc-biblioref">Okudaira, Kripke, and Webster 1983</a>)</span>, technology to measure optical exposure has matured, with miniaturized illuminance sensors now (in 2025) very common in consumer wearables <span class="citation" data-cites="vanDuijnhoven2025BuildEnviron">(<a href="#ref-vanDuijnhoven2025BuildEnviron" role="doc-biblioref">van Duijnhoven et al. 2025</a>)</span>. In research, several devices are available that differ in functionality, ranging from small pins measuring ambient illuminance <span class="citation" data-cites="Mohamed2021OptExpress">(<a href="#ref-Mohamed2021OptExpress" role="doc-biblioref">Mohamed et al. 2021</a>)</span> to head-mounted multi-modal devices capturing nearly all relevant aspects of visual experience <span class="citation" data-cites="Gibaldi2024TranslVisSciTechnol">(<a href="#ref-Gibaldi2024TranslVisSciTechnol" role="doc-biblioref">Gibaldi et al. 2024</a>)</span>. Increased capabilities in wearables bring complex, dense datasets. These go hand-in-hand with a proliferation of metrics, as highlighted by recent review papers in both circadian and myopia research <span class="citation" data-cites="Honekopp2023ClinOphthalmol Hartmeyer2023LightResTechnol">(<a href="#ref-Honekopp2023ClinOphthalmol" role="doc-biblioref">Hönekopp and Weigelt 2023</a>; <a href="#ref-Hartmeyer2023LightResTechnol" role="doc-biblioref">Hartmeyer and Andersen 2023</a>)</span>.</p>
<p>At present, the analysis processes to derive metrics are often implemented on a per-laboratory or even per-researcher basis. This fragmentation is a potential source of errors and inconsistencies between studies, consumes considerable researcher time <span class="citation" data-cites="Hartmeyer2022LightResTechnol">(<a href="#ref-Hartmeyer2022LightResTechnol" role="doc-biblioref">Hartmeyer, Webler, and Andersen 2022</a>)</span>, and these bespoke processes and formats hinder harmonization or meta-analysis across multiple studies. It is very common that more time is spent preparing data than gaining insights through rigorous statistical analysis. These preparation tasks are best handled, or at least facilitated, by standardized, transparent, community-based analysis pipelines <span class="citation" data-cites="Zauner2024PLOSONE">(<a href="#ref-Zauner2024PLOSONE" role="doc-biblioref">J. Zauner, Udovicic, and Spitschan 2024</a>)</span>.</p>
<p>In circadian research, the R package LightLogR was developed to address this need <span class="citation" data-cites="Zauner2025JOpenSourceSoftw">(<a href="#ref-Zauner2025JOpenSourceSoftw" role="doc-biblioref">J. Zauner, Hartmeyer, and Spitschan 2025</a>)</span>. LightLogR is an open-source, MIT-licensed, community-driven package specifically designed for data from wearable light loggers and optical radiation dosimeters. It contains functions to calculate over sixty different metrics used in the field <span class="citation" data-cites="Hartmeyer2023LightResTechnol">(<a href="#ref-Hartmeyer2023LightResTechnol" role="doc-biblioref">Hartmeyer and Andersen 2023</a>)</span>. The package functions come with light-related defaults, but they remain fundamentally agnostic to modality. As a result, parameters like viewing distance and light spectra, both highly relevant to myopia research <span class="citation" data-cites="Honekopp2023ClinOphthalmol">(<a href="#ref-Honekopp2023ClinOphthalmol" role="doc-biblioref">Hönekopp and Weigelt 2023</a>)</span>, can easily be handled.</p>
<p>In this article, we demonstrate that LightLogR’s analysis pipelines and metric functions apply broadly across the field of visual experience research, not just to circadian rhythms and chronobiology. Our approach is modular and extensible, allowing researchers to adapt it to a variety of devices and research questions. Emphasis is placed on clarity, transparency, and reproducibility, aligning with best practices in scientific computing and open science. We use example data from two devices (worn by different individuals and at different times) to showcase the LightLogR workflow with metrics relevant to myopia research, covering working distance, (day)light exposure, and spectral analysis. Readers are encouraged to recreate the analysis using the provided code. All necessary data and code are openly available in the <a href="https://github.com/tscnlab/ZaunerEtAl_JVis_2026">GitHub repository</a>.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Scope
</div>
</div>
<div class="callout-body-container callout-body">
<p>This article focuses on workflows for deriving condensed metrics from time-series data collected with wearable devices in the visual-experience domain. Specifically, we address illuminance, viewing distance, and spectral irradiance. Example datasets from two types of wearable devices are used for illustration.</p>
<p>Many relevant considerations arise when collecting data with wearable devices. This article covers only a subset of these. In particular, it does not address:</p>
<ul>
<li>device selection (see, e.g., <span class="citation" data-cites="vanDuijnhoven2025BuildEnviron Zauner2025LightResTech">(<a href="#ref-vanDuijnhoven2025BuildEnviron" role="doc-biblioref">van Duijnhoven et al. 2025</a>; <a href="#ref-Zauner2025LightResTech" role="doc-biblioref">Johannes Zauner, Stefani, et al. 2025</a>)</span>)</li>
<li>measurement accuracy or device calibration</li>
<li>auxiliary data such as sleep/wake information (see, e.g., <span class="citation" data-cites="Zauner2025npj Guidolin2025BehavResMethods">(<a href="#ref-Zauner2025npj" role="doc-biblioref">J. Zauner et al. 2025</a>; <a href="#ref-Guidolin2025BehavResMethods" role="doc-biblioref">Guidolin et al. 2024</a>)</span>)</li>
</ul>
<p>More information on those aspects can be found in the <a href="https://doi.org/10.17617/6xca-cg59"><em>Technical guide for wearable optical radiation dosimetry and visual experience assessment</em></a> <span class="citation" data-cites="zauner2025">(<a href="#ref-zauner2025" role="doc-biblioref">Johannes Zauner, Baraas, et al. 2025</a>)</span>.</p>
<p>To demonstrate the workflows, this article uses expert-informed definitions of metrics and metric parameters (see, e.g., <a href="#tbl-one" class="quarto-xref">Table&nbsp;1</a>, <a href="#tbl-two" class="quarto-xref">Table&nbsp;2</a>, and the non-wear detection rules based on activity data described in <a href="./supplement.html">Supplement&nbsp;1</a>). These definitions and thresholds should not be interpreted as universal standards, nor are they hard-coded into the software package. For any application, parameter choices must be tailored to the research domain, study context and design, and the specifications of the wearable device.</p>
<p>Further, the article is split up in the main analysis part, where all metrics are calculated, and the <a href="./supplement.html">Supplement&nbsp;1</a>, where data is imported, screened, and prepared. Thus, the reader is referred to <a href="./supplement.html">Supplement&nbsp;1</a> for all aspects regarding data formats, preparation steps, and handling of gaps, i.e., missing data.</p>
<p>Lastly, the example data used in the article do not stem from a controlled experimental data collection but consist of pilot data gathered in an ecological setting without a fixed protocol. Given the substantial interindividual differences in visual experience metrics, and because the analyses focus on one participant at a time, the reported results should be interpreted as illustrative rather than representative of typical or population-level values.</p>
</div>
</div>
</section>
<section id="methods-and-materials" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="methods-and-materials"><span class="header-section-number">2</span> Methods and materials</h2>
<section id="software" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="software"><span class="header-section-number">2.1</span> Software</h3>
<p>This tutorial was built with <code>Quarto</code>, an open-source scientific and technical publishing system that integrates text, code, and code output into a single document. The source code to reproduce all results is included and accessible via the Quarto document’s <code>code tool</code> menu. All analyses were conducted in R (version 4.5.0, “How About a Twenty-Six”) using <code>LightLogR</code> (version&nbsp;0.10.0 “High noon”). We also used the <code>tidyverse</code> suite (version&nbsp;2.0.0) for data manipulation (which LightLogR follows in its design), and the <code>gt</code> package (version&nbsp;1.1.0) for generating summary tables. A comprehensive overview of the R computing environment is provided in the session info (see <a href="#sessioninfo">Session info</a> section).</p>
</section>
<section id="metric-selection-and-definitions" class="level3" data-number="2.2">
<h3 data-number="2.2" class="anchored" data-anchor-id="metric-selection-and-definitions"><span class="header-section-number">2.2</span> Metric selection and definitions</h3>
<p>In March 2025, two workshops with myopia researchers — initiated by the Research Data Alliance (RDA) Working Group on Optical Radiation Exposure and Visual Experience Data — focused on current needs and future opportunities in data analysis, including the development and standardization of metrics. Based on expert input from these workshops, the authors of this tutorial compiled a list of visual experience metrics, shown in <a href="#tbl-one" class="quarto-xref">Table&nbsp;1</a>. These include many currently used metrics and definitions <span class="citation" data-cites="Wen2020bjophthalmol Wen2019TransVisSciTech Bhandari2020OphthalmicPhysiolOpt Williams2019Scientificreports">(<a href="#ref-Wen2020bjophthalmol" role="doc-biblioref">Wen et al. 2020</a>, <a href="#ref-Wen2019TransVisSciTech" role="doc-biblioref">2019</a>; <a href="#ref-Bhandari2020OphthalmicPhysiolOpt" role="doc-biblioref">Bhandari and Ostrin 2020</a>; <a href="#ref-Williams2019Scientificreports" role="doc-biblioref">Williams et al. 2019</a>)</span>, as well as new metrics enabled by spectrally-resolved measurements. While they are not derived by a formal consensus process, they are expert-informed and used in current scientific research, and thus will serve as example-definitions for metrics and thresholds throughout this article.</p>
<div id="tbl-one" class="hover bordered quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-one-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: Overview of metrics as they are used in this article. In all cases, the averages for weekday, weekend, and the mean daily value are calculated through [mean_daily](<a href="https://tscnlab.github.io/LightLogR/reference/mean_daily.html" class="uri">https://tscnlab.github.io/LightLogR/reference/mean_daily.html</a>).
</figcaption>
<div aria-describedby="tbl-one-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table-hover table-bordered caption-top table">
<thead>
<tr class="header">
<th>No.</th>
<th>Name</th>
<th>Implementation<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
<td><strong>Distance</strong></td>
<td></td>
</tr>
<tr class="even">
<td>1</td>
<td>Total wear time daily</td>
<td><a href="https://tscnlab.github.io/LightLogR/reference/durations.html">durations()</a></td>
</tr>
<tr class="odd">
<td>2</td>
<td><p>Duration of<br>
<em>Near work,<br>
Intermediate Work,<br>
Near + Intermediate Work,</em> or</p>
<p>per each <em>Distance range</em><br>
(10cm steps)</p></td>
<td><p>filter for distance range +</p>
<p><a href="https://tscnlab.github.io/LightLogR/reference/durations.html">durations()</a> (for single ranges)</p>
<p>or</p>
<p>grouping by distance range +</p>
<p><a href="https://tscnlab.github.io/LightLogR/reference/durations.html">durations()</a> (for all ranges)</p></td>
</tr>
<tr class="even">
<td>3</td>
<td>Frequency of<br>
<em>Continuous near work</em></td>
<td><p><a href="https://tscnlab.github.io/LightLogR/reference/extract_clusters.html">extract_clusters()</a> +</p>
<p><a href="https://tscnlab.github.io/LightLogR/reference/summarize_numeric.html">summarize_numeric()</a></p></td>
</tr>
<tr class="odd">
<td>4</td>
<td>Frequency,<br>
duration,<br>
and distances of<br>
<em>Near Work episodes</em></td>
<td><p><a href="https://tscnlab.github.io/LightLogR/reference/extract_clusters.html">extract_clusters()</a> +</p>
<p><a href="https://tscnlab.github.io/LightLogR/reference/extract_metric.html">extract_metric()</a> +</p>
<p><a href="https://tscnlab.github.io/LightLogR/reference/summarize_numeric.html">summarize_numeric()</a></p></td>
</tr>
<tr class="even">
<td>5</td>
<td>Frequency and duration of <em>Visual breaks</em></td>
<td><p><a href="https://tscnlab.github.io/LightLogR/reference/extract_clusters.html">extract_clusters()</a> +</p>
<p>filter</p></td>
</tr>
<tr class="odd">
<td></td>
<td><strong>Light</strong></td>
<td></td>
</tr>
<tr class="even">
<td>6</td>
<td>Light exposure (in lux)</td>
<td><a href="https://tscnlab.github.io/LightLogR/reference/summarize_numeric.html">summarize_numeric()</a></td>
</tr>
<tr class="odd">
<td>7</td>
<td>Duration per <em>Outdoor range</em></td>
<td><p>grouping by Outdoor range +</p>
<p><a href="https://tscnlab.github.io/LightLogR/reference/durations.html">durations()</a></p></td>
</tr>
<tr class="even">
<td>8</td>
<td>The number of times light level changes from indoor (&lt;1000 lx) to outdoor (&gt;1000 lx)</td>
<td><p><a href="https://tscnlab.github.io/LightLogR/reference/extract_states.html">extract_states()</a> +</p>
<p><a href="https://tscnlab.github.io/LightLogR/reference/summarize_numeric.html">summarize_numeric()</a></p></td>
</tr>
<tr class="odd">
<td>9</td>
<td>Longest period above 1000 lx</td>
<td><a href="https://tscnlab.github.io/LightLogR/reference/period_above_threshold.html">period_above_threshold()</a></td>
</tr>
<tr class="even">
<td></td>
<td><strong>Spectrum</strong></td>
<td></td>
</tr>
<tr class="odd">
<td>10</td>
<td>Ratio of short vs.&nbsp;long wavelength light</td>
<td><p><a href="https://tscnlab.github.io/LightLogR/reference/spectral_integration.html">spectral_integration()</a> +</p>
<p><a href="https://tscnlab.github.io/LightLogR/reference/summarize_numeric.html">summarize_numeric()</a></p></td>
</tr>
<tr class="even">
<td>11</td>
<td>Melanopic daylight efficacy ratio (MDER)</td>
<td><p><a href="https://tscnlab.github.io/LightLogR/reference/spectral_integration.html">spectral_integration()</a> +</p>
<p><a href="https://tscnlab.github.io/LightLogR/reference/summarize_numeric.html">summarize_numeric()</a></p></td>
</tr>
<tr class="odd">
<td>12</td>
<td>Short-wavelength light at certain times of day</td>
<td><p><a href="https://tscnlab.github.io/LightLogR/reference/spectral_integration.html">spectral_integration()</a> +</p>
<p><a href="https://tscnlab.github.io/LightLogR/reference/filter_Time.html">filter_Time()</a> (for defined times) or<br>
<a href="https://tscnlab.github.io/LightLogR/reference/cut_Datetime.html">cut_Datetime()</a> (for regular time intervals) or<br>
<a href="https://tscnlab.github.io/LightLogR/reference/photoperiod.html">add_photoperiod()</a> (for solar times) +</p>
<p>grouping by time state +</p>
<p><a href="https://tscnlab.github.io/LightLogR/reference/summarize_numeric.html">summarize_numeric()</a></p></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p><a href="#tbl-two" class="quarto-xref">Table&nbsp;2</a> provides definitions for the terms used in <a href="#tbl-one" class="quarto-xref">Table&nbsp;1</a>. Note that specific definitions may vary depending on the research question or device capabilities.</p>
<div id="tbl-two" class="hover bordered quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-two-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;2: Definitions of mean daily and conditions for distance and illuminance calculation as used in the article
</figcaption>
<div aria-describedby="tbl-two-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table-hover table-bordered caption-top table">
<colgroup>
<col style="width: 10%">
<col style="width: 89%">
</colgroup>
<thead>
<tr class="header">
<th>Metric</th>
<th>Description / pseudo formula</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Total wear time</td>
<td><span class="math inline">\(\sum(t)*dt, \textrm{ where } t\textrm{: valid observations }\)</span></td>
</tr>
<tr class="even">
<td>Mean daily</td>
<td><span class="math inline">\(\frac{5*\bar{\textrm{weekday}} + 2*\bar{weekend}}{7}\)</span></td>
</tr>
<tr class="odd">
<td>Near work</td>
<td><span class="math inline">\(\textrm{working distance}, [15,60)cm\)</span></td>
</tr>
<tr class="even">
<td>Intermediate Work</td>
<td><span class="math inline">\(\textrm{working distance}, [60,100)cm\)</span></td>
</tr>
<tr class="odd">
<td>Total work<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></td>
<td><span class="math inline">\(\textrm{working distance}, [15,120)cm\)</span></td>
</tr>
<tr class="even">
<td>Distance range</td>
<td><span class="math inline">\(\textrm{working distance}, {[15,20)cm \textrm{,  Extremely near} \\ [20,30)cm \textrm{,  Very near} \\ [30,40)cm \textrm{,  Fairly near} \\ [40,50)cm \textrm{,  Near} \\ [50,60)cm \textrm{,  Moderately near} \\ [60,70)cm \textrm{,  Near intermediate} \\ [70,80)cm \textrm{,  Intermediate} \\ [80,90)cm \textrm{,  Moderately intermediate} \\ [90,100)cm \textrm{,  Far intermediate}}\)</span></td>
</tr>
<tr class="odd">
<td>Continuous near work</td>
<td><p><span class="math inline">\(\textrm{working distance}, [20,60)cm,\)</span></p>
<p><span class="math inline">\(T_\textrm{duration} ≥ 30 minutes, \textrm{ }T_{interruptions} ≤ 1 minute\)</span></p></td>
</tr>
<tr class="even">
<td>Near work episodes</td>
<td><p><span class="math inline">\(\textrm{working distance}, [20,60)cm,\)</span></p>
<p><span class="math inline">\(T_\textrm{interruptions} ≤ 20 seconds\)</span></p></td>
</tr>
<tr class="odd">
<td>Ratio of daily near work</td>
<td><span class="math inline">\(\frac{T_\textrm{near work}}{T_\textrm{total wear}}\)</span></td>
</tr>
<tr class="even">
<td>Visual break</td>
<td><span class="math inline">\(\textrm{working distance} ≥ 100cm, \\ T_\textrm{duration} ≥ 20 seconds, \textrm{ }T_\textrm{previous episode} ≤ 20 minutes\)</span></td>
</tr>
<tr class="odd">
<td>Outdoor range</td>
<td><span class="math inline">\(\textrm{illuminance}, {[1000,2000)lx \textrm{,  Outdoor bright} \\ [2000,3000)lx \textrm{,  Outdoor very bright} \\ [3000, \infty) lx \textrm{,  Outdoor extremely bright}}\)</span></td>
</tr>
<tr class="even">
<td>Light exposure<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a></td>
<td><span class="math inline">\(\bar{illuminance}\)</span></td>
</tr>
<tr class="odd">
<td>Spectral bands</td>
<td><span class="math inline">\(\textrm{spectral irradiance}, {[380,500]nm \textrm{,  short wavelength light} \\ [600, 780]nm \textrm{,  long wavelength light}}\)</span></td>
</tr>
<tr class="even">
<td>Ratio of short vs.&nbsp;long wavelength light</td>
<td><span class="math inline">\(\frac{E_{e\textrm{,short wavelength}}}{E_{e\textrm{,long wavelength}}}\)</span></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>It should be noted that although daylight levels can far exceed the thresholds defined in <a href="#tbl-two" class="quarto-xref">Table&nbsp;2</a> - and may reach or even exceed 10^5 lux - empirical daylight levels measured at eye level are much lower, typically around 10^3 lux, especially when considering aggregated time-series data over minutes to hours.</p>
</section>
<section id="devices" class="level3" data-number="2.3">
<h3 data-number="2.3" class="anchored" data-anchor-id="devices"><span class="header-section-number">2.3</span> Devices</h3>
<p>Data from two wearable devices are used in this analysis:</p>
<ul>
<li><p><code>Clouclip</code>: A wearable device that measures viewing distance and ambient light simultaneously [Glasson Technology Co., Ltd, Hangzhou, China; <span class="citation" data-cites="Wen2021ActaOphtalmol">Wen et al. (<a href="#ref-Wen2021ActaOphtalmol" role="doc-biblioref">2021</a>)</span>; <span class="citation" data-cites="Wen2020bjophthalmol">Wen et al. (<a href="#ref-Wen2020bjophthalmol" role="doc-biblioref">2020</a>)</span>]. The Clouclip provides a simple data output with only distance (working distance, in centimeters) and illuminance (ambient light, in lux). Data in our example were recorded at 5-second intervals. Approximately one week of data (~120,960 observations) is about 1.6&nbsp;MB in size.</p></li>
<li><p><code>Visual Environment Evaluation Tool</code> (VEET): A head-mounted multi-modal device that logs multiple data streams [Reality Labs Research, Menlo Park, CA, USA; <span class="citation" data-cites="Sah2025OphtalmicPhysiolOpt">Sah, Narra, and Ostrin (<a href="#ref-Sah2025OphtalmicPhysiolOpt" role="doc-biblioref">2025</a>)</span>; <span class="citation" data-cites="Sullivan2024">Sullivan et al. (<a href="#ref-Sullivan2024" role="doc-biblioref">2024</a>)</span>]. The VEET dataset used here contains simultaneous measurements of distance (via a time-of-flight sensor), ambient light (illuminance), activity (accelerometer &amp; gyroscope), and spectral irradiance (multi-channel light sensor). Data were recorded at 2-second intervals, yielding a very dense dataset (~270&nbsp;MB per week).</p></li>
</ul>
</section>
<section id="data-processing-summary" class="level3" data-number="2.4">
<h3 data-number="2.4" class="anchored" data-anchor-id="data-processing-summary"><span class="header-section-number">2.4</span> Data processing summary</h3>
<p>The <a href="#results">Results</a> section uses imported and pre-processed data from the two devices to calculate metrics. <a href="./supplement.html">Supplement&nbsp;1</a> contains the annotated code and description for the steps involved. The following summarizes the steps involved, please refer to the supplement for details:</p>
<p><strong>Data import:</strong> We imported raw data from the <code>Clouclip</code> and <code>VEET</code> devices using LightLogR’s built-in import functions, which automatically handle device-specific formats and idiosyncrasies.</p>
<p>The <code>Clouclip</code> export file (provided as a tab-delimited text file) contains timestamped records of distance (cm) and illuminance (lux). LightLogR’s <code>import$Clouclip</code> function reads this file, after specifying the device’s recording timezone, and converts device-specific sentinel codes into proper missing values. For instance, the Clouclip uses special numeric codes to indicate when it is in “sleep mode” or when a reading is out of the sensor’s range, rather than recording a normal value. LightLogR identifies <code>-1</code> (for both distance and lux) as indicating the device’s sleep mode and <code>204</code> (for distance) as indicating the object was beyond the measurable range, replacing these with <code>NA</code> and logging their status in separate columns. The import routine also provides an initial summary of the dataset, including start and end times and any irregular sampling intervals or gaps.</p>
<p>For the <code>VEET</code> device, data were provided as CSV logs (zipped on Github, due to size). We focused on the ambient light sensor modality first. Using <code>import$VEET(..., modality = "ALS")</code>, we extracted the illuminance (<code>Lux</code>) data stream and its timestamps. The raw VEET data similarly contains irregular intervals and can contain missing periods (e.g., if the device stopped recording or was reset); the import summary flags these issues.</p>
<p>Besides the <code>Clouclip</code> and <code>VEET</code>, LightLogR 0.10.0 contains import functions for 18 more wearable devices. The package further supports versions due to evolving data formats, and includes documentation for both <a href="https://tscnlab.github.io/LightLogR/reference/import_adjustment.html">code-based</a> and <a href="https://tscnlab.github.io/LightLogR/articles/Import.html#from-which-devices-can-i-import-data">code-less</a> additions of new device import-functions.</p>
<p><strong>Irregular intervals, gaps, non-wear times:</strong> Both datasets showed irregular timing and missing data, i.e., gaps. Irregular data means that some observations did not align to the nominal sampling interval (e.g., slight timing drift or pauses in recording). For the <code>Clouclip</code> 5-second data, we detected irregular timestamps spanning all but the first and last day of the recording. Handling such irregularities is important because many downstream analyses assume a regular time series. We evaluated strategies to address this, including:</p>
<ul>
<li><p>Removing an initial portion of data if irregularities occur mainly during device start-up.</p></li>
<li><p>Rounding all timestamps to the nearest regular interval (5&nbsp;s in this case).</p></li>
<li><p>Aggregating to a coarser time interval (with some loss of temporal resolution).</p></li>
</ul>
<p>Based on the import summary and visual inspection of the time gaps, we chose to round the observation times to the nearest 5-second mark, as this addressed the minor offsets without significant data loss. After rounding timestamps, we added an explicit date column for convenient grouping by day.</p>
<p>We then generated a summary of missing data for each day. Implicit gaps (intervals where the device should have recorded data but did not) were converted into explicit missing entries using LightLogR’s gap-handling functions. We also removed days that had very little data to focus on days with substantial wear time. In our <code>Clouclip</code> example, days with &lt;1&nbsp;hour of recordings were dropped. This threshold should be adjusted based on how much complete days matter for a given analysis at hand. E.g., in circadian science, the metrics of <em>interdaily stability</em> and <em>intradaily variation</em> require measurements for each hour of the day.</p>
<p>After these preprocessing steps, the <code>Clouclip</code> dataset had no irregular timestamps remaining and contained explicit markers for all periods of missing data (e.g., times when the device was off or not worn). The distance and illuminance values were now ready for metric calculations. Because the device was put in <code>sleep mode</code> when not worn, there are no measurements during non-wear times.</p>
<p>The <code>VEET</code> illuminance data underwent a similar cleaning procedure. To make the <code>VEET</code>’s 2-second illuminance data more comparable to the <code>Clouclip</code>’s and to reduce computational load, we aggregated the illuminance time series to 5-second intervals. Aggregation was performed with the arithmetic mean of values in a 5-second bin. We then inserted explicit missing entries for each whole day and removed days with more than one hour of missing illuminance data. After cleaning, six days of <code>VEET</code> illuminance data with good coverage remained for analysis (see <a href="./supplement.html">Supplement 1</a> for details).</p>
<p>Finally, for spectral analysis, we imported the <code>VEET</code>’s spectral sensor modality, and, for the distance analysis, the time-of-flight modality. This required additional processing: the raw spectral data consists of counts from 10 wavelength-specific channels (approximately 415&nbsp;nm through 940&nbsp;nm, unequally spaced between 30 and 50 nm, plus one broadband clear channel covering the whole range of individual channels and a dark channel) along with a sensor gain setting. We aggregated the spectral data to 5-minute intervals to focus on broader trends and reduce data volume. Each channel’s counts were normalized by the appropriate gain. Using a calibration matrix provided by the manufacturer (specific to the spectral sensor model), we reconstructed full spectral power distributions for each 5-minute interval. The end result is a list-column in the dataset where each entry is the estimated spectral irradiance across wavelengths for that time interval. Detailed spectral preprocessing steps, including the calibration and normalization, are provided in the <a href="./supplement.html">Supplement 1</a>. After spectral reconstruction, the dataset was ready for calculating example spectrum-based metrics.</p>
<p>Similarly, the time-of-flight modality contains 256 values per observation, encoding an 8x8 grid of distance and confidence measurements for up to two objects (8x8 grid, times two objects, times distance + confidence column for each object and grid point -&gt; 256 values). For computational reasons, only the first object was kept. These data were pivoted into a long format, where each row contains the distance and confidence data for a given position in the grid and a given datetime. After pivoting and converting grid positions into a deviation angle from central view, the dataset was ready to be used for distance analysis.</p>
<p>Because the <code>VEET</code> devices record even when not worn, a non-wear detection using the devices’ actigraphy modality was implemented. This process used the standard deviation of a linear motion sensor in a 5-minute bin with a visually derived threshold to separate wear from non-wear time. Measurements of illuminance and distance were consequently removed during the calculated non-wear times.</p>
<p>This tutorial will start by importing a <code>Clouclip</code> dataset and providing an overview of the data. The <code>Clouclip</code> export is considerably simpler compared to the <code>VEET</code> export, only containing <code>Distance</code> and <code>Illuminance</code> measurements. The <code>VEET</code> dataset will be imported later for the spectrum related metrics.</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Load libraries and preprocessed data</strong></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="fu">library</span>(LightLogR)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="fu">library</span>(gt)</span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="fu">load</span>(<span class="st">"data/cleaned/data.RData"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Store coordinates of data collection</strong></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="annotated-cell-2"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><a class="code-annotation-anchor" data-target-cell="annotated-cell-2" data-target-annotation="1" onclick="event.preventDefault();">1</a><span id="annotated-cell-2-1" class="code-annotation-target"><a href="#annotated-cell-2-1"></a>coordinates <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">29.75</span>, <span class="sc">-</span><span class="fl">95.36</span>)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-2" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-2" data-code-lines="1" data-code-annotation="1">Coordinates for Houston, Texas; coordinates are important to calculate and visualize photoperiods later</span>
</dd>
</dl>
</div>
</div>
</section>
</section>
<section id="results" class="level2 page-columns page-full" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="results"><span class="header-section-number">3</span> Results</h2>
<section id="distance" class="level3" data-number="3.1">
<h3 data-number="3.1" class="anchored" data-anchor-id="distance"><span class="header-section-number">3.1</span> Distance</h3>
<p>We first examine metrics related to viewing distance, using the processed <code>Clouclip</code> dataset. Many distance-based metrics are computed for each day and then averaged over weekdays, weekends, or across all days. To facilitate this, we define a helper function that will take daily metric values and calculate the mean values for weekdays, weekends, and the overall daily average:</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Define helper function to_mean_daily()</strong></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="annotated-cell-3"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-3-1"><a href="#annotated-cell-3-1"></a>to_mean_daily <span class="ot">&lt;-</span> <span class="cf">function</span>(data, <span class="at">prefix =</span> <span class="st">"average_"</span>) {</span>
<span id="annotated-cell-3-2"><a href="#annotated-cell-3-2"></a>  data <span class="sc">|&gt;</span> </span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-3" data-target-annotation="1" onclick="event.preventDefault();">1</a><span id="annotated-cell-3-3" class="code-annotation-target"><a href="#annotated-cell-3-3"></a>    <span class="fu">ungroup</span>(Date) <span class="sc">|&gt;</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-3" data-target-annotation="2" onclick="event.preventDefault();">2</a><span id="annotated-cell-3-4" class="code-annotation-target"><a href="#annotated-cell-3-4"></a>    <span class="fu">mean_daily</span>(<span class="at">prefix =</span> prefix) <span class="sc">|&gt;</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-3" data-target-annotation="3" onclick="event.preventDefault();">3</a><span id="annotated-cell-3-5" class="code-annotation-target"><a href="#annotated-cell-3-5"></a>    <span class="fu">rename_with</span>(<span class="at">.fn =</span> \(x) <span class="fu">str_replace_all</span>(x,<span class="st">"_"</span>,<span class="st">" "</span>)) <span class="sc">|&gt;</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-3" data-target-annotation="4" onclick="event.preventDefault();">4</a><span id="annotated-cell-3-6" class="code-annotation-target"><a href="#annotated-cell-3-6"></a>    <span class="fu">gt</span>()</span>
<span id="annotated-cell-3-7"><a href="#annotated-cell-3-7"></a>}</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-3" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-3" data-code-lines="3" data-code-annotation="1">Ungroup by days</span>
</dd>
<dt data-target-cell="annotated-cell-3" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-3" data-code-lines="4" data-code-annotation="2">Calculate the averages per grouping</span>
</dd>
<dt data-target-cell="annotated-cell-3" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-3" data-code-lines="5" data-code-annotation="3">Remove underscores in names</span>
</dd>
<dt data-target-cell="annotated-cell-3" data-target-annotation="4">4</dt>
<dd>
<span data-code-cell="annotated-cell-3" data-code-lines="6" data-code-annotation="4">Format as a gt table for display</span>
</dd>
</dl>
</div>
</div>
<section id="total-wear-time-daily" class="level4" data-number="3.1.1">
<h4 data-number="3.1.1" class="anchored" data-anchor-id="total-wear-time-daily"><span class="header-section-number">3.1.1</span> Total wear time daily</h4>
<p><em>Total wear time daily</em>&nbsp;refers to the amount of time the device was actively collecting distance data each day (i.e.&nbsp;the time the device was worn and operational). We compute this by summing all intervals where a valid distance measurement is present, ignoring periods where data are missing or the device was off. The results are shown in <a href="#tbl-wear" class="quarto-xref">Table&nbsp;3</a>.</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Calculate total wear time</strong></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="annotated-cell-4"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-4-1"><a href="#annotated-cell-4-1"></a>dataCC <span class="sc">|&gt;</span> </span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-4" data-target-annotation="1" onclick="event.preventDefault();">1</a><span id="annotated-cell-4-2" class="code-annotation-target"><a href="#annotated-cell-4-2"></a>  <span class="fu">durations</span>(Dis) <span class="sc">|&gt;</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-4" data-target-annotation="2" onclick="event.preventDefault();">2</a><span id="annotated-cell-4-3" class="code-annotation-target"><a href="#annotated-cell-4-3"></a>  <span class="fu">to_mean_daily</span>(<span class="st">"Total wear "</span>)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-4" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-4" data-code-lines="2" data-code-annotation="1">Calculate total duration of data per day</span>
</dd>
<dt data-target-cell="annotated-cell-4" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-4" data-code-lines="3" data-code-annotation="2">Using the helper function defined above</span>
</dd>
</dl>
</div>
<div id="tbl-wear" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-wear-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;3: Total wear time per day (average across days)
</figcaption>
<div aria-describedby="tbl-wear-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="qmevgqeivx" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#qmevgqeivx table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#qmevgqeivx thead, #qmevgqeivx tbody, #qmevgqeivx tfoot, #qmevgqeivx tr, #qmevgqeivx td, #qmevgqeivx th {
  border-style: none;
}

#qmevgqeivx p {
  margin: 0;
  padding: 0;
}

#qmevgqeivx .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#qmevgqeivx .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#qmevgqeivx .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#qmevgqeivx .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#qmevgqeivx .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#qmevgqeivx .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qmevgqeivx .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#qmevgqeivx .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#qmevgqeivx .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#qmevgqeivx .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#qmevgqeivx .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#qmevgqeivx .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#qmevgqeivx .gt_spanner_row {
  border-bottom-style: hidden;
}

#qmevgqeivx .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#qmevgqeivx .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#qmevgqeivx .gt_from_md > :first-child {
  margin-top: 0;
}

#qmevgqeivx .gt_from_md > :last-child {
  margin-bottom: 0;
}

#qmevgqeivx .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#qmevgqeivx .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#qmevgqeivx .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#qmevgqeivx .gt_row_group_first td {
  border-top-width: 2px;
}

#qmevgqeivx .gt_row_group_first th {
  border-top-width: 2px;
}

#qmevgqeivx .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#qmevgqeivx .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#qmevgqeivx .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#qmevgqeivx .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qmevgqeivx .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#qmevgqeivx .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#qmevgqeivx .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#qmevgqeivx .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#qmevgqeivx .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qmevgqeivx .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#qmevgqeivx .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#qmevgqeivx .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#qmevgqeivx .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#qmevgqeivx .gt_left {
  text-align: left;
}

#qmevgqeivx .gt_center {
  text-align: center;
}

#qmevgqeivx .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#qmevgqeivx .gt_font_normal {
  font-weight: normal;
}

#qmevgqeivx .gt_font_bold {
  font-weight: bold;
}

#qmevgqeivx .gt_font_italic {
  font-style: italic;
}

#qmevgqeivx .gt_super {
  font-size: 65%;
}

#qmevgqeivx .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#qmevgqeivx .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#qmevgqeivx .gt_indent_1 {
  text-indent: 5px;
}

#qmevgqeivx .gt_indent_2 {
  text-indent: 10px;
}

#qmevgqeivx .gt_indent_3 {
  text-indent: 15px;
}

#qmevgqeivx .gt_indent_4 {
  text-indent: 20px;
}

#qmevgqeivx .gt_indent_5 {
  text-indent: 25px;
}

#qmevgqeivx .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#qmevgqeivx div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-bootstrap="false">
<thead>
<tr class="gt_col_headings header">
<th id="Date" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Date</th>
<th id="Total-wear-duration" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Total wear duration</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="gt_group_heading_row odd">
<th colspan="2" id="Clouclip" class="gt_group_heading" data-quarto-table-cell-role="th" scope="colgroup">Clouclip</th>
</tr>
<tr class="gt_row_group_first even">
<td class="gt_row gt_left" headers="Clouclip  Date">Mean daily</td>
<td class="gt_row gt_center" headers="Clouclip  Total wear duration">31448s (~8.74 hours)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Clouclip  Date">Weekday</td>
<td class="gt_row gt_center" headers="Clouclip  Total wear duration">34460s (~9.57 hours)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Clouclip  Date">Weekend</td>
<td class="gt_row gt_center" headers="Clouclip  Total wear duration">23918s (~6.64 hours)</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</figure>
</div>
</div>
</section>
<section id="distance-range" class="level4" data-number="3.1.2">
<h4 data-number="3.1.2" class="anchored" data-anchor-id="distance-range"><span class="header-section-number">3.1.2</span> Duration within distance ranges</h4>
<p>Many myopia-relevant metrics concern the time spent at certain viewing distances (e.g., “near work” vs.&nbsp;intermediate or far distances). We calculate the duration of time spent in specific distance ranges. <a href="#tbl-nearwork" class="quarto-xref">Table&nbsp;4</a> shows the average daily <em>duration of near work</em>, defined here as time viewing at 15–60&nbsp;cm. <a href="#tbl-ranges" class="quarto-xref">Table&nbsp;5</a> provides a more detailed breakdown across multiple distance bands.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" href="">Duration of near work</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false" href="">Duration within distance ranges</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Calculate daily duration of near work</strong></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="annotated-cell-29"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-29-1"><a href="#annotated-cell-29-1"></a>dataCC <span class="sc">|&gt;</span> </span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-29" data-target-annotation="1" onclick="event.preventDefault();">1</a><span id="annotated-cell-29-2" class="code-annotation-target"><a href="#annotated-cell-29-2"></a>  <span class="fu">filter</span>(Dis <span class="sc">&gt;=</span> <span class="dv">15</span>, Dis <span class="sc">&lt;</span> <span class="dv">60</span>) <span class="sc">|&gt;</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-29" data-target-annotation="2" onclick="event.preventDefault();">2</a><span id="annotated-cell-29-3" class="code-annotation-target"><a href="#annotated-cell-29-3"></a>  <span class="fu">durations</span>(Dis) <span class="sc">|&gt;</span></span>
<span id="annotated-cell-29-4"><a href="#annotated-cell-29-4"></a>  <span class="fu">to_mean_daily</span>(<span class="st">"Near work "</span>)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-29" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-29" data-code-lines="2" data-code-annotation="1">Consider only distances in [15, 60) cm</span>
</dd>
<dt data-target-cell="annotated-cell-29" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-29" data-code-lines="3" data-code-annotation="2">Total duration in that range per day</span>
</dd>
</dl>
</div>
<div id="tbl-nearwork" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-nearwork-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;4: Daily duration of near work (15–60&nbsp;cm viewing distance)
</figcaption>
<div aria-describedby="tbl-nearwork-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="lcrwjbuumr" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#lcrwjbuumr table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#lcrwjbuumr thead, #lcrwjbuumr tbody, #lcrwjbuumr tfoot, #lcrwjbuumr tr, #lcrwjbuumr td, #lcrwjbuumr th {
  border-style: none;
}

#lcrwjbuumr p {
  margin: 0;
  padding: 0;
}

#lcrwjbuumr .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#lcrwjbuumr .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#lcrwjbuumr .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#lcrwjbuumr .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#lcrwjbuumr .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#lcrwjbuumr .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#lcrwjbuumr .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#lcrwjbuumr .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#lcrwjbuumr .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#lcrwjbuumr .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#lcrwjbuumr .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#lcrwjbuumr .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#lcrwjbuumr .gt_spanner_row {
  border-bottom-style: hidden;
}

#lcrwjbuumr .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#lcrwjbuumr .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#lcrwjbuumr .gt_from_md > :first-child {
  margin-top: 0;
}

#lcrwjbuumr .gt_from_md > :last-child {
  margin-bottom: 0;
}

#lcrwjbuumr .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#lcrwjbuumr .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#lcrwjbuumr .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#lcrwjbuumr .gt_row_group_first td {
  border-top-width: 2px;
}

#lcrwjbuumr .gt_row_group_first th {
  border-top-width: 2px;
}

#lcrwjbuumr .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#lcrwjbuumr .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#lcrwjbuumr .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#lcrwjbuumr .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#lcrwjbuumr .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#lcrwjbuumr .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#lcrwjbuumr .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#lcrwjbuumr .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#lcrwjbuumr .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#lcrwjbuumr .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#lcrwjbuumr .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#lcrwjbuumr .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#lcrwjbuumr .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#lcrwjbuumr .gt_left {
  text-align: left;
}

#lcrwjbuumr .gt_center {
  text-align: center;
}

#lcrwjbuumr .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#lcrwjbuumr .gt_font_normal {
  font-weight: normal;
}

#lcrwjbuumr .gt_font_bold {
  font-weight: bold;
}

#lcrwjbuumr .gt_font_italic {
  font-style: italic;
}

#lcrwjbuumr .gt_super {
  font-size: 65%;
}

#lcrwjbuumr .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#lcrwjbuumr .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#lcrwjbuumr .gt_indent_1 {
  text-indent: 5px;
}

#lcrwjbuumr .gt_indent_2 {
  text-indent: 10px;
}

#lcrwjbuumr .gt_indent_3 {
  text-indent: 15px;
}

#lcrwjbuumr .gt_indent_4 {
  text-indent: 20px;
}

#lcrwjbuumr .gt_indent_5 {
  text-indent: 25px;
}

#lcrwjbuumr .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#lcrwjbuumr div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-bootstrap="false">
<thead>
<tr class="gt_col_headings header">
<th id="Date" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Date</th>
<th id="Near-work-duration" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Near work duration</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="gt_group_heading_row odd">
<th colspan="2" id="Clouclip" class="gt_group_heading" data-quarto-table-cell-role="th" scope="colgroup">Clouclip</th>
</tr>
<tr class="gt_row_group_first even">
<td class="gt_row gt_left" headers="Clouclip  Date">Mean daily</td>
<td class="gt_row gt_center" headers="Clouclip  Near work duration">17309s (~4.81 hours)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Clouclip  Date">Weekday</td>
<td class="gt_row gt_center" headers="Clouclip  Near work duration">21173s (~5.88 hours)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Clouclip  Date">Weekend</td>
<td class="gt_row gt_center" headers="Clouclip  Near work duration">7648s (~2.12 hours)</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</figure>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<p>First, we define a set of distance breakpoints and descriptive labels for each range:</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Defining distance ranges (in cm)</strong></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>dist_breaks <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">15</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">40</span>, <span class="dv">50</span>, <span class="dv">60</span>, <span class="dv">70</span>, <span class="dv">80</span>, <span class="dv">90</span>, <span class="dv">100</span>, <span class="cn">Inf</span>)</span>
<span id="cb2-2"><a href="#cb2-2"></a>dist_labels <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb2-3"><a href="#cb2-3"></a>    <span class="st">"Extremely near"</span>,          <span class="co"># [15, 20)</span></span>
<span id="cb2-4"><a href="#cb2-4"></a>    <span class="st">"Very near"</span>,               <span class="co"># [20, 30)</span></span>
<span id="cb2-5"><a href="#cb2-5"></a>    <span class="st">"Fairly near"</span>,             <span class="co"># [30, 40)</span></span>
<span id="cb2-6"><a href="#cb2-6"></a>    <span class="st">"Near"</span>,                    <span class="co"># [40, 50)</span></span>
<span id="cb2-7"><a href="#cb2-7"></a>    <span class="st">"Moderately near"</span>,         <span class="co"># [50, 60)</span></span>
<span id="cb2-8"><a href="#cb2-8"></a>    <span class="st">"Near intermediate"</span>,       <span class="co"># [60, 70)</span></span>
<span id="cb2-9"><a href="#cb2-9"></a>    <span class="st">"Intermediate"</span>,            <span class="co"># [70, 80)</span></span>
<span id="cb2-10"><a href="#cb2-10"></a>    <span class="st">"Moderately intermediate"</span>, <span class="co"># [80, 90)</span></span>
<span id="cb2-11"><a href="#cb2-11"></a>    <span class="st">"Far intermediate"</span>,        <span class="co"># [90, 100)</span></span>
<span id="cb2-12"><a href="#cb2-12"></a>    <span class="st">"Far"</span>                      <span class="co"># [100, Inf)</span></span>
<span id="cb2-13"><a href="#cb2-13"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<p>Now we cut the distance data into these ranges and compute the daily duration spent in each range:</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Calculate daily duration within viewing distance range</strong></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="annotated-cell-31"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-31-1"><a href="#annotated-cell-31-1"></a>dataCC <span class="sc">|&gt;</span> </span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-31" data-target-annotation="1" onclick="event.preventDefault();">1</a><span id="annotated-cell-31-2" class="code-annotation-target"><a href="#annotated-cell-31-2"></a>  <span class="fu">mutate</span>(<span class="at">Dis_range =</span> <span class="fu">cut</span>(Dis, <span class="at">breaks =</span> dist_breaks, <span class="at">labels =</span> dist_labels)) <span class="sc">|&gt;</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-31" data-target-annotation="2" onclick="event.preventDefault();">2</a><span id="annotated-cell-31-3" class="code-annotation-target"><a href="#annotated-cell-31-3"></a>  <span class="fu">drop_na</span>(Dis_range) <span class="sc">|&gt;</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-31" data-target-annotation="3" onclick="event.preventDefault();">3</a><span id="annotated-cell-31-4" class="code-annotation-target"><a href="#annotated-cell-31-4"></a>  <span class="fu">group_by</span>(Dis_range, <span class="at">.add =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-31" data-target-annotation="4" onclick="event.preventDefault();">4</a><span id="annotated-cell-31-5" class="code-annotation-target"><a href="#annotated-cell-31-5"></a>  <span class="fu">durations</span>(Dis) <span class="sc">|&gt;</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-31" data-target-annotation="5" onclick="event.preventDefault();">5</a><span id="annotated-cell-31-6" class="code-annotation-target"><a href="#annotated-cell-31-6"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> Dis_range, <span class="at">values_from =</span> duration) <span class="sc">|&gt;</span></span>
<span id="annotated-cell-31-7"><a href="#annotated-cell-31-7"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span> </span>
<span id="annotated-cell-31-8"><a href="#annotated-cell-31-8"></a>  <span class="fu">mean_daily</span>(<span class="at">prefix =</span> <span class="st">""</span>) <span class="sc">|&gt;</span> </span>
<span id="annotated-cell-31-9"><a href="#annotated-cell-31-9"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>Date) <span class="sc">|&gt;</span> </span>
<span id="annotated-cell-31-10"><a href="#annotated-cell-31-10"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> Date) <span class="sc">|&gt;</span> </span>
<span id="annotated-cell-31-11"><a href="#annotated-cell-31-11"></a>  <span class="fu">mutate</span>(<span class="at">name =</span> <span class="fu">factor</span>(name, <span class="at">levels =</span> <span class="fu">rev</span>(dist_labels))) <span class="sc">|&gt;</span> </span>
<span id="annotated-cell-31-12"><a href="#annotated-cell-31-12"></a>  <span class="fu">arrange</span>(name) <span class="sc">|&gt;</span> </span>
<span id="annotated-cell-31-13"><a href="#annotated-cell-31-13"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span> </span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-31" data-target-annotation="6" onclick="event.preventDefault();">6</a><span id="annotated-cell-31-14" class="code-annotation-target"><a href="#annotated-cell-31-14"></a>  <span class="fu">fmt_duration</span>(<span class="at">input_units =</span> <span class="st">"seconds"</span>, <span class="at">output_units =</span> <span class="st">"minutes"</span>)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-31" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-31" data-code-lines="2" data-code-annotation="1">Categorize distances</span>
</dd>
<dt data-target-cell="annotated-cell-31" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-31" data-code-lines="3" data-code-annotation="2">Remove intervals with no data</span>
</dd>
<dt data-target-cell="annotated-cell-31" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-31" data-code-lines="4" data-code-annotation="3">Group by distance range (in addition to the date)</span>
</dd>
<dt data-target-cell="annotated-cell-31" data-target-annotation="4">4</dt>
<dd>
<span data-code-cell="annotated-cell-31" data-code-lines="5" data-code-annotation="4">Duration per range per day</span>
</dd>
<dt data-target-cell="annotated-cell-31" data-target-annotation="5">5</dt>
<dd>
<span data-code-cell="annotated-cell-31" data-code-lines="6" data-code-annotation="5">Pivot data from long to wide format (ranges as columns)</span>
</dd>
<dt data-target-cell="annotated-cell-31" data-target-annotation="6">6</dt>
<dd>
<span data-code-cell="annotated-cell-31" data-code-lines="14" data-code-annotation="6">Convert seconds to minutes</span>
</dd>
</dl>
</div>
<div id="tbl-ranges" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-ranges-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;5: Daily duration in each viewing distance range
</figcaption>
<div aria-describedby="tbl-ranges-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="nwploubuwo" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#nwploubuwo table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#nwploubuwo thead, #nwploubuwo tbody, #nwploubuwo tfoot, #nwploubuwo tr, #nwploubuwo td, #nwploubuwo th {
  border-style: none;
}

#nwploubuwo p {
  margin: 0;
  padding: 0;
}

#nwploubuwo .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#nwploubuwo .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#nwploubuwo .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#nwploubuwo .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#nwploubuwo .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#nwploubuwo .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#nwploubuwo .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#nwploubuwo .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#nwploubuwo .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#nwploubuwo .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#nwploubuwo .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#nwploubuwo .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#nwploubuwo .gt_spanner_row {
  border-bottom-style: hidden;
}

#nwploubuwo .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#nwploubuwo .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#nwploubuwo .gt_from_md > :first-child {
  margin-top: 0;
}

#nwploubuwo .gt_from_md > :last-child {
  margin-bottom: 0;
}

#nwploubuwo .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#nwploubuwo .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#nwploubuwo .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#nwploubuwo .gt_row_group_first td {
  border-top-width: 2px;
}

#nwploubuwo .gt_row_group_first th {
  border-top-width: 2px;
}

#nwploubuwo .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#nwploubuwo .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#nwploubuwo .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#nwploubuwo .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#nwploubuwo .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#nwploubuwo .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#nwploubuwo .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#nwploubuwo .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#nwploubuwo .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#nwploubuwo .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#nwploubuwo .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#nwploubuwo .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#nwploubuwo .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#nwploubuwo .gt_left {
  text-align: left;
}

#nwploubuwo .gt_center {
  text-align: center;
}

#nwploubuwo .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#nwploubuwo .gt_font_normal {
  font-weight: normal;
}

#nwploubuwo .gt_font_bold {
  font-weight: bold;
}

#nwploubuwo .gt_font_italic {
  font-style: italic;
}

#nwploubuwo .gt_super {
  font-size: 65%;
}

#nwploubuwo .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#nwploubuwo .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#nwploubuwo .gt_indent_1 {
  text-indent: 5px;
}

#nwploubuwo .gt_indent_2 {
  text-indent: 10px;
}

#nwploubuwo .gt_indent_3 {
  text-indent: 15px;
}

#nwploubuwo .gt_indent_4 {
  text-indent: 20px;
}

#nwploubuwo .gt_indent_5 {
  text-indent: 25px;
}

#nwploubuwo .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#nwploubuwo div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-bootstrap="false">
<thead>
<tr class="gt_col_headings header">
<th id="name" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">name</th>
<th id="Mean-daily" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Mean daily</th>
<th id="Weekday" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Weekday</th>
<th id="Weekend" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Weekend</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_center" headers="name">Far</td>
<td class="gt_row gt_center" headers="Mean daily">16m</td>
<td class="gt_row gt_center" headers="Weekday">20m</td>
<td class="gt_row gt_center" headers="Weekend">5m</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="name">Far intermediate</td>
<td class="gt_row gt_center" headers="Mean daily">11m</td>
<td class="gt_row gt_center" headers="Weekday">14m</td>
<td class="gt_row gt_center" headers="Weekend">2m</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="name">Moderately intermediate</td>
<td class="gt_row gt_center" headers="Mean daily">5m</td>
<td class="gt_row gt_center" headers="Weekday">6m</td>
<td class="gt_row gt_center" headers="Weekend">3m</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="name">Intermediate</td>
<td class="gt_row gt_center" headers="Mean daily">4m</td>
<td class="gt_row gt_center" headers="Weekday">6m</td>
<td class="gt_row gt_center" headers="Weekend">1m</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="name">Near intermediate</td>
<td class="gt_row gt_center" headers="Mean daily">7m</td>
<td class="gt_row gt_center" headers="Weekday">7m</td>
<td class="gt_row gt_center" headers="Weekend">8m</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="name">Moderately near</td>
<td class="gt_row gt_center" headers="Mean daily">13m</td>
<td class="gt_row gt_center" headers="Weekday">16m</td>
<td class="gt_row gt_center" headers="Weekend">5m</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="name">Near</td>
<td class="gt_row gt_center" headers="Mean daily">27m</td>
<td class="gt_row gt_center" headers="Weekday">36m</td>
<td class="gt_row gt_center" headers="Weekend">5m</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="name">Fairly near</td>
<td class="gt_row gt_center" headers="Mean daily">46m</td>
<td class="gt_row gt_center" headers="Weekday">60m</td>
<td class="gt_row gt_center" headers="Weekend">12m</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="name">Very near</td>
<td class="gt_row gt_center" headers="Mean daily">102m</td>
<td class="gt_row gt_center" headers="Weekday">128m</td>
<td class="gt_row gt_center" headers="Weekend">38m</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="name">Extremely near</td>
<td class="gt_row gt_center" headers="Mean daily">74m</td>
<td class="gt_row gt_center" headers="Weekday">88m</td>
<td class="gt_row gt_center" headers="Weekend">40m</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</figure>
</div>
</div>
<p>To visualize this, <a href="#fig-ranges" class="quarto-xref">Figure&nbsp;1</a> illustrates the relative proportion of time spent in each distance range:</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Plot time spent within each viewing distance range</strong></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="annotated-cell-32"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-32-1"><a href="#annotated-cell-32-1"></a>dataCC <span class="sc">|&gt;</span> </span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-32" data-target-annotation="1" onclick="event.preventDefault();">1</a><span id="annotated-cell-32-2" class="code-annotation-target"><a href="#annotated-cell-32-2"></a>  <span class="fu">mutate</span>(<span class="at">Dis_range =</span> <span class="fu">cut</span>(Dis, <span class="at">breaks =</span> dist_breaks, <span class="at">labels =</span> dist_labels)) <span class="sc">|&gt;</span></span>
<span id="annotated-cell-32-3"><a href="#annotated-cell-32-3"></a>  <span class="fu">drop_na</span>(Dis_range) <span class="sc">|&gt;</span></span>
<span id="annotated-cell-32-4"><a href="#annotated-cell-32-4"></a>  <span class="fu">group_by</span>(Dis_range, <span class="at">.add =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="annotated-cell-32-5"><a href="#annotated-cell-32-5"></a>  <span class="fu">durations</span>(Dis) <span class="sc">|&gt;</span></span>
<span id="annotated-cell-32-6"><a href="#annotated-cell-32-6"></a>  <span class="fu">group_by</span>(Dis_range) <span class="sc">|&gt;</span></span>
<span id="annotated-cell-32-7"><a href="#annotated-cell-32-7"></a>  <span class="fu">mean_daily</span>(<span class="at">prefix =</span> <span class="st">""</span>) <span class="sc">|&gt;</span></span>
<span id="annotated-cell-32-8"><a href="#annotated-cell-32-8"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span></span>
<span id="annotated-cell-32-9"><a href="#annotated-cell-32-9"></a>  <span class="fu">mutate</span>(<span class="at">Dis_range =</span> forcats<span class="sc">::</span><span class="fu">fct_relabel</span>(Dis_range, \(x) <span class="fu">str_replace</span>(x, <span class="st">" "</span>, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>))) <span class="sc">|&gt;</span> </span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-32" data-target-annotation="2" onclick="event.preventDefault();">2</a><span id="annotated-cell-32-10" class="code-annotation-target"><a href="#annotated-cell-32-10"></a>  <span class="fu">mutate</span>(<span class="at">duration =</span> duration<span class="sc">/</span><span class="fu">sum</span>(duration), <span class="at">.by =</span> Date) <span class="sc">|&gt;</span></span>
<span id="annotated-cell-32-11"><a href="#annotated-cell-32-11"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Dis_range, <span class="at">y =</span> duration, <span class="at">fill =</span> Date)) <span class="sc">+</span></span>
<span id="annotated-cell-32-12"><a href="#annotated-cell-32-12"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="annotated-cell-32-13"><a href="#annotated-cell-32-13"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_percent</span>()) <span class="sc">+</span></span>
<span id="annotated-cell-32-14"><a href="#annotated-cell-32-14"></a>  ggsci<span class="sc">::</span><span class="fu">scale_fill_jco</span>() <span class="sc">+</span></span>
<span id="annotated-cell-32-15"><a href="#annotated-cell-32-15"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="annotated-cell-32-16"><a href="#annotated-cell-32-16"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Relative duration (%)"</span>, <span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">fill =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="annotated-cell-32-17"><a href="#annotated-cell-32-17"></a>  <span class="fu">coord_flip</span>()</span>
<span id="annotated-cell-32-18"><a href="#annotated-cell-32-18"></a><span class="fu">ggsave</span>(<span class="st">"manuscript/figures/Figure1.png"</span>,</span>
<span id="annotated-cell-32-19"><a href="#annotated-cell-32-19"></a>                <span class="at">width =</span> <span class="dv">7</span>,</span>
<span id="annotated-cell-32-20"><a href="#annotated-cell-32-20"></a>                <span class="at">height =</span> <span class="dv">5</span>)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-32" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-32" data-code-lines="2,3,4,5,6,7,8" data-code-annotation="1">Broadly, this portion repeats the prior code cell</span>
</dd>
<dt data-target-cell="annotated-cell-32" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-32" data-code-lines="10" data-code-annotation="2">Convert to percentage of daily total</span>
</dd>
</dl>
</div>
<div class="cell-output-display">
<div id="fig-ranges" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ranges-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="index_files/figure-html/fig-ranges-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Figure&nbsp;1: Percentage of total time spent in each viewing distance range for an average day (mean daily), average weekday, or weekend"><img src="index_files/figure-html/fig-ranges-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ranges-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Percentage of total time spent in each viewing distance range for an average day (mean daily), average weekday, or weekend
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="frequency-of-continuous-near-work" class="level4" data-number="3.1.3">
<h4 data-number="3.1.3" class="anchored" data-anchor-id="frequency-of-continuous-near-work"><span class="header-section-number">3.1.3</span> Frequency of continuous near work</h4>
<p>Continuous near-work can be understood as sustained viewing within a near distance for some minimum duration, allowing only brief interruptions. We use LightLogR’s <code>cluster</code> function to identify episodes of continuous near work. Here, we define a near-work episode as viewing distance between 20&nbsp;cm and 60&nbsp;cm that lasts at least 30&nbsp;minutes, with interruptions of up to 1&nbsp;minute allowed (meaning short breaks ≤1&nbsp;min do not end the episode). Using <a href="https://tscnlab.github.io/LightLogR/reference/extract_clusters.html">extract_clusters()</a> with those parameters, we count how many such episodes occur per day.</p>
<p><a href="#tbl-continuousnear" class="quarto-xref">Table&nbsp;6</a> summarizes the average frequency of continuous near-work episodes per day, and <a href="#fig-visbreak" class="quarto-xref">Figure&nbsp;2</a> provides an example visualization of these episodes on the distance time series.</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Calculate the frequency of continuous near-work episodes per day</strong></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="annotated-cell-5"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-5-1"><a href="#annotated-cell-5-1"></a>dataCC <span class="sc">|&gt;</span> </span>
<span id="annotated-cell-5-2"><a href="#annotated-cell-5-2"></a>  <span class="fu">extract_clusters</span>(</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-5" data-target-annotation="1" onclick="event.preventDefault();">1</a><span id="annotated-cell-5-3" class="code-annotation-target"><a href="#annotated-cell-5-3"></a>    Dis <span class="sc">&gt;=</span> <span class="dv">20</span> <span class="sc">&amp;</span> Dis <span class="sc">&lt;</span> <span class="dv">60</span>,</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-5" data-target-annotation="2" onclick="event.preventDefault();">2</a><span id="annotated-cell-5-4" class="code-annotation-target"><a href="#annotated-cell-5-4"></a>    <span class="at">cluster.duration =</span> <span class="st">"30 mins"</span>,</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-5" data-target-annotation="3" onclick="event.preventDefault();">3</a><span id="annotated-cell-5-5" class="code-annotation-target"><a href="#annotated-cell-5-5"></a>    <span class="at">interruption.duration =</span> <span class="st">"1 min"</span>,</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-5" data-target-annotation="4" onclick="event.preventDefault();">4</a><span id="annotated-cell-5-6" class="code-annotation-target"><a href="#annotated-cell-5-6"></a>    <span class="at">drop.empty.groups =</span> <span class="cn">FALSE</span></span>
<span id="annotated-cell-5-7"><a href="#annotated-cell-5-7"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="annotated-cell-5-8"><a href="#annotated-cell-5-8"></a>  <span class="fu">summarize_numeric</span>(<span class="at">remove =</span> <span class="fu">c</span>(<span class="st">"start"</span>, <span class="st">"end"</span>, <span class="st">"epoch"</span>, <span class="st">"duration"</span>),</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-5" data-target-annotation="5" onclick="event.preventDefault();">5</a><span id="annotated-cell-5-9" class="code-annotation-target"><a href="#annotated-cell-5-9"></a>                    <span class="at">add.total.duration =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-5" data-target-annotation="6" onclick="event.preventDefault();">6</a><span id="annotated-cell-5-10" class="code-annotation-target"><a href="#annotated-cell-5-10"></a>  <span class="fu">mean_daily</span>(<span class="at">prefix =</span> <span class="st">"Frequency of "</span>) <span class="sc">|&gt;</span></span>
<span id="annotated-cell-5-11"><a href="#annotated-cell-5-11"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span> <span class="fu">fmt_number</span>() </span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-5" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-5" data-code-lines="3" data-code-annotation="1">Condition: near-work distance</span>
</dd>
<dt data-target-cell="annotated-cell-5" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-5" data-code-lines="4" data-code-annotation="2">Minimum duration of a continuous episode</span>
</dd>
<dt data-target-cell="annotated-cell-5" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-5" data-code-lines="5" data-code-annotation="3">Maximum gap allowed within an episode</span>
</dd>
<dt data-target-cell="annotated-cell-5" data-target-annotation="4">4</dt>
<dd>
<span data-code-cell="annotated-cell-5" data-code-lines="6" data-code-annotation="4">Keep days with zero episodes in output</span>
</dd>
<dt data-target-cell="annotated-cell-5" data-target-annotation="5">5</dt>
<dd>
<span data-code-cell="annotated-cell-5" data-code-lines="9" data-code-annotation="5">Count number of episodes per day</span>
</dd>
<dt data-target-cell="annotated-cell-5" data-target-annotation="6">6</dt>
<dd>
<span data-code-cell="annotated-cell-5" data-code-lines="10" data-code-annotation="6">Compute daily mean frequency</span>
</dd>
</dl>
</div>
<div id="tbl-continuousnear" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-continuousnear-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;6: Frequency of continuous near-work episodes per day
</figcaption>
<div aria-describedby="tbl-continuousnear-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="ncplljzjfj" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#ncplljzjfj table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ncplljzjfj thead, #ncplljzjfj tbody, #ncplljzjfj tfoot, #ncplljzjfj tr, #ncplljzjfj td, #ncplljzjfj th {
  border-style: none;
}

#ncplljzjfj p {
  margin: 0;
  padding: 0;
}

#ncplljzjfj .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ncplljzjfj .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ncplljzjfj .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ncplljzjfj .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ncplljzjfj .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ncplljzjfj .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ncplljzjfj .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ncplljzjfj .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ncplljzjfj .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ncplljzjfj .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ncplljzjfj .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ncplljzjfj .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ncplljzjfj .gt_spanner_row {
  border-bottom-style: hidden;
}

#ncplljzjfj .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ncplljzjfj .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ncplljzjfj .gt_from_md > :first-child {
  margin-top: 0;
}

#ncplljzjfj .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ncplljzjfj .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ncplljzjfj .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ncplljzjfj .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ncplljzjfj .gt_row_group_first td {
  border-top-width: 2px;
}

#ncplljzjfj .gt_row_group_first th {
  border-top-width: 2px;
}

#ncplljzjfj .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ncplljzjfj .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ncplljzjfj .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ncplljzjfj .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ncplljzjfj .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ncplljzjfj .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ncplljzjfj .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ncplljzjfj .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ncplljzjfj .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ncplljzjfj .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ncplljzjfj .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ncplljzjfj .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ncplljzjfj .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ncplljzjfj .gt_left {
  text-align: left;
}

#ncplljzjfj .gt_center {
  text-align: center;
}

#ncplljzjfj .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ncplljzjfj .gt_font_normal {
  font-weight: normal;
}

#ncplljzjfj .gt_font_bold {
  font-weight: bold;
}

#ncplljzjfj .gt_font_italic {
  font-style: italic;
}

#ncplljzjfj .gt_super {
  font-size: 65%;
}

#ncplljzjfj .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ncplljzjfj .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ncplljzjfj .gt_indent_1 {
  text-indent: 5px;
}

#ncplljzjfj .gt_indent_2 {
  text-indent: 10px;
}

#ncplljzjfj .gt_indent_3 {
  text-indent: 15px;
}

#ncplljzjfj .gt_indent_4 {
  text-indent: 20px;
}

#ncplljzjfj .gt_indent_5 {
  text-indent: 25px;
}

#ncplljzjfj .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#ncplljzjfj div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-bootstrap="false">
<thead>
<tr class="gt_col_headings header">
<th id="Date" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Date</th>
<th id="Frequency-of-episodes" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Frequency of episodes</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="gt_group_heading_row odd">
<th colspan="2" id="Clouclip" class="gt_group_heading" data-quarto-table-cell-role="th" scope="colgroup">Clouclip</th>
</tr>
<tr class="gt_row_group_first even">
<td class="gt_row gt_left" headers="Clouclip  Date">Mean daily</td>
<td class="gt_row gt_right" headers="Clouclip  Frequency of episodes">0.86</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Clouclip  Date">Weekday</td>
<td class="gt_row gt_right" headers="Clouclip  Frequency of episodes">1.20</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Clouclip  Date">Weekend</td>
<td class="gt_row gt_right" headers="Clouclip  Frequency of episodes">0.00</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</figure>
</div>
</div>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Plot continuous near-work episodes</strong></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="annotated-cell-6"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><a class="code-annotation-anchor" data-target-cell="annotated-cell-6" data-target-annotation="1" onclick="event.preventDefault();">1</a><span id="annotated-cell-6-1" class="code-annotation-target"><a href="#annotated-cell-6-1"></a>dataCC <span class="sc">|&gt;</span></span>
<span id="annotated-cell-6-2"><a href="#annotated-cell-6-2"></a>  <span class="fu">add_clusters</span>(</span>
<span id="annotated-cell-6-3"><a href="#annotated-cell-6-3"></a>    Dis <span class="sc">&gt;=</span> <span class="dv">20</span> <span class="sc">&amp;</span> Dis <span class="sc">&lt;</span> <span class="dv">60</span>,</span>
<span id="annotated-cell-6-4"><a href="#annotated-cell-6-4"></a>    <span class="at">cluster.duration =</span> <span class="st">"30 mins"</span>,</span>
<span id="annotated-cell-6-5"><a href="#annotated-cell-6-5"></a>    <span class="at">interruption.duration =</span> <span class="st">"1 min"</span></span>
<span id="annotated-cell-6-6"><a href="#annotated-cell-6-6"></a>  ) <span class="sc">|&gt;</span></span>
<span id="annotated-cell-6-7"><a href="#annotated-cell-6-7"></a>  <span class="fu">gg_day</span>(<span class="at">y.axis =</span> Dis, <span class="at">y.axis.label =</span> <span class="st">"Distance (cm)"</span>, <span class="at">geom =</span> <span class="st">"line"</span>,</span>
<span id="annotated-cell-6-8"><a href="#annotated-cell-6-8"></a>         <span class="at">y.scale =</span> <span class="st">"identity"</span>, <span class="at">y.axis.breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">100</span>, <span class="at">by =</span> <span class="dv">20</span>)) <span class="sc">|&gt;</span> </span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-6" data-target-annotation="2" onclick="event.preventDefault();">2</a><span id="annotated-cell-6-9" class="code-annotation-target"><a href="#annotated-cell-6-9"></a>  <span class="fu">gg_photoperiod</span>(coordinates) <span class="sc">|&gt;</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-6" data-target-annotation="3" onclick="event.preventDefault();">3</a><span id="annotated-cell-6-10" class="code-annotation-target"><a href="#annotated-cell-6-10"></a>  <span class="fu">gg_state</span>(state, <span class="at">fill =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="annotated-cell-6-11"><a href="#annotated-cell-6-11"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">60</span>), <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="annotated-cell-6-12"><a href="#annotated-cell-6-12"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">100</span>))</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-6" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-6" data-code-lines="1,2,3,4,5,6" data-code-annotation="1">As in code cell above</span>
</dd>
<dt data-target-cell="annotated-cell-6" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-6" data-code-lines="9" data-code-annotation="2">Add photoperiod information</span>
</dd>
<dt data-target-cell="annotated-cell-6" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-6" data-code-lines="10" data-code-annotation="3">Add state bands</span>
</dd>
</dl>
</div>
<div class="cell-output-display">
<div id="fig-visbreak" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-visbreak-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="index_files/figure-html/fig-visbreak-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="Figure&nbsp;2: Example of continuous near-work episodes. Red shaded areas indicate periods of continuous near work (20–60&nbsp;cm for ≥30&nbsp;min, allowing ≤1&nbsp;min interruptions). Black trace is viewing distance over time; red dashed lines mark the 20&nbsp;cm and 60&nbsp;cm boundaries. Grey shaded areas indicate nighttime."><img src="index_files/figure-html/fig-visbreak-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-visbreak-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Example of continuous near-work episodes. Red shaded areas indicate periods of continuous near work (20–60&nbsp;cm for ≥30&nbsp;min, allowing ≤1&nbsp;min interruptions). Black trace is viewing distance over time; red dashed lines mark the 20&nbsp;cm and 60&nbsp;cm boundaries. Grey shaded areas indicate nighttime.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="near-work-episodes" class="level4" data-number="3.1.4">
<h4 data-number="3.1.4" class="anchored" data-anchor-id="near-work-episodes"><span class="header-section-number">3.1.4</span> Near-work episodes</h4>
<p>Beyond frequency, we can characterize near-work episodes by their duration and typical viewing distance. This section extracts all near-work episodes (using a 5-second minimum duration to capture more routine near-work bouts) and summarizes three aspects:</p>
<ol type="1">
<li>frequency (count of episodes per day),</li>
<li>average duration of episodes, and</li>
<li>average distance during those episodes.</li>
</ol>
<p>These results are combined in <a href="#tbl-nearworkepisodes" class="quarto-xref">Table&nbsp;7</a>.</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Calculate near-work episodes</strong></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="annotated-cell-7"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-7-1"><a href="#annotated-cell-7-1"></a>dataCC <span class="sc">|&gt;</span> </span>
<span id="annotated-cell-7-2"><a href="#annotated-cell-7-2"></a>  <span class="fu">extract_clusters</span>(</span>
<span id="annotated-cell-7-3"><a href="#annotated-cell-7-3"></a>    Dis <span class="sc">&gt;=</span> <span class="dv">20</span> <span class="sc">&amp;</span> Dis <span class="sc">&lt;</span> <span class="dv">60</span>,</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-7" data-target-annotation="1" onclick="event.preventDefault();">1</a><span id="annotated-cell-7-4" class="code-annotation-target"><a href="#annotated-cell-7-4"></a>    <span class="at">cluster.duration =</span> <span class="st">"5 secs"</span>,</span>
<span id="annotated-cell-7-5"><a href="#annotated-cell-7-5"></a>    <span class="at">interruption.duration =</span> <span class="st">"20 secs"</span>,</span>
<span id="annotated-cell-7-6"><a href="#annotated-cell-7-6"></a>    <span class="at">drop.empty.groups =</span> <span class="cn">FALSE</span></span>
<span id="annotated-cell-7-7"><a href="#annotated-cell-7-7"></a>  ) <span class="sc">|&gt;</span> </span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-7" data-target-annotation="2" onclick="event.preventDefault();">2</a><span id="annotated-cell-7-8" class="code-annotation-target"><a href="#annotated-cell-7-8"></a>  <span class="fu">extract_metric</span>(dataCC, <span class="at">distance =</span> <span class="fu">mean</span>(Dis, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-7" data-target-annotation="3" onclick="event.preventDefault();">3</a><span id="annotated-cell-7-9" class="code-annotation-target"><a href="#annotated-cell-7-9"></a>  <span class="fu">summarize_numeric</span>(<span class="at">remove =</span> <span class="fu">c</span>(<span class="st">"start"</span>, <span class="st">"end"</span>, <span class="st">"epoch"</span>),</span>
<span id="annotated-cell-7-10"><a href="#annotated-cell-7-10"></a>                    <span class="at">prefix =</span> <span class="st">""</span>,</span>
<span id="annotated-cell-7-11"><a href="#annotated-cell-7-11"></a>                    <span class="at">add.total.duration =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-7" data-target-annotation="4" onclick="event.preventDefault();">4</a><span id="annotated-cell-7-12" class="code-annotation-target"><a href="#annotated-cell-7-12"></a>  <span class="fu">mean_daily</span>(<span class="at">prefix =</span> <span class="st">""</span>) <span class="sc">|&gt;</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-7" data-target-annotation="5" onclick="event.preventDefault();">5</a><span id="annotated-cell-7-13" class="code-annotation-target"><a href="#annotated-cell-7-13"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span></span>
<span id="annotated-cell-7-14"><a href="#annotated-cell-7-14"></a>  <span class="fu">fmt_number</span>(<span class="fu">c</span>(distance, episodes), <span class="at">decimals =</span> <span class="dv">0</span>) <span class="sc">|&gt;</span></span>
<span id="annotated-cell-7-15"><a href="#annotated-cell-7-15"></a>  <span class="fu">cols_units</span>(<span class="at">distance =</span> <span class="st">"cm"</span>)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-7" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-7" data-code-lines="4" data-code-annotation="1">Minimal duration to count as an episode (set to interval level of <code>dataCC</code>)</span>
</dd>
<dt data-target-cell="annotated-cell-7" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-7" data-code-lines="8" data-code-annotation="2">Calculate mean distance during each episode</span>
</dd>
<dt data-target-cell="annotated-cell-7" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-7" data-code-lines="9,10,11" data-code-annotation="3">Calculate averages for all numeric columns per group</span>
</dd>
<dt data-target-cell="annotated-cell-7" data-target-annotation="4">4</dt>
<dd>
<span data-code-cell="annotated-cell-7" data-code-lines="12" data-code-annotation="4">Daily averages for each metric</span>
</dd>
<dt data-target-cell="annotated-cell-7" data-target-annotation="5">5</dt>
<dd>
<span data-code-cell="annotated-cell-7" data-code-lines="13,14,15" data-code-annotation="5">Table generation</span>
</dd>
</dl>
</div>
<div id="tbl-nearworkepisodes" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-nearworkepisodes-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;7: Near-work episodes: frequency, mean duration, and mean viewing distance
</figcaption>
<div aria-describedby="tbl-nearworkepisodes-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="szniszjxyw" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#szniszjxyw table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#szniszjxyw thead, #szniszjxyw tbody, #szniszjxyw tfoot, #szniszjxyw tr, #szniszjxyw td, #szniszjxyw th {
  border-style: none;
}

#szniszjxyw p {
  margin: 0;
  padding: 0;
}

#szniszjxyw .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#szniszjxyw .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#szniszjxyw .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#szniszjxyw .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#szniszjxyw .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#szniszjxyw .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#szniszjxyw .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#szniszjxyw .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#szniszjxyw .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#szniszjxyw .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#szniszjxyw .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#szniszjxyw .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#szniszjxyw .gt_spanner_row {
  border-bottom-style: hidden;
}

#szniszjxyw .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#szniszjxyw .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#szniszjxyw .gt_from_md > :first-child {
  margin-top: 0;
}

#szniszjxyw .gt_from_md > :last-child {
  margin-bottom: 0;
}

#szniszjxyw .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#szniszjxyw .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#szniszjxyw .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#szniszjxyw .gt_row_group_first td {
  border-top-width: 2px;
}

#szniszjxyw .gt_row_group_first th {
  border-top-width: 2px;
}

#szniszjxyw .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#szniszjxyw .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#szniszjxyw .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#szniszjxyw .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#szniszjxyw .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#szniszjxyw .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#szniszjxyw .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#szniszjxyw .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#szniszjxyw .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#szniszjxyw .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#szniszjxyw .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#szniszjxyw .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#szniszjxyw .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#szniszjxyw .gt_left {
  text-align: left;
}

#szniszjxyw .gt_center {
  text-align: center;
}

#szniszjxyw .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#szniszjxyw .gt_font_normal {
  font-weight: normal;
}

#szniszjxyw .gt_font_bold {
  font-weight: bold;
}

#szniszjxyw .gt_font_italic {
  font-style: italic;
}

#szniszjxyw .gt_super {
  font-size: 65%;
}

#szniszjxyw .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#szniszjxyw .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#szniszjxyw .gt_indent_1 {
  text-indent: 5px;
}

#szniszjxyw .gt_indent_2 {
  text-indent: 10px;
}

#szniszjxyw .gt_indent_3 {
  text-indent: 15px;
}

#szniszjxyw .gt_indent_4 {
  text-indent: 20px;
}

#szniszjxyw .gt_indent_5 {
  text-indent: 25px;
}

#szniszjxyw .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#szniszjxyw div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-bootstrap="false">
<thead>
<tr class="gt_col_headings header">
<th id="Date" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Date</th>
<th id="duration" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">duration</th>
<th id="distance" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">distance, cm</th>
<th id="episodes" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">episodes</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="gt_group_heading_row odd">
<th colspan="4" id="Clouclip" class="gt_group_heading" data-quarto-table-cell-role="th" scope="colgroup">Clouclip</th>
</tr>
<tr class="gt_row_group_first even">
<td class="gt_row gt_left" headers="Clouclip  Date">Mean daily</td>
<td class="gt_row gt_center" headers="Clouclip  duration">233s (~3.88 minutes)</td>
<td class="gt_row gt_right" headers="Clouclip  distance">32</td>
<td class="gt_row gt_right" headers="Clouclip  episodes">57</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Clouclip  Date">Weekday</td>
<td class="gt_row gt_center" headers="Clouclip  duration">284s (~4.73 minutes)</td>
<td class="gt_row gt_right" headers="Clouclip  distance">32</td>
<td class="gt_row gt_right" headers="Clouclip  episodes">64</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Clouclip  Date">Weekend</td>
<td class="gt_row gt_center" headers="Clouclip  duration">104s (~1.73 minutes)</td>
<td class="gt_row gt_right" headers="Clouclip  distance">32</td>
<td class="gt_row gt_right" headers="Clouclip  episodes">40</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</figure>
</div>
</div>
<blockquote class="blockquote">
<p>In the code cell above, <code>extract_metric(..., distance = mean(Dis, ...))</code> computes the mean viewing distance during each episode, and the subsequent <code>summarize_numeric</code> and <code>mean_daily</code> steps derive daily averages of episode count, duration, and distance.</p>
</blockquote>
</section>
<section id="visual-breaks" class="level4" data-number="3.1.5">
<h4 data-number="3.1.5" class="anchored" data-anchor-id="visual-breaks"><span class="header-section-number">3.1.5</span> Visual breaks</h4>
<p><code>Visual breaks</code> as defined in this article, require a minimum break-length, and the previous episode is important. This leads to a two step process, where we first extract instances of <code>Distance</code> above 100 cm for at least 20 seconds, before we filter for a previous duration of at maximum 20 minutes. <a href="#tbl-visualbreaks" class="quarto-xref">Table&nbsp;8</a> provides the daily frequency of visual breaks.</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Calculate visual breaks</strong></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="annotated-cell-8"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-8-1"><a href="#annotated-cell-8-1"></a>dataCC <span class="sc">|&gt;</span> </span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-8" data-target-annotation="1" onclick="event.preventDefault();">1</a><span id="annotated-cell-8-2" class="code-annotation-target"><a href="#annotated-cell-8-2"></a>  <span class="fu">extract_clusters</span>(Dis <span class="sc">&gt;=</span> <span class="dv">100</span>,</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-8" data-target-annotation="2" onclick="event.preventDefault();">2</a><span id="annotated-cell-8-3" class="code-annotation-target"><a href="#annotated-cell-8-3"></a>                   <span class="at">cluster.duration =</span> <span class="st">"20 secs"</span>,</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-8" data-target-annotation="3" onclick="event.preventDefault();">3</a><span id="annotated-cell-8-4" class="code-annotation-target"><a href="#annotated-cell-8-4"></a>                   <span class="at">return.only.clusters =</span> <span class="cn">FALSE</span>,</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-8" data-target-annotation="4" onclick="event.preventDefault();">4</a><span id="annotated-cell-8-5" class="code-annotation-target"><a href="#annotated-cell-8-5"></a>                   <span class="at">drop.empty.groups =</span> <span class="cn">FALSE</span></span>
<span id="annotated-cell-8-6"><a href="#annotated-cell-8-6"></a>                   ) <span class="sc">|&gt;</span> </span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-8" data-target-annotation="5" onclick="event.preventDefault();">5</a><span id="annotated-cell-8-7" class="code-annotation-target"><a href="#annotated-cell-8-7"></a>  <span class="fu">filter</span>((start <span class="sc">-</span> <span class="fu">lag</span>(end) <span class="sc">&lt;=</span> <span class="fu">duration</span>(<span class="st">"20 mins"</span>)), is.cluster) <span class="sc">|&gt;</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-8" data-target-annotation="6" onclick="event.preventDefault();">6</a><span id="annotated-cell-8-8" class="code-annotation-target"><a href="#annotated-cell-8-8"></a>  <span class="fu">summarize_numeric</span>(<span class="at">remove =</span> <span class="fu">c</span>(<span class="st">"start"</span>, <span class="st">"end"</span>, <span class="st">"epoch"</span>, <span class="st">"is.cluster"</span>, <span class="st">"duration"</span>),</span>
<span id="annotated-cell-8-9"><a href="#annotated-cell-8-9"></a>                    <span class="at">prefix =</span> <span class="st">""</span>,</span>
<span id="annotated-cell-8-10"><a href="#annotated-cell-8-10"></a>                    <span class="at">add.total.duration =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-8" data-target-annotation="7" onclick="event.preventDefault();">7</a><span id="annotated-cell-8-11" class="code-annotation-target"><a href="#annotated-cell-8-11"></a>  <span class="fu">mean_daily</span>(<span class="at">prefix =</span> <span class="st">"Daily "</span>) <span class="sc">|&gt;</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-8" data-target-annotation="8" onclick="event.preventDefault();">8</a><span id="annotated-cell-8-12" class="code-annotation-target"><a href="#annotated-cell-8-12"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span></span>
<span id="annotated-cell-8-13"><a href="#annotated-cell-8-13"></a>  <span class="fu">fmt_number</span>(<span class="at">decimals =</span> <span class="dv">1</span>)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-8" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-8" data-code-lines="2" data-code-annotation="1">Define the condition, greater 100 cm away</span>
</dd>
<dt data-target-cell="annotated-cell-8" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-8" data-code-lines="3" data-code-annotation="2">Define the minimum duration</span>
</dd>
<dt data-target-cell="annotated-cell-8" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-8" data-code-lines="4" data-code-annotation="3">Return non-clusters as well</span>
</dd>
<dt data-target-cell="annotated-cell-8" data-target-annotation="4">4</dt>
<dd>
<span data-code-cell="annotated-cell-8" data-code-lines="5" data-code-annotation="4">Keep all days, even without clusters</span>
</dd>
<dt data-target-cell="annotated-cell-8" data-target-annotation="5">5</dt>
<dd>
<span data-code-cell="annotated-cell-8" data-code-lines="7" data-code-annotation="5">Return only clusters with previous episode lengths of maximum 20 minutes</span>
</dd>
<dt data-target-cell="annotated-cell-8" data-target-annotation="6">6</dt>
<dd>
<span data-code-cell="annotated-cell-8" data-code-lines="8,9,10" data-code-annotation="6">Count the number of episodes</span>
</dd>
<dt data-target-cell="annotated-cell-8" data-target-annotation="7">7</dt>
<dd>
<span data-code-cell="annotated-cell-8" data-code-lines="11" data-code-annotation="7">Calculate daily means</span>
</dd>
<dt data-target-cell="annotated-cell-8" data-target-annotation="8">8</dt>
<dd>
<span data-code-cell="annotated-cell-8" data-code-lines="12,13" data-code-annotation="8">Table generation</span>
</dd>
</dl>
</div>
<div id="tbl-visualbreaks" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-visualbreaks-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;8: Frequency of visual breaks
</figcaption>
<div aria-describedby="tbl-visualbreaks-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="dvhcfyuxwt" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#dvhcfyuxwt table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#dvhcfyuxwt thead, #dvhcfyuxwt tbody, #dvhcfyuxwt tfoot, #dvhcfyuxwt tr, #dvhcfyuxwt td, #dvhcfyuxwt th {
  border-style: none;
}

#dvhcfyuxwt p {
  margin: 0;
  padding: 0;
}

#dvhcfyuxwt .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#dvhcfyuxwt .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#dvhcfyuxwt .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#dvhcfyuxwt .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#dvhcfyuxwt .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#dvhcfyuxwt .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dvhcfyuxwt .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#dvhcfyuxwt .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#dvhcfyuxwt .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#dvhcfyuxwt .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#dvhcfyuxwt .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#dvhcfyuxwt .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#dvhcfyuxwt .gt_spanner_row {
  border-bottom-style: hidden;
}

#dvhcfyuxwt .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#dvhcfyuxwt .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#dvhcfyuxwt .gt_from_md > :first-child {
  margin-top: 0;
}

#dvhcfyuxwt .gt_from_md > :last-child {
  margin-bottom: 0;
}

#dvhcfyuxwt .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#dvhcfyuxwt .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#dvhcfyuxwt .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#dvhcfyuxwt .gt_row_group_first td {
  border-top-width: 2px;
}

#dvhcfyuxwt .gt_row_group_first th {
  border-top-width: 2px;
}

#dvhcfyuxwt .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#dvhcfyuxwt .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#dvhcfyuxwt .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#dvhcfyuxwt .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dvhcfyuxwt .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#dvhcfyuxwt .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#dvhcfyuxwt .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#dvhcfyuxwt .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#dvhcfyuxwt .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dvhcfyuxwt .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#dvhcfyuxwt .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#dvhcfyuxwt .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#dvhcfyuxwt .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#dvhcfyuxwt .gt_left {
  text-align: left;
}

#dvhcfyuxwt .gt_center {
  text-align: center;
}

#dvhcfyuxwt .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#dvhcfyuxwt .gt_font_normal {
  font-weight: normal;
}

#dvhcfyuxwt .gt_font_bold {
  font-weight: bold;
}

#dvhcfyuxwt .gt_font_italic {
  font-style: italic;
}

#dvhcfyuxwt .gt_super {
  font-size: 65%;
}

#dvhcfyuxwt .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#dvhcfyuxwt .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#dvhcfyuxwt .gt_indent_1 {
  text-indent: 5px;
}

#dvhcfyuxwt .gt_indent_2 {
  text-indent: 10px;
}

#dvhcfyuxwt .gt_indent_3 {
  text-indent: 15px;
}

#dvhcfyuxwt .gt_indent_4 {
  text-indent: 20px;
}

#dvhcfyuxwt .gt_indent_5 {
  text-indent: 25px;
}

#dvhcfyuxwt .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#dvhcfyuxwt div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-bootstrap="false">
<thead>
<tr class="gt_col_headings header">
<th id="Date" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Date</th>
<th id="Daily-episodes" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Daily episodes</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="gt_group_heading_row odd">
<th colspan="2" id="Clouclip" class="gt_group_heading" data-quarto-table-cell-role="th" scope="colgroup">Clouclip</th>
</tr>
<tr class="gt_row_group_first even">
<td class="gt_row gt_left" headers="Clouclip  Date">Mean daily</td>
<td class="gt_row gt_right" headers="Clouclip  Daily episodes">5.9</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Clouclip  Date">Weekday</td>
<td class="gt_row gt_right" headers="Clouclip  Daily episodes">6.2</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Clouclip  Date">Weekend</td>
<td class="gt_row gt_right" headers="Clouclip  Daily episodes">5.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</figure>
</div>
</div>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Plot visual breaks</strong></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="annotated-cell-9"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><a class="code-annotation-anchor" data-target-cell="annotated-cell-9" data-target-annotation="1" onclick="event.preventDefault();">1</a><span id="annotated-cell-9-1" class="code-annotation-target"><a href="#annotated-cell-9-1"></a>dataCC <span class="sc">|&gt;</span></span>
<span id="annotated-cell-9-2"><a href="#annotated-cell-9-2"></a>    <span class="fu">extract_clusters</span>(Dis <span class="sc">&gt;=</span> <span class="dv">100</span>,</span>
<span id="annotated-cell-9-3"><a href="#annotated-cell-9-3"></a>                   <span class="at">cluster.duration =</span> <span class="st">"20 secs"</span>,</span>
<span id="annotated-cell-9-4"><a href="#annotated-cell-9-4"></a>                   <span class="at">return.only.clusters =</span> <span class="cn">FALSE</span>,</span>
<span id="annotated-cell-9-5"><a href="#annotated-cell-9-5"></a>                   <span class="at">drop.empty.groups =</span> <span class="cn">FALSE</span></span>
<span id="annotated-cell-9-6"><a href="#annotated-cell-9-6"></a>                   ) <span class="sc">|&gt;</span></span>
<span id="annotated-cell-9-7"><a href="#annotated-cell-9-7"></a>  <span class="fu">filter</span>((start <span class="sc">-</span> <span class="fu">lag</span>(end) <span class="sc">&lt;=</span> <span class="fu">duration</span>(<span class="st">"20 mins"</span>)), is.cluster) <span class="sc">%&gt;%</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-9" data-target-annotation="2" onclick="event.preventDefault();">2</a><span id="annotated-cell-9-8" class="code-annotation-target"><a href="#annotated-cell-9-8"></a>  <span class="fu">add_states</span>(dataCC, ., ) <span class="sc">|&gt;</span></span>
<span id="annotated-cell-9-9"><a href="#annotated-cell-9-9"></a>  <span class="fu">gg_day</span>(<span class="at">y.axis =</span> Dis, <span class="at">y.axis.label =</span> <span class="st">"Distance (cm)"</span>, <span class="at">geom =</span> <span class="st">"line"</span>) <span class="sc">|&gt;</span> </span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-9" data-target-annotation="3" onclick="event.preventDefault();">3</a><span id="annotated-cell-9-10" class="code-annotation-target"><a href="#annotated-cell-9-10"></a>  <span class="fu">gg_photoperiod</span>(coordinates) <span class="sc">+</span></span>
<span id="annotated-cell-9-11"><a href="#annotated-cell-9-11"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> \(x) <span class="fu">filter</span>(x, is.cluster), <span class="at">col =</span> <span class="st">"red"</span>)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-9" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-9" data-code-lines="1,2,3,4,5,6,7" data-code-annotation="1">As in the code cell above</span>
</dd>
<dt data-target-cell="annotated-cell-9" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-9" data-code-lines="8" data-code-annotation="2">Add the resulting states</span>
</dd>
<dt data-target-cell="annotated-cell-9" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-9" data-code-lines="10" data-code-annotation="3">Add photoperiod information to the plot</span>
</dd>
</dl>
</div>
<div class="cell-output-display">
<div id="fig-cluster" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-cluster-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="index_files/figure-html/fig-cluster-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4" title="Figure&nbsp;3: Plot of visual breaks (red dots). Black traces show distance measurement data. Grey shaded areas show nighttime between civil dusk and civil dawn"><img src="index_files/figure-html/fig-cluster-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-cluster-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Plot of visual breaks (red dots). Black traces show distance measurement data. Grey shaded areas show nighttime between civil dusk and civil dawn
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="distance-with-spatial-distribution" class="level4" data-number="3.1.6">
<h4 data-number="3.1.6" class="anchored" data-anchor-id="distance-with-spatial-distribution"><span class="header-section-number">3.1.6</span> Distance with spatial distribution</h4>
<p>The <code>Clouclip</code> device outputs a singular measure for distance, while the visual environment in natural conditions contains many distances, depending on the solid angle and direction of the measurement. A device like the <code>VEET</code> increases the spatial resolution of these measurements, allowing for more in-depth analyses of the size and position of an object within the field of view. In the case of the <code>VEET</code>, data are collected from an 8x8 measurement grid, spanning 52° vertically and 41° horizontally. Here are sample observations from six different days at the same time.</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Plot spatial distance grids for different days</strong></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="annotated-cell-11"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-11-1"><a href="#annotated-cell-11-1"></a>dataVEET3 <span class="sc">|&gt;</span> </span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-11" data-target-annotation="1" onclick="event.preventDefault();">1</a><span id="annotated-cell-11-2" class="code-annotation-target"><a href="#annotated-cell-11-2"></a>  <span class="fu">filter_Time</span>(<span class="at">start =</span> <span class="st">"13:14:02"</span>, <span class="at">length =</span> <span class="st">"00:00:05"</span>) <span class="sc">|&gt;</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-11" data-target-annotation="2" onclick="event.preventDefault();">2</a><span id="annotated-cell-11-3" class="code-annotation-target"><a href="#annotated-cell-11-3"></a>  <span class="fu">mutate</span>(<span class="at">dist1 =</span> <span class="fu">ifelse</span>(dist1 <span class="sc">==</span> <span class="dv">0</span>, <span class="cn">Inf</span>, dist1)) <span class="sc">|&gt;</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-11" data-target-annotation="3" onclick="event.preventDefault();">3</a><span id="annotated-cell-11-4" class="code-annotation-target"><a href="#annotated-cell-11-4"></a>  <span class="fu">filter</span>(conf1 <span class="sc">&gt;=</span> <span class="fl">0.1</span> <span class="sc">|</span> dist1 <span class="sc">==</span> <span class="cn">Inf</span>) <span class="sc">|&gt;</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-11" data-target-annotation="4" onclick="event.preventDefault();">4</a><span id="annotated-cell-11-5" class="code-annotation-target"><a href="#annotated-cell-11-5"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>x.pos, <span class="at">y=</span>y.pos, <span class="at">fill =</span> dist1<span class="sc">/</span><span class="dv">10</span>))<span class="sc">+</span></span>
<span id="annotated-cell-11-6"><a href="#annotated-cell-11-6"></a>  extras <span class="sc">+</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-11" data-target-annotation="5" onclick="event.preventDefault();">5</a><span id="annotated-cell-11-7" class="code-annotation-target"><a href="#annotated-cell-11-7"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Datetime)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-11" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-11" data-code-lines="2" data-code-annotation="1">Choose a particular observation</span>
</dd>
<dt data-target-cell="annotated-cell-11" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-11" data-code-lines="3" data-code-annotation="2">Replace 0 distances with infinity</span>
</dd>
<dt data-target-cell="annotated-cell-11" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-11" data-code-lines="4" data-code-annotation="3">Remove data that has less than 10% confidence</span>
</dd>
<dt data-target-cell="annotated-cell-11" data-target-annotation="4">4</dt>
<dd>
<span data-code-cell="annotated-cell-11" data-code-lines="5,6" data-code-annotation="4">Plot the data and add the plot partials from the code cell above</span>
</dd>
<dt data-target-cell="annotated-cell-11" data-target-annotation="5">5</dt>
<dd>
<span data-code-cell="annotated-cell-11" data-code-lines="7" data-code-annotation="5">Show one plot per day</span>
</dd>
</dl>
</div>
<div class="cell-output-display">
<div id="fig-VEET-distance" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-VEET-distance-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="index_files/figure-html/fig-VEET-distance-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5" title="Figure&nbsp;4: Example observations of the measurement grid at 1:14 p.m. for each measurement day. Text values show distance in cm. Empty grid points show values with low confidence. Zero-distance values were replaced with infinite distance and plotted despite low confidence."><img src="index_files/figure-html/fig-VEET-distance-1.png" class="img-fluid figure-img" width="1152"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-VEET-distance-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: Example observations of the measurement grid at 1:14 p.m. for each measurement day. Text values show distance in cm. Empty grid points show values with low confidence. Zero-distance values were replaced with infinite distance and plotted despite low confidence.
</figcaption>
</figure>
</div>
</div>
</div>
<p>To use these distance data in the framework shown above for the <code>Clouclip</code> device, a sensible method to condense the data has to be applied. There are many ways how a spatially resolved distance measure could be utilized for analysis:</p>
<ul>
<li>Where in the field of view are objects in close range?</li>
<li>How large are near objects in the field of view?</li>
<li>How varied are distances within the field of view?</li>
<li>How close are objects / is viewing distance in a region of interest within the field of view?</li>
</ul>
<p>Possible methods include:</p>
<ul>
<li>average across all (high confidence) distance values within the grid</li>
<li>closest (high confidence) distance within the grid</li>
<li>(high confidence) values at or around a given grid position, e.g., ±10 degrees around the central view (0°)</li>
</ul>
<p>Many more options are available based on the spatial dataset, e.g., condensation rules based on the number of points in the grid with a given condition, or the variation within the grid.</p>
<p>We will demonstrate these three methods for a single day (<code>2024-06-10</code>), all leading to a data structure akin to the <code>Clouclip</code>, i.e., to be used for further calculation of visual experience metrics.</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Calculating and plotting method results</strong></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="annotated-cell-12"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><a class="code-annotation-anchor" data-target-cell="annotated-cell-12" data-target-annotation="1" onclick="event.preventDefault();">1</a><span id="annotated-cell-12-1" class="code-annotation-target"><a href="#annotated-cell-12-1"></a>dataVEET3_part <span class="ot">&lt;-</span></span>
<span id="annotated-cell-12-2"><a href="#annotated-cell-12-2"></a>dataVEET3 <span class="sc">|&gt;</span></span>
<span id="annotated-cell-12-3"><a href="#annotated-cell-12-3"></a>  <span class="fu">filter_Date</span>(<span class="at">start =</span> <span class="st">"2024-06-10"</span>, <span class="at">length =</span> <span class="st">"1 day"</span>)</span>
<span id="annotated-cell-12-4"><a href="#annotated-cell-12-4"></a></span>
<span id="annotated-cell-12-5"><a href="#annotated-cell-12-5"></a>dataVEET3_condensed <span class="ot">&lt;-</span> </span>
<span id="annotated-cell-12-6"><a href="#annotated-cell-12-6"></a>dataVEET3_part <span class="sc">|&gt;</span> </span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-12" data-target-annotation="2" onclick="event.preventDefault();">2</a><span id="annotated-cell-12-7" class="code-annotation-target"><a href="#annotated-cell-12-7"></a>  <span class="fu">group_by</span>(Datetime, <span class="at">.add =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-12" data-target-annotation="3" onclick="event.preventDefault();">3</a><span id="annotated-cell-12-8" class="code-annotation-target"><a href="#annotated-cell-12-8"></a>  <span class="fu">filter</span>(conf1 <span class="sc">&gt;=</span> <span class="fl">0.1</span>) <span class="sc">|&gt;</span></span>
<span id="annotated-cell-12-9"><a href="#annotated-cell-12-9"></a>  <span class="fu">summarize</span>(</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-12" data-target-annotation="4" onclick="event.preventDefault();">4</a><span id="annotated-cell-12-10" class="code-annotation-target"><a href="#annotated-cell-12-10"></a>    <span class="at">distance_mean =</span> <span class="fu">mean</span>(dist1),</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-12" data-target-annotation="5" onclick="event.preventDefault();">5</a><span id="annotated-cell-12-11" class="code-annotation-target"><a href="#annotated-cell-12-11"></a>    <span class="at">distance_min =</span> <span class="fu">min</span>(dist1),</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-12" data-target-annotation="6" onclick="event.preventDefault();">6</a><span id="annotated-cell-12-12" class="code-annotation-target"><a href="#annotated-cell-12-12"></a>    <span class="at">distance_central =</span> <span class="fu">mean</span>(dist1[<span class="fu">between</span>(x.pos, <span class="sc">-</span><span class="dv">10</span>,<span class="dv">10</span>) <span class="sc">&amp;</span> <span class="fu">between</span>(y.pos, <span class="sc">-</span><span class="dv">10</span>,<span class="dv">10</span>)]),</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-12" data-target-annotation="7" onclick="event.preventDefault();">7</a><span id="annotated-cell-12-13" class="code-annotation-target"><a href="#annotated-cell-12-13"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="annotated-cell-12-14"><a href="#annotated-cell-12-14"></a>    <span class="at">.groups =</span> <span class="st">"drop_last"</span></span>
<span id="annotated-cell-12-15"><a href="#annotated-cell-12-15"></a>  )</span>
<span id="annotated-cell-12-16"><a href="#annotated-cell-12-16"></a></span>
<span id="annotated-cell-12-17"><a href="#annotated-cell-12-17"></a>dataVEET3_condensed <span class="sc">|&gt;</span> </span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-12" data-target-annotation="8" onclick="event.preventDefault();">8</a><span id="annotated-cell-12-18" class="code-annotation-target"><a href="#annotated-cell-12-18"></a>  <span class="fu">aggregate_Datetime</span>(<span class="st">"15 mins"</span>, <span class="at">numeric.handler =</span> \(x) <span class="fu">mean</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-12" data-target-annotation="9" onclick="event.preventDefault();">9</a><span id="annotated-cell-12-19" class="code-annotation-target"><a href="#annotated-cell-12-19"></a>  <span class="fu">remove_partial_data</span>(<span class="at">by.date =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-12" data-target-annotation="10" onclick="event.preventDefault();">10</a><span id="annotated-cell-12-20" class="code-annotation-target"><a href="#annotated-cell-12-20"></a>  <span class="fu">pivot_longer</span>(<span class="fu">contains</span>(<span class="st">"distance"</span>),</span>
<span id="annotated-cell-12-21"><a href="#annotated-cell-12-21"></a>               <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">".value"</span>, <span class="st">"method"</span>),</span>
<span id="annotated-cell-12-22"><a href="#annotated-cell-12-22"></a>    <span class="at">names_pattern =</span> <span class="st">"(distance)_(mean|min|max|central)"</span></span>
<span id="annotated-cell-12-23"><a href="#annotated-cell-12-23"></a>    ) <span class="sc">|&gt;</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-12" data-target-annotation="11" onclick="event.preventDefault();">11</a><span id="annotated-cell-12-24" class="code-annotation-target"><a href="#annotated-cell-12-24"></a>  <span class="fu">gg_day</span>(<span class="at">y.axis =</span> distance<span class="sc">/</span><span class="dv">10</span>,</span>
<span id="annotated-cell-12-25"><a href="#annotated-cell-12-25"></a>         <span class="at">geom =</span> <span class="st">"line"</span>,</span>
<span id="annotated-cell-12-26"><a href="#annotated-cell-12-26"></a>         <span class="at">aes_col =</span> method,</span>
<span id="annotated-cell-12-27"><a href="#annotated-cell-12-27"></a>         <span class="at">group =</span> method,</span>
<span id="annotated-cell-12-28"><a href="#annotated-cell-12-28"></a>         <span class="at">linewidth =</span> <span class="dv">1</span>,</span>
<span id="annotated-cell-12-29"><a href="#annotated-cell-12-29"></a>         <span class="at">alpha =</span> <span class="fl">0.75</span>,</span>
<span id="annotated-cell-12-30"><a href="#annotated-cell-12-30"></a>         <span class="at">y.scale =</span> <span class="st">"identity"</span>,</span>
<span id="annotated-cell-12-31"><a href="#annotated-cell-12-31"></a>         <span class="at">y.axis.breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">150</span>, <span class="at">by =</span> <span class="dv">20</span>),</span>
<span id="annotated-cell-12-32"><a href="#annotated-cell-12-32"></a>         <span class="at">y.axis.label =</span> <span class="st">"Distance (cm)"</span></span>
<span id="annotated-cell-12-33"><a href="#annotated-cell-12-33"></a>         ) <span class="sc">|&gt;</span></span>
<span id="annotated-cell-12-34"><a href="#annotated-cell-12-34"></a>  <span class="fu">gg_photoperiod</span>(coordinates)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-12" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-12" data-code-lines="1,2,3" data-code-annotation="1">Filter one day</span>
</dd>
<dt data-target-cell="annotated-cell-12" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-12" data-code-lines="7" data-code-annotation="2">Group additionally by every observation</span>
</dd>
<dt data-target-cell="annotated-cell-12" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-12" data-code-lines="8" data-code-annotation="3">Remove data with low confidence</span>
</dd>
<dt data-target-cell="annotated-cell-12" data-target-annotation="4">4</dt>
<dd>
<span data-code-cell="annotated-cell-12" data-code-lines="10" data-code-annotation="4">Average across all distance values</span>
</dd>
<dt data-target-cell="annotated-cell-12" data-target-annotation="5">5</dt>
<dd>
<span data-code-cell="annotated-cell-12" data-code-lines="11" data-code-annotation="5">Closest across all distance values</span>
</dd>
<dt data-target-cell="annotated-cell-12" data-target-annotation="6">6</dt>
<dd>
<span data-code-cell="annotated-cell-12" data-code-lines="12" data-code-annotation="6">Central distance</span>
</dd>
<dt data-target-cell="annotated-cell-12" data-target-annotation="7">7</dt>
<dd>
<span data-code-cell="annotated-cell-12" data-code-lines="13" data-code-annotation="7">Number of (valid) grid points</span>
</dd>
<dt data-target-cell="annotated-cell-12" data-target-annotation="8">8</dt>
<dd>
<span data-code-cell="annotated-cell-12" data-code-lines="18" data-code-annotation="8">Aggregate to 15 minute data</span>
</dd>
<dt data-target-cell="annotated-cell-12" data-target-annotation="9">9</dt>
<dd>
<span data-code-cell="annotated-cell-12" data-code-lines="19" data-code-annotation="9">Remove data points that fall exactly on midnight of the following day</span>
</dd>
<dt data-target-cell="annotated-cell-12" data-target-annotation="10">10</dt>
<dd>
<span data-code-cell="annotated-cell-12" data-code-lines="20,21,22,23" data-code-annotation="10">Pivoting the method results from wide to long for plotting</span>
</dd>
<dt data-target-cell="annotated-cell-12" data-target-annotation="11">11</dt>
<dd>
<span data-code-cell="annotated-cell-12" data-code-lines="24,25,26,27,28,29,30,31,32,33,34" data-code-annotation="11">Setting up the plot for distance.</span>
</dd>
</dl>
</div>
<div class="cell-output-display">
<div id="fig-VEET-distance_methods" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-VEET-distance_methods-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="index_files/figure-html/fig-VEET-distance_methods-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6" title="Figure&nbsp;5: Comparison of condensation methods for spatial grid of distance measurements. The lines represent an average across all data points (yellow), the minimum distance (grey), or the central 10° (blue). Data points with confidence less than 10% were removed prior to calculation."><img src="index_files/figure-html/fig-VEET-distance_methods-1.png" class="img-fluid figure-img" width="768"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-VEET-distance_methods-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: Comparison of condensation methods for spatial grid of distance measurements. The lines represent an average across all data points (yellow), the minimum distance (grey), or the central 10° (blue). Data points with confidence less than 10% were removed prior to calculation.
</figcaption>
</figure>
</div>
</div>
</div>
<p>As can be seen in <a href="#fig-VEET-distance_methods" class="quarto-xref">Figure&nbsp;5</a>, while the overall pattern is similar regardless of the used method, there are notable differences between the methods, which will consequently affect downstream analyses. Most importantly, the process of condensation has to be well documented and reproducible, as shown above. Any of these data could now be used to calculate the <code>frequency of continuous near work</code>, <code>visual breaks</code>, or <code>near-work episodes</code> as described above.</p>
</section>
</section>
<section id="light" class="level3 page-columns page-full" data-number="3.2">
<h3 data-number="3.2" class="anchored" data-anchor-id="light"><span class="header-section-number">3.2</span> Light</h3>
<p>The <code>Clouclip</code> illuminance data in our example cover indoor environments and are thus comparatively low, which would make certain daylight exposure summaries trivial or not meaningful. To better illustrate light exposure metrics, we turn to a different dataset, this one taken from the <code>VEET</code> device’s illuminance data, which capture a broader range of lighting conditions (though both device types are able to capture broadly the same range of illuminance). We import the <code>VEET</code> ambient light data (already preprocessed to have regular 5-second intervals as described above) and briefly examine its distribution.</p>
<p><strong>Illuminance distribution</strong>: The illuminance values from the <code>Clouclip</code> were comparatively low, while the <code>VEET</code> data include outdoor exposures up to several thousand lux. The contrast is evident from comparing histograms of the two datasets’ lux values (<code>Clouclip</code> vs.&nbsp;<code>VEET</code>), where the main peak is similarly positioned between 10 and 100 lx, but the tails differ. The <code>VEET</code> illuminance histogram (see <a href="#fig-hist-VEETlight" class="quarto-xref">Figure&nbsp;7</a>) shows a heavily skewed distribution with a considerable number of zero lx values (indicating intervals of complete darkness or the sensor being covered) and a long tail extending to very high lux values. Such zero-inflated and skewed data are common in wearable light measurements <span class="citation" data-cites="ZaunerEtAl2025JBR">(<a href="#ref-ZaunerEtAl2025JBR" role="doc-biblioref">J. Zauner, Guidolin, and Spitschan</a>)</span>.</p>
<div class="cell page-columns page-full">

<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div id="fig-hist-CClight" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-hist-CClight-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="index_files/figure-html/fig-hist-CClight-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7" title="Figure&nbsp;6: Histogram of illuminance values from the Clouclip dataset (5-second data). The values are typical of indoor conditions."><img src="index_files/figure-html/fig-hist-CClight-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-hist-CClight-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6: Histogram of illuminance values from the Clouclip dataset (5-second data). The values are typical of indoor conditions.
</figcaption>
</figure>
</div>
</div></div></div>
<div class="cell page-columns page-full">

<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div id="fig-hist-VEETlight" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-hist-VEETlight-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="index_files/figure-html/fig-hist-VEETlight-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8" title="Figure&nbsp;7: Histogram of illuminance values from the VEET dataset (aggregated to 5&nbsp;s). Note the logarithmic x-axis: the distribution is highly skewed with many low values (including zeros) and a long tail of high lux readings. Outdoor light exposures in bright conditions are distinguishable around 10^3 to 10^4 lx."><img src="index_files/figure-html/fig-hist-VEETlight-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-hist-VEETlight-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7: Histogram of illuminance values from the VEET dataset (aggregated to 5&nbsp;s). Note the logarithmic x-axis: the distribution is highly skewed with many low values (including zeros) and a long tail of high lux readings. Outdoor light exposures in bright conditions are distinguishable around 10^3 to 10^4 lx.
</figcaption>
</figure>
</div>
</div></div></div>
<p>After confirming that the <code>VEET</code> data cover a broad dynamic range of lighting, we proceed with calculating light exposure metrics. (The VEET data had been cleaned for gaps and irregularities as described earlier, and non-wear times were removed; see <a href="./supplement.html">Supplement&nbsp;1</a> for the details.)</p>
<section id="sec-avelight" class="level4" data-number="3.2.1">
<h4 data-number="3.2.1" class="anchored" data-anchor-id="sec-avelight"><span class="header-section-number">3.2.1</span> Average light exposure</h4>
<p>A basic metric is the average illuminance over the day. <a href="#tbl-lightexposure" class="quarto-xref">Table&nbsp;9</a> shows the mean illuminance (in lux) for weekdays, weekends, and the overall daily mean, calculated directly from the raw lux values.</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Calculating mean light exposure per day</strong></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>dataVEET <span class="sc">|&gt;</span> </span>
<span id="cb3-2"><a href="#cb3-2"></a>  <span class="fu">select</span>(Id, Date, Datetime, Lux) <span class="sc">|&gt;</span> </span>
<span id="cb3-3"><a href="#cb3-3"></a>  <span class="fu">summarize_numeric</span>(<span class="at">prefix =</span> <span class="st">"mean "</span>, <span class="at">remove =</span> <span class="fu">c</span>(<span class="st">"Datetime"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb3-4"><a href="#cb3-4"></a>  <span class="fu">to_mean_daily</span>() <span class="sc">|&gt;</span></span>
<span id="cb3-5"><a href="#cb3-5"></a>  <span class="fu">fmt_number</span>(<span class="at">decimals =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb3-6"><a href="#cb3-6"></a>  <span class="fu">cols_hide</span>(<span class="st">`</span><span class="at">average episodes</span><span class="st">`</span>) <span class="sc">|&gt;</span></span>
<span id="cb3-7"><a href="#cb3-7"></a>  <span class="fu">cols_label</span>(<span class="st">`</span><span class="at">average mean Lux</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"Mean photopic illuminance (lx)"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="tbl-lightexposure" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-lightexposure-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;9: Mean light exposure (illuminance) per day
</figcaption>
<div aria-describedby="tbl-lightexposure-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="fsasudsuht" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#fsasudsuht table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#fsasudsuht thead, #fsasudsuht tbody, #fsasudsuht tfoot, #fsasudsuht tr, #fsasudsuht td, #fsasudsuht th {
  border-style: none;
}

#fsasudsuht p {
  margin: 0;
  padding: 0;
}

#fsasudsuht .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#fsasudsuht .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#fsasudsuht .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#fsasudsuht .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#fsasudsuht .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#fsasudsuht .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#fsasudsuht .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#fsasudsuht .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#fsasudsuht .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#fsasudsuht .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#fsasudsuht .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#fsasudsuht .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#fsasudsuht .gt_spanner_row {
  border-bottom-style: hidden;
}

#fsasudsuht .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#fsasudsuht .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#fsasudsuht .gt_from_md > :first-child {
  margin-top: 0;
}

#fsasudsuht .gt_from_md > :last-child {
  margin-bottom: 0;
}

#fsasudsuht .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#fsasudsuht .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#fsasudsuht .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#fsasudsuht .gt_row_group_first td {
  border-top-width: 2px;
}

#fsasudsuht .gt_row_group_first th {
  border-top-width: 2px;
}

#fsasudsuht .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#fsasudsuht .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#fsasudsuht .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#fsasudsuht .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#fsasudsuht .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#fsasudsuht .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#fsasudsuht .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#fsasudsuht .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#fsasudsuht .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#fsasudsuht .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#fsasudsuht .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#fsasudsuht .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#fsasudsuht .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#fsasudsuht .gt_left {
  text-align: left;
}

#fsasudsuht .gt_center {
  text-align: center;
}

#fsasudsuht .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#fsasudsuht .gt_font_normal {
  font-weight: normal;
}

#fsasudsuht .gt_font_bold {
  font-weight: bold;
}

#fsasudsuht .gt_font_italic {
  font-style: italic;
}

#fsasudsuht .gt_super {
  font-size: 65%;
}

#fsasudsuht .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#fsasudsuht .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#fsasudsuht .gt_indent_1 {
  text-indent: 5px;
}

#fsasudsuht .gt_indent_2 {
  text-indent: 10px;
}

#fsasudsuht .gt_indent_3 {
  text-indent: 15px;
}

#fsasudsuht .gt_indent_4 {
  text-indent: 20px;
}

#fsasudsuht .gt_indent_5 {
  text-indent: 25px;
}

#fsasudsuht .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#fsasudsuht div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-bootstrap="false">
<thead>
<tr class="gt_col_headings header">
<th id="Date" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Date</th>
<th id="average-mean-Lux" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Mean photopic illuminance (lx)</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="gt_group_heading_row odd">
<th colspan="2" id="VEET" class="gt_group_heading" data-quarto-table-cell-role="th" scope="colgroup">VEET</th>
</tr>
<tr class="gt_row_group_first even">
<td class="gt_row gt_left" headers="VEET  Date">Mean daily</td>
<td class="gt_row gt_right" headers="VEET  average mean Lux">481.8</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="VEET  Date">Weekday</td>
<td class="gt_row gt_right" headers="VEET  average mean Lux">538.1</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="VEET  Date">Weekend</td>
<td class="gt_row gt_right" headers="VEET  average mean Lux">341.1</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</figure>
</div>
</div>
<p>However, because illuminance data tend to be extremely skewed and contain many zero values (periods of darkness), the arithmetic mean can be <a href="https://tscnlab.github.io/LightLogR/articles/log.html">misleading</a>. A common approach is to apply a logarithmic transform to illuminance before averaging, which down-weights extreme values and accounts for the multiplicative nature of light intensity effects. LightLogR provides helper functions <a href="(https://tscnlab.github.io/LightLogR/reference/log_zero_inflated.html)"><code>log_zero_inflated()</code></a> and its inverse <a href="https://tscnlab.github.io/LightLogR/reference/log_zero_inflated.html"><code>exp_zero_inflated()</code></a> to handle log-transformation when zeros are present (by adding a small offset before log, and back-transforming after averaging). Using this approach, we recompute the daily mean illuminance. The results in <a href="#tbl-lightexposure2" class="quarto-xref">Table&nbsp;10</a> show that the log-transformed mean (back-transformed to lux) is much lower, reflecting the fact that for much of the time illuminance was near zero. This transformed mean is often more representative of typical exposure for skewed data.</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Calculating mean light exposure per day with log transformation</strong></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="annotated-cell-14"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-14-1"><a href="#annotated-cell-14-1"></a>dataVEET <span class="sc">|&gt;</span> </span>
<span id="annotated-cell-14-2"><a href="#annotated-cell-14-2"></a>  <span class="fu">select</span>(Id, Date, Datetime, Lux) <span class="sc">|&gt;</span> </span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-14" data-target-annotation="1" onclick="event.preventDefault();">1</a><span id="annotated-cell-14-3" class="code-annotation-target"><a href="#annotated-cell-14-3"></a>  <span class="fu">mutate</span>(<span class="at">Lux =</span> Lux <span class="sc">|&gt;</span> <span class="fu">log_zero_inflated</span>()) <span class="sc">|&gt;</span></span>
<span id="annotated-cell-14-4"><a href="#annotated-cell-14-4"></a>  <span class="fu">summarize_numeric</span>(<span class="at">prefix =</span> <span class="st">"mean "</span>, <span class="at">remove =</span> <span class="fu">c</span>(<span class="st">"Datetime"</span>)) <span class="sc">|&gt;</span> </span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-14" data-target-annotation="2" onclick="event.preventDefault();">2</a><span id="annotated-cell-14-5" class="code-annotation-target"><a href="#annotated-cell-14-5"></a>  <span class="fu">mean_daily</span>(<span class="at">prefix =</span> <span class="st">""</span>) <span class="sc">|&gt;</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-14" data-target-annotation="3" onclick="event.preventDefault();">3</a><span id="annotated-cell-14-6" class="code-annotation-target"><a href="#annotated-cell-14-6"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">mean Lux</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">mean Lux</span><span class="st">`</span> <span class="sc">|&gt;</span> <span class="fu">exp_zero_inflated</span>()) <span class="sc">|&gt;</span></span>
<span id="annotated-cell-14-7"><a href="#annotated-cell-14-7"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span> <span class="fu">fmt_number</span>(<span class="at">decimals =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span> <span class="fu">cols_hide</span>(episodes) <span class="sc">|&gt;</span> </span>
<span id="annotated-cell-14-8"><a href="#annotated-cell-14-8"></a>  <span class="fu">cols_label</span>(<span class="st">`</span><span class="at">mean Lux</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"Mean photopic illuminance (lx)"</span>)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-14" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-14" data-code-lines="3" data-code-annotation="1">Log transform with zero handling (base 10)</span>
</dd>
<dt data-target-cell="annotated-cell-14" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-14" data-code-lines="5" data-code-annotation="2">Calculate daily mean of log-lux</span>
</dd>
<dt data-target-cell="annotated-cell-14" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-14" data-code-lines="6" data-code-annotation="3">Back-transform to lux</span>
</dd>
</dl>
</div>
<div id="tbl-lightexposure2" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-lightexposure2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;10: Mean light exposure per day (after logarithmic transformation to account for zero inflation and skewness)
</figcaption>
<div aria-describedby="tbl-lightexposure2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="yfyonbhfoq" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#yfyonbhfoq table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#yfyonbhfoq thead, #yfyonbhfoq tbody, #yfyonbhfoq tfoot, #yfyonbhfoq tr, #yfyonbhfoq td, #yfyonbhfoq th {
  border-style: none;
}

#yfyonbhfoq p {
  margin: 0;
  padding: 0;
}

#yfyonbhfoq .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#yfyonbhfoq .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#yfyonbhfoq .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#yfyonbhfoq .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#yfyonbhfoq .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#yfyonbhfoq .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#yfyonbhfoq .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#yfyonbhfoq .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#yfyonbhfoq .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#yfyonbhfoq .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#yfyonbhfoq .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#yfyonbhfoq .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#yfyonbhfoq .gt_spanner_row {
  border-bottom-style: hidden;
}

#yfyonbhfoq .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#yfyonbhfoq .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#yfyonbhfoq .gt_from_md > :first-child {
  margin-top: 0;
}

#yfyonbhfoq .gt_from_md > :last-child {
  margin-bottom: 0;
}

#yfyonbhfoq .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#yfyonbhfoq .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#yfyonbhfoq .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#yfyonbhfoq .gt_row_group_first td {
  border-top-width: 2px;
}

#yfyonbhfoq .gt_row_group_first th {
  border-top-width: 2px;
}

#yfyonbhfoq .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#yfyonbhfoq .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#yfyonbhfoq .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#yfyonbhfoq .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#yfyonbhfoq .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#yfyonbhfoq .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#yfyonbhfoq .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#yfyonbhfoq .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#yfyonbhfoq .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#yfyonbhfoq .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#yfyonbhfoq .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#yfyonbhfoq .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#yfyonbhfoq .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#yfyonbhfoq .gt_left {
  text-align: left;
}

#yfyonbhfoq .gt_center {
  text-align: center;
}

#yfyonbhfoq .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#yfyonbhfoq .gt_font_normal {
  font-weight: normal;
}

#yfyonbhfoq .gt_font_bold {
  font-weight: bold;
}

#yfyonbhfoq .gt_font_italic {
  font-style: italic;
}

#yfyonbhfoq .gt_super {
  font-size: 65%;
}

#yfyonbhfoq .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#yfyonbhfoq .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#yfyonbhfoq .gt_indent_1 {
  text-indent: 5px;
}

#yfyonbhfoq .gt_indent_2 {
  text-indent: 10px;
}

#yfyonbhfoq .gt_indent_3 {
  text-indent: 15px;
}

#yfyonbhfoq .gt_indent_4 {
  text-indent: 20px;
}

#yfyonbhfoq .gt_indent_5 {
  text-indent: 25px;
}

#yfyonbhfoq .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#yfyonbhfoq div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-bootstrap="false">
<thead>
<tr class="gt_col_headings header">
<th id="Date" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Date</th>
<th id="mean-Lux" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Mean photopic illuminance (lx)</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="gt_group_heading_row odd">
<th colspan="2" id="VEET" class="gt_group_heading" data-quarto-table-cell-role="th" scope="colgroup">VEET</th>
</tr>
<tr class="gt_row_group_first even">
<td class="gt_row gt_left" headers="VEET  Date">Mean daily</td>
<td class="gt_row gt_right" headers="VEET  mean Lux">57.0</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="VEET  Date">Weekday</td>
<td class="gt_row gt_right" headers="VEET  mean Lux">70.1</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="VEET  Date">Weekend</td>
<td class="gt_row gt_right" headers="VEET  mean Lux">33.9</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</figure>
</div>
</div>
</section>
<section id="sec-outdoorlight" class="level4" data-number="3.2.2">
<h4 data-number="3.2.2" class="anchored" data-anchor-id="sec-outdoorlight"><span class="header-section-number">3.2.2</span> Duration in high-light (outdoor) conditions</h4>
<p>Another important metric is the amount of time spent under bright light, often used as a proxy for outdoor exposure. We define thresholds corresponding to outdoor light levels (e.g.&nbsp;1000&nbsp;lx and above). Here, we categorize each 5-second interval of illuminance into bands: Outdoor bright (≥1000&nbsp;lx), Outdoor very bright (≥2000&nbsp;lx), and Outdoor extremely bright (≥3000&nbsp;lx). We then sum the duration in each category per day.</p>
<p>While daylight levels can far exceed the recorded light levels, those are usually recorded with direct sunlight and without obstruction. Under normal viewing conditions, at eye level, and avoiding glare, daylight levels of a few thousand lux are at the higher end of the distribution <span class="citation" data-cites="murukesu2025ADID">(<a href="#ref-murukesu2025ADID" role="doc-biblioref">Murukesu, Zauner, and Spitschan 2025</a>)</span>. <a href="#fig-hist-VEETlight" class="quarto-xref">Figure&nbsp;7</a> shows a bimodal distribution, with the right mode representing outdoor lighting conditions. In a 2023 review of light dosimeters to investigate the light-myopia relationship <span class="citation" data-cites="Honekopp2023ClinOphthalmol">(<a href="#ref-Honekopp2023ClinOphthalmol" role="doc-biblioref">Hönekopp and Weigelt 2023</a>)</span>, 1000 lx was the predominant cutoff value to distinguish indoor vs.&nbsp;outdoor environments. It is not, however, without critique, and both other thresholds <span class="citation" data-cites="pattersongentile2025">(<a href="#ref-pattersongentile2025" role="doc-biblioref">Patterson Gentile et al. 2025</a>)</span> and classification methods are proposed <span class="citation" data-cites="tabandeh2025">(<a href="#ref-tabandeh2025" role="doc-biblioref">Tabandeh and Spitschan 2025</a>)</span>.</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Define outdoor illuminance thresholds (in lux)</strong></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>out_breaks <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1e3</span>, <span class="fl">2e3</span>, <span class="fl">3e3</span>, <span class="cn">Inf</span>)</span>
<span id="cb4-2"><a href="#cb4-2"></a>out_labels <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb4-3"><a href="#cb4-3"></a>    <span class="st">"Indoor"</span>,                  <span class="co"># [0, 1000) lx</span></span>
<span id="cb4-4"><a href="#cb4-4"></a>    <span class="st">"Outdoor bright"</span>,          <span class="co"># [1000, 2000) lx</span></span>
<span id="cb4-5"><a href="#cb4-5"></a>    <span class="st">"Outdoor very bright"</span>,     <span class="co"># [2000, 3000) lx</span></span>
<span id="cb4-6"><a href="#cb4-6"></a>    <span class="st">"Outdoor extremely bright"</span> <span class="co"># [3000, ∞) lx</span></span>
<span id="cb4-7"><a href="#cb4-7"></a>  )</span>
<span id="cb4-8"><a href="#cb4-8"></a></span>
<span id="cb4-9"><a href="#cb4-9"></a>dataVEET <span class="ot">&lt;-</span> dataVEET <span class="sc">|&gt;</span> </span>
<span id="cb4-10"><a href="#cb4-10"></a>  <span class="fu">mutate</span>(<span class="at">Lux_range =</span> <span class="fu">cut</span>(Lux, <span class="at">breaks =</span> out_breaks, <span class="at">labels =</span> out_labels))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<p>Now we compute the mean daily duration spent in each of these outdoor light ranges (<a href="#tbl-outdoor" class="quarto-xref">Table&nbsp;11</a>):</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Calculate the mean daily duration spent in each light range</strong></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>dataVEET <span class="sc">|&gt;</span> </span>
<span id="cb5-2"><a href="#cb5-2"></a>  <span class="fu">drop_na</span>(Lux_range) <span class="sc">|&gt;</span> </span>
<span id="cb5-3"><a href="#cb5-3"></a>  <span class="fu">group_by</span>(Lux_range, <span class="at">.add =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb5-4"><a href="#cb5-4"></a>  <span class="fu">durations</span>(Lux) <span class="sc">|&gt;</span>                         </span>
<span id="cb5-5"><a href="#cb5-5"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> Lux_range, <span class="at">values_from =</span> duration) <span class="sc">|&gt;</span> </span>
<span id="cb5-6"><a href="#cb5-6"></a>  <span class="fu">to_mean_daily</span>(<span class="st">""</span>) <span class="sc">|&gt;</span> </span>
<span id="cb5-7"><a href="#cb5-7"></a>  <span class="fu">fmt_duration</span>(<span class="at">input_units =</span> <span class="st">"seconds"</span>, <span class="at">output_units =</span> <span class="st">"minutes"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="tbl-outdoor" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-outdoor-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;11: Average daily duration in outdoor-equivalent light conditions
</figcaption>
<div aria-describedby="tbl-outdoor-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="tjbalzewnp" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#tjbalzewnp table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#tjbalzewnp thead, #tjbalzewnp tbody, #tjbalzewnp tfoot, #tjbalzewnp tr, #tjbalzewnp td, #tjbalzewnp th {
  border-style: none;
}

#tjbalzewnp p {
  margin: 0;
  padding: 0;
}

#tjbalzewnp .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#tjbalzewnp .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#tjbalzewnp .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#tjbalzewnp .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#tjbalzewnp .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#tjbalzewnp .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#tjbalzewnp .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#tjbalzewnp .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#tjbalzewnp .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#tjbalzewnp .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#tjbalzewnp .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#tjbalzewnp .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#tjbalzewnp .gt_spanner_row {
  border-bottom-style: hidden;
}

#tjbalzewnp .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#tjbalzewnp .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#tjbalzewnp .gt_from_md > :first-child {
  margin-top: 0;
}

#tjbalzewnp .gt_from_md > :last-child {
  margin-bottom: 0;
}

#tjbalzewnp .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#tjbalzewnp .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#tjbalzewnp .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#tjbalzewnp .gt_row_group_first td {
  border-top-width: 2px;
}

#tjbalzewnp .gt_row_group_first th {
  border-top-width: 2px;
}

#tjbalzewnp .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#tjbalzewnp .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#tjbalzewnp .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#tjbalzewnp .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#tjbalzewnp .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#tjbalzewnp .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#tjbalzewnp .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#tjbalzewnp .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#tjbalzewnp .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#tjbalzewnp .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#tjbalzewnp .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#tjbalzewnp .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#tjbalzewnp .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#tjbalzewnp .gt_left {
  text-align: left;
}

#tjbalzewnp .gt_center {
  text-align: center;
}

#tjbalzewnp .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#tjbalzewnp .gt_font_normal {
  font-weight: normal;
}

#tjbalzewnp .gt_font_bold {
  font-weight: bold;
}

#tjbalzewnp .gt_font_italic {
  font-style: italic;
}

#tjbalzewnp .gt_super {
  font-size: 65%;
}

#tjbalzewnp .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#tjbalzewnp .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#tjbalzewnp .gt_indent_1 {
  text-indent: 5px;
}

#tjbalzewnp .gt_indent_2 {
  text-indent: 10px;
}

#tjbalzewnp .gt_indent_3 {
  text-indent: 15px;
}

#tjbalzewnp .gt_indent_4 {
  text-indent: 20px;
}

#tjbalzewnp .gt_indent_5 {
  text-indent: 25px;
}

#tjbalzewnp .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#tjbalzewnp div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-bootstrap="false">
<thead>
<tr class="gt_col_headings header">
<th id="Date" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Date</th>
<th id="Indoor" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Indoor</th>
<th id="Outdoor-bright" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Outdoor bright</th>
<th id="Outdoor-very-bright" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Outdoor very bright</th>
<th id="Outdoor-extremely-bright" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Outdoor extremely bright</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="gt_group_heading_row odd">
<th colspan="5" id="VEET" class="gt_group_heading" data-quarto-table-cell-role="th" scope="colgroup">VEET</th>
</tr>
<tr class="gt_row_group_first even">
<td class="gt_row gt_left" headers="VEET  Date">Mean daily</td>
<td class="gt_row gt_center" headers="VEET  Indoor">663m</td>
<td class="gt_row gt_center" headers="VEET  Outdoor bright">24m</td>
<td class="gt_row gt_center" headers="VEET  Outdoor very bright">28m</td>
<td class="gt_row gt_center" headers="VEET  Outdoor extremely bright">42m</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="VEET  Date">Weekday</td>
<td class="gt_row gt_center" headers="VEET  Indoor">688m</td>
<td class="gt_row gt_center" headers="VEET  Outdoor bright">29m</td>
<td class="gt_row gt_center" headers="VEET  Outdoor very bright">35m</td>
<td class="gt_row gt_center" headers="VEET  Outdoor extremely bright">48m</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="VEET  Date">Weekend</td>
<td class="gt_row gt_center" headers="VEET  Indoor">602m</td>
<td class="gt_row gt_center" headers="VEET  Outdoor bright">10m</td>
<td class="gt_row gt_center" headers="VEET  Outdoor very bright">10m</td>
<td class="gt_row gt_center" headers="VEET  Outdoor extremely bright">28m</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</figure>
</div>
</div>
<p>It is also informative to visualize when these high-light conditions occurred. <a href="#fig-outdoor" class="quarto-xref">Figure&nbsp;8</a> shows a timeline plot with periods of outdoor-level illuminance highlighted in color. In this example, violet denotes ≥1000&nbsp;lx, green ≥2000&nbsp;lx, and yellow ≥3000&nbsp;lx. Grey shading indicates nighttime (from civil dusk to dawn) for context.</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Visualize time spent outdoors</strong></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="annotated-cell-17"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-17-1"><a href="#annotated-cell-17-1"></a>dataVEET <span class="sc">|&gt;</span> </span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-17" data-target-annotation="1" onclick="event.preventDefault();">1</a><span id="annotated-cell-17-2" class="code-annotation-target"><a href="#annotated-cell-17-2"></a>  <span class="fu">aggregate_Datetime</span>(<span class="st">"2 mins"</span>, <span class="at">type =</span> <span class="st">"floor"</span>) <span class="sc">|&gt;</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-17" data-target-annotation="2" onclick="event.preventDefault();">2</a><span id="annotated-cell-17-3" class="code-annotation-target"><a href="#annotated-cell-17-3"></a>  <span class="fu">mutate</span>(<span class="at">Lux_range =</span> <span class="fu">na_if</span>(Lux_range, <span class="st">"Indoor"</span>)) <span class="sc">|&gt;</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-17" data-target-annotation="3" onclick="event.preventDefault();">3</a><span id="annotated-cell-17-4" class="code-annotation-target"><a href="#annotated-cell-17-4"></a>  <span class="fu">gg_day</span>(<span class="at">y.axis =</span> Lux,</span>
<span id="annotated-cell-17-5"><a href="#annotated-cell-17-5"></a>         <span class="at">y.axis.label =</span> <span class="st">"Photopic illuminance (lx)"</span>,</span>
<span id="annotated-cell-17-6"><a href="#annotated-cell-17-6"></a>         <span class="at">geom =</span> <span class="st">"line"</span>,</span>
<span id="annotated-cell-17-7"><a href="#annotated-cell-17-7"></a>         <span class="at">jco_color =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-17" data-target-annotation="4" onclick="event.preventDefault();">4</a><span id="annotated-cell-17-8" class="code-annotation-target"><a href="#annotated-cell-17-8"></a>  <span class="fu">gg_state</span>(Lux_range, <span class="at">aes_fill =</span> Lux_range,</span>
<span id="annotated-cell-17-9"><a href="#annotated-cell-17-9"></a>           <span class="at">alpha =</span> <span class="fl">0.75</span>, <span class="at">ymin =</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">3</span>, <span class="at">ymax =</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="annotated-cell-17-10"><a href="#annotated-cell-17-10"></a>  <span class="fu">scale_fill_viridis_d</span>() <span class="sc">+</span></span>
<span id="annotated-cell-17-11"><a href="#annotated-cell-17-11"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">"Illuminance range"</span>) <span class="sc">+</span></span>
<span id="annotated-cell-17-12"><a href="#annotated-cell-17-12"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-17" data-target-annotation="5" onclick="event.preventDefault();">5</a><span id="annotated-cell-17-13" class="code-annotation-target"><a href="#annotated-cell-17-13"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">8</span>, <span class="fl">19.5</span>)<span class="sc">*</span><span class="dv">3600</span>)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-17" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-17" data-code-lines="2" data-code-annotation="1">Aggregating data to 5-minute bins</span>
</dd>
<dt data-target-cell="annotated-cell-17" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-17" data-code-lines="3" data-code-annotation="2">Removing the indoor condition</span>
</dd>
<dt data-target-cell="annotated-cell-17" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-17" data-code-lines="4,5,6,7" data-code-annotation="3">Setting up the basic plot</span>
</dd>
<dt data-target-cell="annotated-cell-17" data-target-annotation="4">4</dt>
<dd>
<span data-code-cell="annotated-cell-17" data-code-lines="8,9" data-code-annotation="4">Adding state information on the illuminance ranges</span>
</dd>
<dt data-target-cell="annotated-cell-17" data-target-annotation="5">5</dt>
<dd>
<span data-code-cell="annotated-cell-17" data-code-lines="13" data-code-annotation="5">Setting the x-axis limits to cover daytime hours</span>
</dd>
</dl>
</div>
<div class="cell-output-display">
<div id="fig-outdoor" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-outdoor-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="index_files/figure-html/fig-outdoor-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9" title="Figure&nbsp;8: Outdoor light exposure over time. Colored bands indicate periods when illuminance exceeded outdoor thresholds: violet for ≥1000&nbsp;lx, green for ≥2000&nbsp;lx, and yellow for ≥3000&nbsp;lx. Grey shaded regions denote night (from civil dusk to dawn)."><img src="index_files/figure-html/fig-outdoor-1.png" class="img-fluid figure-img" width="864"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-outdoor-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8: Outdoor light exposure over time. Colored bands indicate periods when illuminance exceeded outdoor thresholds: violet for ≥1000&nbsp;lx, green for ≥2000&nbsp;lx, and yellow for ≥3000&nbsp;lx. Grey shaded regions denote night (from civil dusk to dawn).
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="frequency-of-transitions-from-indoor-to-outdoor-light" class="level4" data-number="3.2.3">
<h4 data-number="3.2.3" class="anchored" data-anchor-id="frequency-of-transitions-from-indoor-to-outdoor-light"><span class="header-section-number">3.2.3</span> Frequency of transitions from indoor to outdoor light</h4>
<p>We next consider how often the subject moved from an indoor light environment to an outdoor-equivalent environment. We operationally define an “outdoor transition” as a change from &lt;1000&nbsp;lx to ≥1000&nbsp;lx. Using the cleaned <code>VEET</code> data, we extract all instances where illuminance crosses that threshold from below to above.</p>
<p><a href="#tbl-changesoutdoor" class="quarto-xref">Table&nbsp;12</a> shows the average number of such transitions per day. Note that if data are recorded at a fine temporal resolution (5&nbsp;s here), very brief excursions above 1000&nbsp;lx could count as transitions and inflate this number. Indeed, the initial count is fairly high, reflecting fleeting spikes above 1000&nbsp;lx that might not represent meaningful outdoor exposures.</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Calculate the number of transitions from indoor to outdoor</strong></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="annotated-cell-18"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-18-1"><a href="#annotated-cell-18-1"></a>dataVEET <span class="sc">|&gt;</span> </span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-18" data-target-annotation="1" onclick="event.preventDefault();">1</a><span id="annotated-cell-18-2" class="code-annotation-target"><a href="#annotated-cell-18-2"></a>  <span class="fu">extract_states</span>(Outdoor, Lux <span class="sc">&gt;=</span> <span class="dv">1000</span>, <span class="at">group.by.state =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-18" data-target-annotation="2" onclick="event.preventDefault();">2</a><span id="annotated-cell-18-3" class="code-annotation-target"><a href="#annotated-cell-18-3"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">lead</span>(Outdoor) <span class="sc">&amp;</span> Outdoor) <span class="sc">|&gt;</span></span>
<span id="annotated-cell-18-4"><a href="#annotated-cell-18-4"></a>  <span class="fu">summarize_numeric</span>(<span class="at">prefix =</span> <span class="st">"mean "</span>,</span>
<span id="annotated-cell-18-5"><a href="#annotated-cell-18-5"></a>    <span class="at">remove =</span> <span class="fu">c</span>(<span class="st">"Datetime"</span>, <span class="st">"Outdoor"</span>, <span class="st">"start"</span>, <span class="st">"end"</span>, <span class="st">"duration"</span>),</span>
<span id="annotated-cell-18-6"><a href="#annotated-cell-18-6"></a>    <span class="at">add.total.duration =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span> </span>
<span id="annotated-cell-18-7"><a href="#annotated-cell-18-7"></a>  <span class="fu">mean_daily</span>(<span class="at">prefix =</span> <span class="st">""</span>) <span class="sc">|&gt;</span> </span>
<span id="annotated-cell-18-8"><a href="#annotated-cell-18-8"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span> </span>
<span id="annotated-cell-18-9"><a href="#annotated-cell-18-9"></a>  <span class="fu">fmt_number</span>(episodes, <span class="at">decimals =</span> <span class="dv">0</span>) <span class="sc">|&gt;</span> </span>
<span id="annotated-cell-18-10"><a href="#annotated-cell-18-10"></a>  <span class="fu">fmt_duration</span>(<span class="st">`</span><span class="at">mean epoch</span><span class="st">`</span>, <span class="at">input_units =</span> <span class="st">"seconds"</span>, <span class="at">output_units =</span> <span class="st">"seconds"</span>)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-18" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-18" data-code-lines="2" data-code-annotation="1">Label each interval as Outdoor (Lux≥1000) or not</span>
</dd>
<dt data-target-cell="annotated-cell-18" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-18" data-code-lines="3" data-code-annotation="2">Find instances where the previous interval was “indoor” and current is “outdoor”</span>
</dd>
</dl>
</div>
<div id="tbl-changesoutdoor" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-changesoutdoor-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;12: Average daily count of transitions from indoor (&lt;1000 lx) to outdoor (≥1000 lx) lighting when looking at 5-second epochs
</figcaption>
<div aria-describedby="tbl-changesoutdoor-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="crylscoark" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#crylscoark table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#crylscoark thead, #crylscoark tbody, #crylscoark tfoot, #crylscoark tr, #crylscoark td, #crylscoark th {
  border-style: none;
}

#crylscoark p {
  margin: 0;
  padding: 0;
}

#crylscoark .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#crylscoark .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#crylscoark .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#crylscoark .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#crylscoark .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#crylscoark .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#crylscoark .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#crylscoark .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#crylscoark .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#crylscoark .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#crylscoark .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#crylscoark .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#crylscoark .gt_spanner_row {
  border-bottom-style: hidden;
}

#crylscoark .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#crylscoark .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#crylscoark .gt_from_md > :first-child {
  margin-top: 0;
}

#crylscoark .gt_from_md > :last-child {
  margin-bottom: 0;
}

#crylscoark .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#crylscoark .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#crylscoark .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#crylscoark .gt_row_group_first td {
  border-top-width: 2px;
}

#crylscoark .gt_row_group_first th {
  border-top-width: 2px;
}

#crylscoark .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#crylscoark .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#crylscoark .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#crylscoark .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#crylscoark .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#crylscoark .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#crylscoark .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#crylscoark .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#crylscoark .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#crylscoark .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#crylscoark .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#crylscoark .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#crylscoark .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#crylscoark .gt_left {
  text-align: left;
}

#crylscoark .gt_center {
  text-align: center;
}

#crylscoark .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#crylscoark .gt_font_normal {
  font-weight: normal;
}

#crylscoark .gt_font_bold {
  font-weight: bold;
}

#crylscoark .gt_font_italic {
  font-style: italic;
}

#crylscoark .gt_super {
  font-size: 65%;
}

#crylscoark .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#crylscoark .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#crylscoark .gt_indent_1 {
  text-indent: 5px;
}

#crylscoark .gt_indent_2 {
  text-indent: 10px;
}

#crylscoark .gt_indent_3 {
  text-indent: 15px;
}

#crylscoark .gt_indent_4 {
  text-indent: 20px;
}

#crylscoark .gt_indent_5 {
  text-indent: 25px;
}

#crylscoark .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#crylscoark div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-bootstrap="false">
<thead>
<tr class="gt_col_headings header">
<th id="Date" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Date</th>
<th id="mean-epoch" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">mean epoch</th>
<th id="episodes" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">episodes</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="gt_group_heading_row odd">
<th colspan="3" id="VEET" class="gt_group_heading" data-quarto-table-cell-role="th" scope="colgroup">VEET</th>
</tr>
<tr class="gt_row_group_first even">
<td class="gt_row gt_left" headers="VEET  Date">Mean daily</td>
<td class="gt_row gt_right" headers="VEET  mean epoch">5s</td>
<td class="gt_row gt_right" headers="VEET  episodes">64</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="VEET  Date">Weekday</td>
<td class="gt_row gt_right" headers="VEET  mean epoch">5s</td>
<td class="gt_row gt_right" headers="VEET  episodes">72</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="VEET  Date">Weekend</td>
<td class="gt_row gt_right" headers="VEET  mean epoch">5s</td>
<td class="gt_row gt_right" headers="VEET  episodes">46</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</figure>
</div>
</div>
<p>To obtain a more meaningful measure, we can require that the outdoor state persists for some minimum duration to count as a true transition (filtering out momentary fluctuations around the 1000&nbsp;lx mark). For example, we can require that once ≥1000&nbsp;lx is reached, it continues for at least 5&nbsp;minutes (allowing short interruptions up to 20&nbsp;s). <a href="#tbl-changesoutdoor2" class="quarto-xref">Table&nbsp;13</a> applies this criterion, resulting in a lower, more plausible transition count.</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Calculate the number of transitions from indoor to outdoor with clusters</strong></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>dataVEET <span class="sc">|&gt;</span> </span>
<span id="cb6-2"><a href="#cb6-2"></a>  <span class="fu">extract_clusters</span>(Lux <span class="sc">&gt;=</span> <span class="dv">1000</span>,</span>
<span id="cb6-3"><a href="#cb6-3"></a>                   <span class="at">cluster.duration =</span> <span class="st">"5 min"</span>, </span>
<span id="cb6-4"><a href="#cb6-4"></a>                   <span class="at">interruption.duration =</span> <span class="st">"20 secs"</span>,</span>
<span id="cb6-5"><a href="#cb6-5"></a>                   <span class="at">return.only.clusters =</span> <span class="cn">FALSE</span>,</span>
<span id="cb6-6"><a href="#cb6-6"></a>                   <span class="at">drop.empty.groups =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb6-7"><a href="#cb6-7"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">lead</span>(is.cluster) <span class="sc">&amp;</span> is.cluster) <span class="sc">|&gt;</span> </span>
<span id="cb6-8"><a href="#cb6-8"></a>  <span class="fu">summarize_numeric</span>(<span class="at">prefix =</span> <span class="st">"mean "</span>,</span>
<span id="cb6-9"><a href="#cb6-9"></a>    <span class="at">remove =</span> <span class="fu">c</span>(<span class="st">"Datetime"</span>, <span class="st">"start"</span>, <span class="st">"end"</span>, <span class="st">"duration"</span>),</span>
<span id="cb6-10"><a href="#cb6-10"></a>    <span class="at">add.total.duration =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb6-11"><a href="#cb6-11"></a>  <span class="fu">mean_daily</span>(<span class="at">prefix =</span> <span class="st">""</span>) <span class="sc">|&gt;</span> </span>
<span id="cb6-12"><a href="#cb6-12"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span> <span class="fu">fmt_number</span>(episodes, <span class="at">decimals =</span> <span class="dv">0</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="tbl-changesoutdoor2" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-changesoutdoor2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;13: Daily indoor-to-outdoor transition count (requiring ≥5&nbsp;min duration of ≥1000&nbsp;lx to count)
</figcaption>
<div aria-describedby="tbl-changesoutdoor2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="lgrbulovvr" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#lgrbulovvr table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#lgrbulovvr thead, #lgrbulovvr tbody, #lgrbulovvr tfoot, #lgrbulovvr tr, #lgrbulovvr td, #lgrbulovvr th {
  border-style: none;
}

#lgrbulovvr p {
  margin: 0;
  padding: 0;
}

#lgrbulovvr .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#lgrbulovvr .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#lgrbulovvr .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#lgrbulovvr .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#lgrbulovvr .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#lgrbulovvr .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#lgrbulovvr .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#lgrbulovvr .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#lgrbulovvr .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#lgrbulovvr .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#lgrbulovvr .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#lgrbulovvr .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#lgrbulovvr .gt_spanner_row {
  border-bottom-style: hidden;
}

#lgrbulovvr .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#lgrbulovvr .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#lgrbulovvr .gt_from_md > :first-child {
  margin-top: 0;
}

#lgrbulovvr .gt_from_md > :last-child {
  margin-bottom: 0;
}

#lgrbulovvr .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#lgrbulovvr .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#lgrbulovvr .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#lgrbulovvr .gt_row_group_first td {
  border-top-width: 2px;
}

#lgrbulovvr .gt_row_group_first th {
  border-top-width: 2px;
}

#lgrbulovvr .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#lgrbulovvr .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#lgrbulovvr .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#lgrbulovvr .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#lgrbulovvr .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#lgrbulovvr .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#lgrbulovvr .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#lgrbulovvr .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#lgrbulovvr .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#lgrbulovvr .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#lgrbulovvr .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#lgrbulovvr .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#lgrbulovvr .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#lgrbulovvr .gt_left {
  text-align: left;
}

#lgrbulovvr .gt_center {
  text-align: center;
}

#lgrbulovvr .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#lgrbulovvr .gt_font_normal {
  font-weight: normal;
}

#lgrbulovvr .gt_font_bold {
  font-weight: bold;
}

#lgrbulovvr .gt_font_italic {
  font-style: italic;
}

#lgrbulovvr .gt_super {
  font-size: 65%;
}

#lgrbulovvr .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#lgrbulovvr .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#lgrbulovvr .gt_indent_1 {
  text-indent: 5px;
}

#lgrbulovvr .gt_indent_2 {
  text-indent: 10px;
}

#lgrbulovvr .gt_indent_3 {
  text-indent: 15px;
}

#lgrbulovvr .gt_indent_4 {
  text-indent: 20px;
}

#lgrbulovvr .gt_indent_5 {
  text-indent: 25px;
}

#lgrbulovvr .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#lgrbulovvr div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-bootstrap="false">
<thead>
<tr class="gt_col_headings header">
<th id="Date" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Date</th>
<th id="mean-epoch" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">mean epoch</th>
<th id="episodes" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">episodes</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="gt_group_heading_row odd">
<th colspan="3" id="VEET" class="gt_group_heading" data-quarto-table-cell-role="th" scope="colgroup">VEET</th>
</tr>
<tr class="gt_row_group_first even">
<td class="gt_row gt_left" headers="VEET  Date">Mean daily</td>
<td class="gt_row gt_center" headers="VEET  mean epoch">5s</td>
<td class="gt_row gt_right" headers="VEET  episodes">5</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="VEET  Date">Weekday</td>
<td class="gt_row gt_center" headers="VEET  mean epoch">5s</td>
<td class="gt_row gt_right" headers="VEET  episodes">6</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="VEET  Date">Weekend</td>
<td class="gt_row gt_center" headers="VEET  mean epoch">5s</td>
<td class="gt_row gt_right" headers="VEET  episodes">4</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</figure>
</div>
</div>
</section>
<section id="longest-sustained-bright-light-period" class="level4" data-number="3.2.4">
<h4 data-number="3.2.4" class="anchored" data-anchor-id="longest-sustained-bright-light-period"><span class="header-section-number">3.2.4</span> Longest sustained bright-light period</h4>
<p>The final light exposure metric we illustrate is the longest continuous period above a certain illuminance threshold (often termed longest period above threshold, e.g.&nbsp;PAT<sub>1000</sub> for 1000&nbsp;lx). This gives us a sense of the longest outdoor exposure in a day. Along with it, one might report the total duration above that threshold in the day (TAT<sub>1000</sub>). While we could derive these from the earlier analyses, LightLogR provides dedicated <a href="https://tscnlab.github.io/LightLogR/articles/Metrics.html">metric</a> functions for such calculations, which can compute multiple related metrics at once.</p>
<p>Using the function <a href="https://tscnlab.github.io/LightLogR/reference/period_above_threshold.html">period_above_threshold()</a> for PAT and <a href="https://tscnlab.github.io/LightLogR/reference/duration_above_threshold.html">duration_above_threshold()</a> for TAT, we calculate both metrics for the 1000&nbsp;lx threshold. <a href="#tbl-periodoutdoor" class="quarto-xref">Table&nbsp;14</a> shows the mean of these metrics across days (i.e., average longest bright period and average total bright time per day).</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Calculate PAT1000 and TAT1000</strong></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>dataVEET <span class="sc">|&gt;</span> </span>
<span id="cb7-2"><a href="#cb7-2"></a>  <span class="fu">summarize</span>(</span>
<span id="cb7-3"><a href="#cb7-3"></a>    <span class="fu">period_above_threshold</span>(</span>
<span id="cb7-4"><a href="#cb7-4"></a>      Lux, Datetime, <span class="at">threshold =</span> <span class="dv">1000</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">as.df =</span> <span class="cn">TRUE</span>),</span>
<span id="cb7-5"><a href="#cb7-5"></a>    <span class="fu">duration_above_threshold</span>(</span>
<span id="cb7-6"><a href="#cb7-6"></a>      Lux, Datetime, <span class="at">threshold =</span> <span class="dv">1000</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">as.df =</span> <span class="cn">TRUE</span>),</span>
<span id="cb7-7"><a href="#cb7-7"></a>    <span class="at">.groups =</span> <span class="st">"keep"</span></span>
<span id="cb7-8"><a href="#cb7-8"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb7-9"><a href="#cb7-9"></a>  <span class="fu">to_mean_daily</span>(<span class="st">""</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="tbl-periodoutdoor" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-periodoutdoor-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;14: Longest period and total duration illuminance above 1000&nbsp;lx (PAT1000 and TAT1000)
</figcaption>
<div aria-describedby="tbl-periodoutdoor-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="dpypoyuisn" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#dpypoyuisn table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#dpypoyuisn thead, #dpypoyuisn tbody, #dpypoyuisn tfoot, #dpypoyuisn tr, #dpypoyuisn td, #dpypoyuisn th {
  border-style: none;
}

#dpypoyuisn p {
  margin: 0;
  padding: 0;
}

#dpypoyuisn .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#dpypoyuisn .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#dpypoyuisn .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#dpypoyuisn .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#dpypoyuisn .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#dpypoyuisn .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dpypoyuisn .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#dpypoyuisn .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#dpypoyuisn .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#dpypoyuisn .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#dpypoyuisn .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#dpypoyuisn .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#dpypoyuisn .gt_spanner_row {
  border-bottom-style: hidden;
}

#dpypoyuisn .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#dpypoyuisn .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#dpypoyuisn .gt_from_md > :first-child {
  margin-top: 0;
}

#dpypoyuisn .gt_from_md > :last-child {
  margin-bottom: 0;
}

#dpypoyuisn .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#dpypoyuisn .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#dpypoyuisn .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#dpypoyuisn .gt_row_group_first td {
  border-top-width: 2px;
}

#dpypoyuisn .gt_row_group_first th {
  border-top-width: 2px;
}

#dpypoyuisn .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#dpypoyuisn .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#dpypoyuisn .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#dpypoyuisn .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dpypoyuisn .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#dpypoyuisn .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#dpypoyuisn .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#dpypoyuisn .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#dpypoyuisn .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dpypoyuisn .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#dpypoyuisn .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#dpypoyuisn .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#dpypoyuisn .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#dpypoyuisn .gt_left {
  text-align: left;
}

#dpypoyuisn .gt_center {
  text-align: center;
}

#dpypoyuisn .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#dpypoyuisn .gt_font_normal {
  font-weight: normal;
}

#dpypoyuisn .gt_font_bold {
  font-weight: bold;
}

#dpypoyuisn .gt_font_italic {
  font-style: italic;
}

#dpypoyuisn .gt_super {
  font-size: 65%;
}

#dpypoyuisn .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#dpypoyuisn .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#dpypoyuisn .gt_indent_1 {
  text-indent: 5px;
}

#dpypoyuisn .gt_indent_2 {
  text-indent: 10px;
}

#dpypoyuisn .gt_indent_3 {
  text-indent: 15px;
}

#dpypoyuisn .gt_indent_4 {
  text-indent: 20px;
}

#dpypoyuisn .gt_indent_5 {
  text-indent: 25px;
}

#dpypoyuisn .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#dpypoyuisn div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-bootstrap="false">
<thead>
<tr class="gt_col_headings header">
<th id="Date" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Date</th>
<th id="period-above-1000" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">period above 1000</th>
<th id="duration-above-1000" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">duration above 1000</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="gt_group_heading_row odd">
<th colspan="3" id="VEET" class="gt_group_heading" data-quarto-table-cell-role="th" scope="colgroup">VEET</th>
</tr>
<tr class="gt_row_group_first even">
<td class="gt_row gt_left" headers="VEET  Date">Mean daily</td>
<td class="gt_row gt_center" headers="VEET  period above 1000">1208s (~20.13 minutes)</td>
<td class="gt_row gt_center" headers="VEET  duration above 1000">5703s (~1.58 hours)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="VEET  Date">Weekday</td>
<td class="gt_row gt_center" headers="VEET  period above 1000">1469s (~24.48 minutes)</td>
<td class="gt_row gt_center" headers="VEET  duration above 1000">6815s (~1.89 hours)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="VEET  Date">Weekend</td>
<td class="gt_row gt_center" headers="VEET  period above 1000">555s (~9.25 minutes)</td>
<td class="gt_row gt_center" headers="VEET  duration above 1000">2922s (~48.7 minutes)</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</figure>
</div>
</div>
</section>
<section id="merging-data-streams" class="level4" data-number="3.2.5">
<h4 data-number="3.2.5" class="anchored" data-anchor-id="merging-data-streams"><span class="header-section-number">3.2.5</span> Merging data streams</h4>
<p>Note that while imports from different devices can be <a href="https://tscnlab.github.io/LightLogR/reference/join_datasets.html">merged</a>, devices differ in their sensors, electronics, housing or diffuser form factors, and on-device data-processing pipelines. All of these factors affect the comparability of measurements, even when devices output the same variable (e.g., illuminance or distance). If data from different devices with the same measurement variable are to be merged, the corresponding variable names should be standardized beforehand - for example, renaming <code>Lux</code> and <code>LIGHT</code> to <code>illuminance</code>. If we wanted to analyse the <code>VEET</code> data together with the <code>Clouclip</code> data, for example, we would not have to rename anything, as both carry their illuminance measurements in the variable <code>Lux</code>. The following example shows how the combination of datasets would lead to a combined dataset, and how that would affect analysis outcomes. <strong>It is the responsibility of the researcher to perform device calibration and/or checks for a similar measurement fidelity.</strong></p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Merge Clouclip and VEET data</strong></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>data <span class="ot">&lt;-</span> <span class="fu">join_datasets</span>(dataCC, dataVEET)</span>
<span id="cb8-2"><a href="#cb8-2"></a>data <span class="sc">|&gt;</span> <span class="fu">summary_overview</span>(Lux, <span class="at">threshold.missing =</span> <span class="fl">0.5</span>) <span class="sc">|&gt;</span> <span class="fu">gt</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="tbl-merge" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-merge-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;15: Overview of the merged dataset
</figcaption>
<div aria-describedby="tbl-merge-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="kuayfoduha" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#kuayfoduha table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#kuayfoduha thead, #kuayfoduha tbody, #kuayfoduha tfoot, #kuayfoduha tr, #kuayfoduha td, #kuayfoduha th {
  border-style: none;
}

#kuayfoduha p {
  margin: 0;
  padding: 0;
}

#kuayfoduha .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#kuayfoduha .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#kuayfoduha .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#kuayfoduha .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#kuayfoduha .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#kuayfoduha .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kuayfoduha .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#kuayfoduha .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#kuayfoduha .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#kuayfoduha .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#kuayfoduha .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#kuayfoduha .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#kuayfoduha .gt_spanner_row {
  border-bottom-style: hidden;
}

#kuayfoduha .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#kuayfoduha .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#kuayfoduha .gt_from_md > :first-child {
  margin-top: 0;
}

#kuayfoduha .gt_from_md > :last-child {
  margin-bottom: 0;
}

#kuayfoduha .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#kuayfoduha .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#kuayfoduha .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#kuayfoduha .gt_row_group_first td {
  border-top-width: 2px;
}

#kuayfoduha .gt_row_group_first th {
  border-top-width: 2px;
}

#kuayfoduha .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#kuayfoduha .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#kuayfoduha .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#kuayfoduha .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kuayfoduha .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#kuayfoduha .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#kuayfoduha .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#kuayfoduha .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#kuayfoduha .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kuayfoduha .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#kuayfoduha .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#kuayfoduha .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#kuayfoduha .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#kuayfoduha .gt_left {
  text-align: left;
}

#kuayfoduha .gt_center {
  text-align: center;
}

#kuayfoduha .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#kuayfoduha .gt_font_normal {
  font-weight: normal;
}

#kuayfoduha .gt_font_bold {
  font-weight: bold;
}

#kuayfoduha .gt_font_italic {
  font-style: italic;
}

#kuayfoduha .gt_super {
  font-size: 65%;
}

#kuayfoduha .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#kuayfoduha .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#kuayfoduha .gt_indent_1 {
  text-indent: 5px;
}

#kuayfoduha .gt_indent_2 {
  text-indent: 10px;
}

#kuayfoduha .gt_indent_3 {
  text-indent: 15px;
}

#kuayfoduha .gt_indent_4 {
  text-indent: 20px;
}

#kuayfoduha .gt_indent_5 {
  text-indent: 25px;
}

#kuayfoduha .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#kuayfoduha div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-bootstrap="false">
<thead>
<tr class="gt_col_headings header">
<th id="name" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">name</th>
<th id="mean" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">mean</th>
<th id="min" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">min</th>
<th id="max" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">max</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="name">Participants</td>
<td class="gt_row gt_right" headers="mean">2.00</td>
<td class="gt_row gt_right" headers="min">NA</td>
<td class="gt_row gt_right" headers="max">NA</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="name">Participant-days</td>
<td class="gt_row gt_right" headers="mean">13.00</td>
<td class="gt_row gt_right" headers="min">6.00</td>
<td class="gt_row gt_right" headers="max">7.00</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="name">Days ≥50% complete</td>
<td class="gt_row gt_right" headers="mean">6.00</td>
<td class="gt_row gt_right" headers="min">3.00</td>
<td class="gt_row gt_right" headers="max">3.00</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="name">Missing/Irregular</td>
<td class="gt_row gt_right" headers="mean">0.52</td>
<td class="gt_row gt_right" headers="min">0.38</td>
<td class="gt_row gt_right" headers="max">0.86</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</figure>
</div>
</div>
<p>We will reuse the example from <a href="#sec-avelight" class="quarto-xref">Section&nbsp;3.2.1</a>, but instead of one participant, we now have data from two devices and participants</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Re-calculate mean photopic illuminance with the merged dataset</strong></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="annotated-cell-22"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><a class="code-annotation-anchor" data-target-cell="annotated-cell-22" data-target-annotation="1" onclick="event.preventDefault();">1</a><span id="annotated-cell-22-1" class="code-annotation-target"><a href="#annotated-cell-22-1"></a>data <span class="sc">|&gt;</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-22" data-target-annotation="2" onclick="event.preventDefault();">2</a><span id="annotated-cell-22-2" class="code-annotation-target"><a href="#annotated-cell-22-2"></a>  <span class="fu">select</span>(Id, Date, Datetime, Lux) <span class="sc">|&gt;</span></span>
<span id="annotated-cell-22-3"><a href="#annotated-cell-22-3"></a>  <span class="fu">mutate</span>(<span class="at">Lux =</span> Lux <span class="sc">|&gt;</span> <span class="fu">log_zero_inflated</span>()) <span class="sc">|&gt;</span></span>
<span id="annotated-cell-22-4"><a href="#annotated-cell-22-4"></a>  <span class="fu">summarize_numeric</span>(<span class="at">prefix =</span> <span class="st">"mean "</span>, <span class="at">remove =</span> <span class="fu">c</span>(<span class="st">"Datetime"</span>)) <span class="sc">|&gt;</span></span>
<span id="annotated-cell-22-5"><a href="#annotated-cell-22-5"></a>  <span class="fu">mean_daily</span>(<span class="at">prefix =</span> <span class="st">""</span>) <span class="sc">|&gt;</span></span>
<span id="annotated-cell-22-6"><a href="#annotated-cell-22-6"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">mean Lux</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">mean Lux</span><span class="st">`</span> <span class="sc">|&gt;</span> <span class="fu">exp_zero_inflated</span>()) <span class="sc">|&gt;</span></span>
<span id="annotated-cell-22-7"><a href="#annotated-cell-22-7"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span> <span class="fu">fmt_number</span>(<span class="at">decimals =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span> <span class="fu">cols_hide</span>(episodes) <span class="sc">|&gt;</span></span>
<span id="annotated-cell-22-8"><a href="#annotated-cell-22-8"></a>  <span class="fu">cols_label</span>(<span class="st">`</span><span class="at">mean Lux</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"Mean photopic illuminance (lx)"</span>)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-22" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-22" data-code-lines="1" data-code-annotation="1">Instead of <code>dataVEET</code> we now supply the merged <code>data</code> object</span>
</dd>
<dt data-target-cell="annotated-cell-22" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-22" data-code-lines="2,3,4,5,6,7,8" data-code-annotation="2">Verbatim from <a href="#sec-avelight" class="quarto-xref">Section&nbsp;3.2.1</a></span>
</dd>
</dl>
</div>
<div id="tbl-relight" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-relight-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;16: Recalculation of the mean light exposure per day (after logarithmic transformation to account for zero inflation and skewness) with the merged dataset
</figcaption>
<div aria-describedby="tbl-relight-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="dmfqjcmkzb" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#dmfqjcmkzb table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#dmfqjcmkzb thead, #dmfqjcmkzb tbody, #dmfqjcmkzb tfoot, #dmfqjcmkzb tr, #dmfqjcmkzb td, #dmfqjcmkzb th {
  border-style: none;
}

#dmfqjcmkzb p {
  margin: 0;
  padding: 0;
}

#dmfqjcmkzb .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#dmfqjcmkzb .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#dmfqjcmkzb .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#dmfqjcmkzb .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#dmfqjcmkzb .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#dmfqjcmkzb .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dmfqjcmkzb .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#dmfqjcmkzb .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#dmfqjcmkzb .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#dmfqjcmkzb .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#dmfqjcmkzb .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#dmfqjcmkzb .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#dmfqjcmkzb .gt_spanner_row {
  border-bottom-style: hidden;
}

#dmfqjcmkzb .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#dmfqjcmkzb .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#dmfqjcmkzb .gt_from_md > :first-child {
  margin-top: 0;
}

#dmfqjcmkzb .gt_from_md > :last-child {
  margin-bottom: 0;
}

#dmfqjcmkzb .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#dmfqjcmkzb .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#dmfqjcmkzb .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#dmfqjcmkzb .gt_row_group_first td {
  border-top-width: 2px;
}

#dmfqjcmkzb .gt_row_group_first th {
  border-top-width: 2px;
}

#dmfqjcmkzb .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#dmfqjcmkzb .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#dmfqjcmkzb .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#dmfqjcmkzb .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dmfqjcmkzb .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#dmfqjcmkzb .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#dmfqjcmkzb .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#dmfqjcmkzb .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#dmfqjcmkzb .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dmfqjcmkzb .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#dmfqjcmkzb .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#dmfqjcmkzb .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#dmfqjcmkzb .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#dmfqjcmkzb .gt_left {
  text-align: left;
}

#dmfqjcmkzb .gt_center {
  text-align: center;
}

#dmfqjcmkzb .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#dmfqjcmkzb .gt_font_normal {
  font-weight: normal;
}

#dmfqjcmkzb .gt_font_bold {
  font-weight: bold;
}

#dmfqjcmkzb .gt_font_italic {
  font-style: italic;
}

#dmfqjcmkzb .gt_super {
  font-size: 65%;
}

#dmfqjcmkzb .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#dmfqjcmkzb .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#dmfqjcmkzb .gt_indent_1 {
  text-indent: 5px;
}

#dmfqjcmkzb .gt_indent_2 {
  text-indent: 10px;
}

#dmfqjcmkzb .gt_indent_3 {
  text-indent: 15px;
}

#dmfqjcmkzb .gt_indent_4 {
  text-indent: 20px;
}

#dmfqjcmkzb .gt_indent_5 {
  text-indent: 25px;
}

#dmfqjcmkzb .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#dmfqjcmkzb div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-bootstrap="false">
<thead>
<tr class="gt_col_headings header">
<th id="Date" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Date</th>
<th id="mean-Lux" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Mean photopic illuminance (lx)</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="gt_group_heading_row odd">
<th colspan="2" id="Clouclip" class="gt_group_heading" data-quarto-table-cell-role="th" scope="colgroup">Clouclip</th>
</tr>
<tr class="gt_row_group_first even">
<td class="gt_row gt_left" headers="Clouclip  Date">Mean daily</td>
<td class="gt_row gt_right" headers="Clouclip  mean Lux">17.6</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Clouclip  Date">Weekday</td>
<td class="gt_row gt_right" headers="Clouclip  mean Lux">18.6</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Clouclip  Date">Weekend</td>
<td class="gt_row gt_right" headers="Clouclip  mean Lux">15.2</td>
</tr>
<tr class="gt_group_heading_row odd">
<th colspan="2" id="VEET" class="gt_group_heading" data-quarto-table-cell-role="th" scope="colgroup">VEET</th>
</tr>
<tr class="gt_row_group_first even">
<td class="gt_row gt_left" headers="VEET  Date">Mean daily</td>
<td class="gt_row gt_right" headers="VEET  mean Lux">57.0</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="VEET  Date">Weekday</td>
<td class="gt_row gt_right" headers="VEET  mean Lux">70.1</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="VEET  Date">Weekend</td>
<td class="gt_row gt_right" headers="VEET  mean Lux">33.9</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</figure>
</div>
</div>
</section>
</section>
<section id="spectrum" class="level3" data-number="3.3">
<h3 data-number="3.3" class="anchored" data-anchor-id="spectrum"><span class="header-section-number">3.3</span> Spectrum</h3>
<p>The <code>VEET</code> device’s spectral sensor provides multimodal data beyond simple lux values, but it requires reconstruction of the actual light spectrum from raw sensor counts. We processed the spectral sensor data in order to compute two example spectrum-based metrics. Detailed data import, normalization, and spectral reconstruction steps are given in <a href="./supplement.html">Supplement&nbsp;1</a>; here we present the resulting metrics. Briefly, the <code>VEET</code>’s spectral sensor recorded counts in ten wavelength bands (roughly 415&nbsp;nm to 910&nbsp;nm), plus a <code>Dark</code> and a <code>Clear</code> channel<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a>. After normalizing by sensor gain and applying the calibration matrix, we obtained an estimated spectral irradiance distribution for each 5-minute interval in the recording. With these reconstructed spectra, we can derive novel metrics that consider spectral content of the light.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Spectrum-based metrics in wearable data are relatively new and less established compared to distance or broadband light metrics. The following examples illustrate potential uses of spectral data in a theoretical sense, which can be adapted as needed for specific research questions.</p>
</div>
</div>
<section id="ratio-of-short--vs.-long-wavelength-light" class="level4" data-number="3.3.1">
<h4 data-number="3.3.1" class="anchored" data-anchor-id="ratio-of-short--vs.-long-wavelength-light"><span class="header-section-number">3.3.1</span> Ratio of short- vs.&nbsp;long-wavelength light</h4>
<p>Our first spectral metric is the ratio of short-wavelength light to long-wavelength light, which is relevant, for example, in assessing the blue-light content of exposure. We define “short” wavelengths as 400–500&nbsp;nm and “long” as 600–700&nbsp;nm (which are not standardized threshold and can be freely adjusted). Using the list-column of spectra in our dataset, we integrate each spectrum over these ranges (using <a href="https://tscnlab.github.io/LightLogR/reference/spectral_integration.html"><code>spectral_integration()</code></a>), and then compute the ratio short/long for each time interval. We then summarize these ratios per day.</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Extract wavelength sections and integrate over them</strong></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="annotated-cell-23"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-23-1"><a href="#annotated-cell-23-1"></a>dataVEET <span class="ot">&lt;-</span> dataVEET2 <span class="sc">|&gt;</span> </span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-23" data-target-annotation="1" onclick="event.preventDefault();">1</a><span id="annotated-cell-23-2" class="code-annotation-target"><a href="#annotated-cell-23-2"></a>  <span class="fu">select</span>(Id, Date, Datetime, Spectrum) <span class="sc">|&gt;</span></span>
<span id="annotated-cell-23-3"><a href="#annotated-cell-23-3"></a>  <span class="fu">mutate</span>(</span>
<span id="annotated-cell-23-4"><a href="#annotated-cell-23-4"></a>    <span class="at">short =</span> </span>
<span id="annotated-cell-23-5"><a href="#annotated-cell-23-5"></a>      Spectrum <span class="sc">|&gt;</span> <span class="fu">map_dbl</span>(spectral_integration, <span class="at">wavelength.range =</span> <span class="fu">c</span>(<span class="dv">400</span>, <span class="dv">500</span>)),</span>
<span id="annotated-cell-23-6"><a href="#annotated-cell-23-6"></a>    <span class="at">long  =</span> </span>
<span id="annotated-cell-23-7"><a href="#annotated-cell-23-7"></a>      Spectrum <span class="sc">|&gt;</span> <span class="fu">map_dbl</span>(spectral_integration, <span class="at">wavelength.range =</span> <span class="fu">c</span>(<span class="dv">600</span>, <span class="dv">700</span>)),</span>
<span id="annotated-cell-23-8"><a href="#annotated-cell-23-8"></a>    <span class="st">`</span><span class="at">sl ratio</span><span class="st">`</span> <span class="ot">=</span> </span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-23" data-target-annotation="2" onclick="event.preventDefault();">2</a><span id="annotated-cell-23-9" class="code-annotation-target"><a href="#annotated-cell-23-9"></a>      <span class="fu">ifelse</span>(<span class="fu">is.nan</span>(short <span class="sc">/</span> long), <span class="cn">NA</span>, short <span class="sc">/</span> long)</span>
<span id="annotated-cell-23-10"><a href="#annotated-cell-23-10"></a>  )</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-23" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-23" data-code-lines="2" data-code-annotation="1">Focus on ID, date, time, and spectrum</span>
</dd>
<dt data-target-cell="annotated-cell-23" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-23" data-code-lines="9" data-code-annotation="2">Compute short-to-long wavelength ratio</span>
</dd>
</dl>
</div>
</div>
<p><a href="#tbl-ratio" class="quarto-xref">Table&nbsp;17</a> shows the average short/long wavelength ratio, averaged over each day (and then as weekday/weekend means if applicable). In this dataset, the values give an indication of the spectral balance of the light the individual was exposed to (higher values mean relatively more short-wavelength content).</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Calculate daily average values of short and long wavelength content</strong></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>dataVEET <span class="sc">|&gt;</span> </span>
<span id="cb9-2"><a href="#cb9-2"></a>  <span class="fu">summarize_numeric</span>(<span class="at">prefix =</span> <span class="st">""</span>, <span class="at">remove =</span> <span class="fu">c</span>(<span class="st">"Datetime"</span>, <span class="st">"Spectrum"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb9-3"><a href="#cb9-3"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span> </span>
<span id="cb9-4"><a href="#cb9-4"></a>  <span class="fu">fmt_number</span>(<span class="at">decimals =</span> <span class="dv">1</span>, <span class="at">scale_by =</span> <span class="dv">1000</span>) <span class="sc">|&gt;</span></span>
<span id="cb9-5"><a href="#cb9-5"></a>  <span class="fu">fmt_number</span>(<span class="st">`</span><span class="at">sl ratio</span><span class="st">`</span>, <span class="at">decimals =</span> <span class="dv">3</span>) <span class="sc">|&gt;</span></span>
<span id="cb9-6"><a href="#cb9-6"></a>  <span class="fu">cols_hide</span>(episodes)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="tbl-ratio" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-ratio-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;17: Average (mW/m²) and ratio of short-wavelength (400–500&nbsp;nm) to long-wavelength (600–700&nbsp;nm) light
</figcaption>
<div aria-describedby="tbl-ratio-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="prpzzuvrkn" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#prpzzuvrkn table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#prpzzuvrkn thead, #prpzzuvrkn tbody, #prpzzuvrkn tfoot, #prpzzuvrkn tr, #prpzzuvrkn td, #prpzzuvrkn th {
  border-style: none;
}

#prpzzuvrkn p {
  margin: 0;
  padding: 0;
}

#prpzzuvrkn .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#prpzzuvrkn .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#prpzzuvrkn .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#prpzzuvrkn .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#prpzzuvrkn .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#prpzzuvrkn .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#prpzzuvrkn .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#prpzzuvrkn .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#prpzzuvrkn .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#prpzzuvrkn .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#prpzzuvrkn .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#prpzzuvrkn .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#prpzzuvrkn .gt_spanner_row {
  border-bottom-style: hidden;
}

#prpzzuvrkn .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#prpzzuvrkn .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#prpzzuvrkn .gt_from_md > :first-child {
  margin-top: 0;
}

#prpzzuvrkn .gt_from_md > :last-child {
  margin-bottom: 0;
}

#prpzzuvrkn .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#prpzzuvrkn .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#prpzzuvrkn .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#prpzzuvrkn .gt_row_group_first td {
  border-top-width: 2px;
}

#prpzzuvrkn .gt_row_group_first th {
  border-top-width: 2px;
}

#prpzzuvrkn .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#prpzzuvrkn .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#prpzzuvrkn .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#prpzzuvrkn .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#prpzzuvrkn .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#prpzzuvrkn .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#prpzzuvrkn .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#prpzzuvrkn .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#prpzzuvrkn .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#prpzzuvrkn .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#prpzzuvrkn .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#prpzzuvrkn .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#prpzzuvrkn .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#prpzzuvrkn .gt_left {
  text-align: left;
}

#prpzzuvrkn .gt_center {
  text-align: center;
}

#prpzzuvrkn .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#prpzzuvrkn .gt_font_normal {
  font-weight: normal;
}

#prpzzuvrkn .gt_font_bold {
  font-weight: bold;
}

#prpzzuvrkn .gt_font_italic {
  font-style: italic;
}

#prpzzuvrkn .gt_super {
  font-size: 65%;
}

#prpzzuvrkn .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#prpzzuvrkn .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#prpzzuvrkn .gt_indent_1 {
  text-indent: 5px;
}

#prpzzuvrkn .gt_indent_2 {
  text-indent: 10px;
}

#prpzzuvrkn .gt_indent_3 {
  text-indent: 15px;
}

#prpzzuvrkn .gt_indent_4 {
  text-indent: 20px;
}

#prpzzuvrkn .gt_indent_5 {
  text-indent: 25px;
}

#prpzzuvrkn .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#prpzzuvrkn div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-bootstrap="false">
<thead>
<tr class="gt_col_headings header">
<th id="Date" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Date</th>
<th id="short" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">short</th>
<th id="long" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">long</th>
<th id="sl-ratio" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">sl ratio</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="gt_group_heading_row odd">
<th colspan="4" id="VEET" class="gt_group_heading" data-quarto-table-cell-role="th" scope="colgroup">VEET</th>
</tr>
<tr class="gt_row_group_first even">
<td class="gt_row gt_right" headers="VEET  Date">2025-06-18</td>
<td class="gt_row gt_right" headers="VEET  short">83.7</td>
<td class="gt_row gt_right" headers="VEET  long">71.7</td>
<td class="gt_row gt_right" headers="VEET  sl ratio">0.610</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="VEET  Date">2025-06-20</td>
<td class="gt_row gt_right" headers="VEET  short">114.0</td>
<td class="gt_row gt_right" headers="VEET  long">81.6</td>
<td class="gt_row gt_right" headers="VEET  sl ratio">0.372</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</figure>
</div>
</div>
</section>
<section id="melanopic-daylight-efficacy-ratio-mder" class="level4" data-number="3.3.2">
<h4 data-number="3.3.2" class="anchored" data-anchor-id="melanopic-daylight-efficacy-ratio-mder"><span class="header-section-number">3.3.2</span> Melanopic daylight efficacy ratio (MDER)</h4>
<p>The same idea is behind calculating the melanopic daylight efficacy ratio (or MDER), which is defined by the CIE <span class="citation" data-cites="CIE_S026_2018">(<a href="#ref-CIE_S026_2018" role="doc-biblioref"><span>“CIE System for Metrology of Optical Radiation for <span class="nocase">ipRGC</span>-Influenced Responses to Light”</span> 2018</a>)</span> as the melanopic EDI divided by the photopic illuminance <span class="citation" data-cites="Hartmeyer2023LightResTechnol">(<a href="#ref-Hartmeyer2023LightResTechnol" role="doc-biblioref">Hartmeyer and Andersen 2023</a>)</span>. Results are shown in <a href="#tbl-mder" class="quarto-xref">Table&nbsp;18</a>. In this case, instead of a simple integration over a wavelength band, we apply an action spectrum to the spectral power distribution (SPD), integrate over the weighted SPD, and apply a correction factor. All alphaopic action spectra are implemented in the <code>spectral_integration()</code> function. These will result in photopic illuminance and melanopic equivalent daylight illuminance (melEDI).</p>
<div class="cell" data-tbl-cap="Average (mW/m²) and ratio of short-wavelength (400–500&nbsp;nm) to long-wavelength (600–700&nbsp;nm) light">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Calculate melEDI and illumiance</strong></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="annotated-cell-25"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-25-1"><a href="#annotated-cell-25-1"></a>dataVEET <span class="ot">&lt;-</span> </span>
<span id="annotated-cell-25-2"><a href="#annotated-cell-25-2"></a>  dataVEET <span class="sc">|&gt;</span> </span>
<span id="annotated-cell-25-3"><a href="#annotated-cell-25-3"></a>  <span class="fu">select</span>(Id, Date, Datetime, Spectrum, short, long, <span class="st">`</span><span class="at">sl ratio</span><span class="st">`</span>) <span class="sc">|&gt;</span></span>
<span id="annotated-cell-25-4"><a href="#annotated-cell-25-4"></a>  <span class="fu">mutate</span>(</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-25" data-target-annotation="1" onclick="event.preventDefault();">1</a><span id="annotated-cell-25-5" class="code-annotation-target"><a href="#annotated-cell-25-5"></a>    <span class="at">melEDI =</span></span>
<span id="annotated-cell-25-6"><a href="#annotated-cell-25-6"></a>      Spectrum <span class="sc">|&gt;</span> <span class="fu">map_dbl</span>(spectral_integration, <span class="at">action.spectrum =</span> <span class="st">"melanopic"</span>),</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-25" data-target-annotation="2" onclick="event.preventDefault();">2</a><span id="annotated-cell-25-7" class="code-annotation-target"><a href="#annotated-cell-25-7"></a>    <span class="at">illuminance  =</span></span>
<span id="annotated-cell-25-8"><a href="#annotated-cell-25-8"></a>      Spectrum <span class="sc">|&gt;</span> <span class="fu">map_dbl</span>(spectral_integration, <span class="at">action.spectrum =</span> <span class="st">"photopic"</span>)</span>
<span id="annotated-cell-25-9"><a href="#annotated-cell-25-9"></a>  )</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-25" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-25" data-code-lines="5,6" data-code-annotation="1">Calculate melanopic EDI by applying the <span class="math inline">\(s_{mel (\lambda)}\)</span> action spectrum, integrating, and weighing</span>
</dd>
<dt data-target-cell="annotated-cell-25" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-25" data-code-lines="7,8" data-code-annotation="2">Calculate photopic illuminance by applying the <span class="math inline">\(V_{(\lambda)}\)</span> action spectrum, integrating, and weighing</span>
</dd>
</dl>
</div>
</div>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Calculate MDER</strong></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>dataVEET  <span class="sc">|&gt;</span> </span>
<span id="cb10-2"><a href="#cb10-2"></a>  <span class="fu">summarize_numeric</span>(<span class="at">prefix =</span> <span class="st">""</span>, <span class="at">remove =</span> <span class="fu">c</span>(<span class="st">"Datetime"</span>, <span class="st">"Spectrum"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb10-3"><a href="#cb10-3"></a>  <span class="fu">mutate</span>(<span class="at">MDER =</span> melEDI <span class="sc">/</span> illuminance) <span class="sc">|&gt;</span></span>
<span id="cb10-4"><a href="#cb10-4"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span> </span>
<span id="cb10-5"><a href="#cb10-5"></a>  <span class="fu">fmt_number</span>(<span class="sc">-</span><span class="st">`</span><span class="at">sl ratio</span><span class="st">`</span>, <span class="at">decimals =</span> <span class="dv">1</span>, <span class="at">scale_by =</span> <span class="dv">1000</span>) <span class="sc">|&gt;</span></span>
<span id="cb10-6"><a href="#cb10-6"></a>  <span class="fu">fmt_number</span>(<span class="fu">c</span>(MDER, <span class="st">`</span><span class="at">sl ratio</span><span class="st">`</span>), <span class="at">decimals =</span> <span class="dv">3</span>) <span class="sc">|&gt;</span></span>
<span id="cb10-7"><a href="#cb10-7"></a>  <span class="fu">cols_hide</span>(episodes)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="tbl-mder" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-mder-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;18: Average melanopic daylight efficacy ratio (MDER)
</figcaption>
<div aria-describedby="tbl-mder-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="wekdicjsay" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#wekdicjsay table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#wekdicjsay thead, #wekdicjsay tbody, #wekdicjsay tfoot, #wekdicjsay tr, #wekdicjsay td, #wekdicjsay th {
  border-style: none;
}

#wekdicjsay p {
  margin: 0;
  padding: 0;
}

#wekdicjsay .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#wekdicjsay .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#wekdicjsay .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#wekdicjsay .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#wekdicjsay .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#wekdicjsay .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#wekdicjsay .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#wekdicjsay .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#wekdicjsay .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#wekdicjsay .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#wekdicjsay .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#wekdicjsay .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#wekdicjsay .gt_spanner_row {
  border-bottom-style: hidden;
}

#wekdicjsay .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#wekdicjsay .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#wekdicjsay .gt_from_md > :first-child {
  margin-top: 0;
}

#wekdicjsay .gt_from_md > :last-child {
  margin-bottom: 0;
}

#wekdicjsay .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#wekdicjsay .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#wekdicjsay .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#wekdicjsay .gt_row_group_first td {
  border-top-width: 2px;
}

#wekdicjsay .gt_row_group_first th {
  border-top-width: 2px;
}

#wekdicjsay .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#wekdicjsay .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#wekdicjsay .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#wekdicjsay .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#wekdicjsay .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#wekdicjsay .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#wekdicjsay .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#wekdicjsay .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#wekdicjsay .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#wekdicjsay .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#wekdicjsay .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#wekdicjsay .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#wekdicjsay .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#wekdicjsay .gt_left {
  text-align: left;
}

#wekdicjsay .gt_center {
  text-align: center;
}

#wekdicjsay .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#wekdicjsay .gt_font_normal {
  font-weight: normal;
}

#wekdicjsay .gt_font_bold {
  font-weight: bold;
}

#wekdicjsay .gt_font_italic {
  font-style: italic;
}

#wekdicjsay .gt_super {
  font-size: 65%;
}

#wekdicjsay .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#wekdicjsay .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#wekdicjsay .gt_indent_1 {
  text-indent: 5px;
}

#wekdicjsay .gt_indent_2 {
  text-indent: 10px;
}

#wekdicjsay .gt_indent_3 {
  text-indent: 15px;
}

#wekdicjsay .gt_indent_4 {
  text-indent: 20px;
}

#wekdicjsay .gt_indent_5 {
  text-indent: 25px;
}

#wekdicjsay .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#wekdicjsay div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-bootstrap="false">
<thead>
<tr class="gt_col_headings header">
<th id="Date" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Date</th>
<th id="short" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">short</th>
<th id="long" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">long</th>
<th id="sl-ratio" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">sl ratio</th>
<th id="melEDI" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">melEDI</th>
<th id="illuminance" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">illuminance</th>
<th id="MDER" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">MDER</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="gt_group_heading_row odd">
<th colspan="7" id="VEET" class="gt_group_heading" data-quarto-table-cell-role="th" scope="colgroup">VEET</th>
</tr>
<tr class="gt_row_group_first even">
<td class="gt_row gt_right" headers="VEET  Date">2025-06-18</td>
<td class="gt_row gt_right" headers="VEET  short">83.7</td>
<td class="gt_row gt_right" headers="VEET  long">71.7</td>
<td class="gt_row gt_right" headers="VEET  sl ratio">0.610</td>
<td class="gt_row gt_right" headers="VEET  melEDI">80.6</td>
<td class="gt_row gt_right" headers="VEET  illuminance">103.7</td>
<td class="gt_row gt_right" headers="VEET  MDER">0.777</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="VEET  Date">2025-06-20</td>
<td class="gt_row gt_right" headers="VEET  short">114.0</td>
<td class="gt_row gt_right" headers="VEET  long">81.6</td>
<td class="gt_row gt_right" headers="VEET  sl ratio">0.372</td>
<td class="gt_row gt_right" headers="VEET  melEDI">108.0</td>
<td class="gt_row gt_right" headers="VEET  illuminance">123.9</td>
<td class="gt_row gt_right" headers="VEET  MDER">0.871</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</figure>
</div>
</div>
</section>
<section id="short-wavelength-light-at-specific-times-of-day" class="level4" data-number="3.3.3">
<h4 data-number="3.3.3" class="anchored" data-anchor-id="short-wavelength-light-at-specific-times-of-day"><span class="header-section-number">3.3.3</span> Short-wavelength light at specific times of day</h4>
<p>The third spectral example examines short-wavelength light exposure as a function of time of day. Certain studies might be interested in, for instance, blue-light exposure during midday versus morning or night. We demonstrate three approaches: (a) filtering the data to a specific local time window, and (b) aggregating by hour of day to see a daily profile of short-wavelength exposure. Additionally, we (c) look at differences between day and night periods.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true" href="">Local morning exposure</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false" href="">Hourly profile across the day</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false" href="">Day vs.&nbsp;night (photoperiod)</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<p><a href="#tbl-shortfilter" class="quarto-xref">Table&nbsp;19</a> isolates the time window between 7:00 and 11:00 each day and computes the average short-wavelength irradiance in that interval. This represents a straightforward query: “How much blue light does the subject get in the morning on average?”</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Calculate short-wavelength light before noon</strong></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="annotated-cell-42"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-42-1"><a href="#annotated-cell-42-1"></a>dataVEET <span class="sc">|&gt;</span> </span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-42" data-target-annotation="1" onclick="event.preventDefault();">1</a><span id="annotated-cell-42-2" class="code-annotation-target"><a href="#annotated-cell-42-2"></a>  <span class="fu">filter_Time</span>(<span class="at">start =</span> <span class="st">"7:00:00"</span>, <span class="at">end =</span> <span class="st">"11:00:00"</span>) <span class="sc">|&gt;</span></span>
<span id="annotated-cell-42-3"><a href="#annotated-cell-42-3"></a>  <span class="fu">select</span>(<span class="fu">c</span>(Id, Date, short)) <span class="sc">|&gt;</span></span>
<span id="annotated-cell-42-4"><a href="#annotated-cell-42-4"></a>  <span class="fu">summarize_numeric</span>(<span class="at">prefix =</span> <span class="st">""</span>) <span class="sc">|&gt;</span> </span>
<span id="annotated-cell-42-5"><a href="#annotated-cell-42-5"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span> </span>
<span id="annotated-cell-42-6"><a href="#annotated-cell-42-6"></a>  <span class="fu">fmt_number</span>(short, <span class="at">scale_by =</span> <span class="dv">1000</span>) <span class="sc">|&gt;</span> </span>
<span id="annotated-cell-42-7"><a href="#annotated-cell-42-7"></a>  <span class="fu">cols_label</span>(<span class="at">short =</span> <span class="st">"Short-wavelength irradiance (mW/m²)"</span>) <span class="sc">|&gt;</span> </span>
<span id="annotated-cell-42-8"><a href="#annotated-cell-42-8"></a>  <span class="fu">cols_hide</span>(episodes)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-42" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-42" data-code-lines="2" data-code-annotation="1">Filter data to local 7am–11am</span>
</dd>
</dl>
</div>
<div id="tbl-shortfilter" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-shortfilter-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;19: Average short-wavelength light (400–500&nbsp;nm) exposure between 7:00 and 11:00 each day
</figcaption>
<div aria-describedby="tbl-shortfilter-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="wycrszdyhx" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#wycrszdyhx table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#wycrszdyhx thead, #wycrszdyhx tbody, #wycrszdyhx tfoot, #wycrszdyhx tr, #wycrszdyhx td, #wycrszdyhx th {
  border-style: none;
}

#wycrszdyhx p {
  margin: 0;
  padding: 0;
}

#wycrszdyhx .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#wycrszdyhx .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#wycrszdyhx .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#wycrszdyhx .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#wycrszdyhx .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#wycrszdyhx .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#wycrszdyhx .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#wycrszdyhx .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#wycrszdyhx .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#wycrszdyhx .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#wycrszdyhx .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#wycrszdyhx .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#wycrszdyhx .gt_spanner_row {
  border-bottom-style: hidden;
}

#wycrszdyhx .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#wycrszdyhx .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#wycrszdyhx .gt_from_md > :first-child {
  margin-top: 0;
}

#wycrszdyhx .gt_from_md > :last-child {
  margin-bottom: 0;
}

#wycrszdyhx .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#wycrszdyhx .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#wycrszdyhx .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#wycrszdyhx .gt_row_group_first td {
  border-top-width: 2px;
}

#wycrszdyhx .gt_row_group_first th {
  border-top-width: 2px;
}

#wycrszdyhx .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#wycrszdyhx .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#wycrszdyhx .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#wycrszdyhx .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#wycrszdyhx .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#wycrszdyhx .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#wycrszdyhx .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#wycrszdyhx .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#wycrszdyhx .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#wycrszdyhx .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#wycrszdyhx .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#wycrszdyhx .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#wycrszdyhx .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#wycrszdyhx .gt_left {
  text-align: left;
}

#wycrszdyhx .gt_center {
  text-align: center;
}

#wycrszdyhx .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#wycrszdyhx .gt_font_normal {
  font-weight: normal;
}

#wycrszdyhx .gt_font_bold {
  font-weight: bold;
}

#wycrszdyhx .gt_font_italic {
  font-style: italic;
}

#wycrszdyhx .gt_super {
  font-size: 65%;
}

#wycrszdyhx .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#wycrszdyhx .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#wycrszdyhx .gt_indent_1 {
  text-indent: 5px;
}

#wycrszdyhx .gt_indent_2 {
  text-indent: 10px;
}

#wycrszdyhx .gt_indent_3 {
  text-indent: 15px;
}

#wycrszdyhx .gt_indent_4 {
  text-indent: 20px;
}

#wycrszdyhx .gt_indent_5 {
  text-indent: 25px;
}

#wycrszdyhx .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#wycrszdyhx div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-bootstrap="false">
<thead>
<tr class="gt_col_headings header">
<th id="Date" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Date</th>
<th id="short" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Short-wavelength irradiance (mW/m²)</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="gt_group_heading_row odd">
<th colspan="2" id="VEET" class="gt_group_heading" data-quarto-table-cell-role="th" scope="colgroup">VEET</th>
</tr>
<tr class="gt_row_group_first even">
<td class="gt_row gt_right" headers="VEET  Date">2025-06-18</td>
<td class="gt_row gt_right" headers="VEET  short">5.44</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="VEET  Date">2025-06-20</td>
<td class="gt_row gt_right" headers="VEET  short">0.95</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</figure>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<p>To visualize short-wavelength exposure over the course of a day, we aggregate the data into hourly bins. We cut the timeline into 1-hour segments (using local time), compute the mean short-wavelength irradiance in each hour for each day. <a href="#fig-shorttime" class="quarto-xref">Figure&nbsp;9</a> shows the resulting diurnal profile, with short-wavelength exposure expressed as a fraction of the daily maximum for easier comparison.</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Plot a diurnal profile</strong></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="annotated-cell-43"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><a class="code-annotation-anchor" data-target-cell="annotated-cell-43" data-target-annotation="1" onclick="event.preventDefault();">1</a><span id="annotated-cell-43-1" class="code-annotation-target"><a href="#annotated-cell-43-1"></a>dataVEETtime <span class="ot">&lt;-</span> dataVEET <span class="sc">|&gt;</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-43" data-target-annotation="2" onclick="event.preventDefault();">2</a><span id="annotated-cell-43-2" class="code-annotation-target"><a href="#annotated-cell-43-2"></a>  <span class="fu">cut_Datetime</span>(<span class="at">unit =</span> <span class="st">"1 hour"</span>, <span class="at">type =</span> <span class="st">"floor"</span>, <span class="at">group_by =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="annotated-cell-43-3"><a href="#annotated-cell-43-3"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(Spectrum, long, Datetime)) <span class="sc">|&gt;</span></span>
<span id="annotated-cell-43-4"><a href="#annotated-cell-43-4"></a>  <span class="fu">summarize_numeric</span>(<span class="at">prefix =</span> <span class="st">""</span>) <span class="sc">|&gt;</span> </span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-43" data-target-annotation="3" onclick="event.preventDefault();">3</a><span id="annotated-cell-43-5" class="code-annotation-target"><a href="#annotated-cell-43-5"></a>  <span class="fu">add_Time_col</span>(Datetime.rounded)  <span class="sc">|&gt;</span></span>
<span id="annotated-cell-43-6"><a href="#annotated-cell-43-6"></a>  <span class="fu">mutate</span>(<span class="at">rel_short =</span> short <span class="sc">/</span> <span class="fu">max</span>(short))</span>
<span id="annotated-cell-43-7"><a href="#annotated-cell-43-7"></a></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-43" data-target-annotation="4" onclick="event.preventDefault();">4</a><span id="annotated-cell-43-8" class="code-annotation-target"><a href="#annotated-cell-43-8"></a>dataVEETtime <span class="sc">|&gt;</span></span>
<span id="annotated-cell-43-9"><a href="#annotated-cell-43-9"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>Time, <span class="at">y =</span> rel_short)) <span class="sc">+</span></span>
<span id="annotated-cell-43-10"><a href="#annotated-cell-43-10"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">factor</span>(Date)), <span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="annotated-cell-43-11"><a href="#annotated-cell-43-11"></a>  ggsci<span class="sc">::</span><span class="fu">scale_fill_jco</span>() <span class="sc">+</span></span>
<span id="annotated-cell-43-12"><a href="#annotated-cell-43-12"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="annotated-cell-43-13"><a href="#annotated-cell-43-13"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Normalized short-wavelength irradiance"</span>, </span>
<span id="annotated-cell-43-14"><a href="#annotated-cell-43-14"></a>       <span class="at">x =</span> <span class="st">"Local time (HH:MM)"</span>,</span>
<span id="annotated-cell-43-15"><a href="#annotated-cell-43-15"></a>       <span class="at">fill =</span> <span class="st">"Date"</span>) <span class="sc">+</span> </span>
<span id="annotated-cell-43-16"><a href="#annotated-cell-43-16"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_percent</span>()) <span class="sc">+</span></span>
<span id="annotated-cell-43-17"><a href="#annotated-cell-43-17"></a>  <span class="fu">scale_x_time</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_time</span>(<span class="at">format =</span> <span class="st">"%H:%M"</span>))</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-43" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-43" data-code-lines="1" data-code-annotation="1">Prepare hourly binned data</span>
</dd>
<dt data-target-cell="annotated-cell-43" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-43" data-code-lines="2" data-code-annotation="2">Bin timestamps by hour</span>
</dd>
<dt data-target-cell="annotated-cell-43" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-43" data-code-lines="5" data-code-annotation="3">Add a Time column (hour of day)</span>
</dd>
<dt data-target-cell="annotated-cell-43" data-target-annotation="4">4</dt>
<dd>
<span data-code-cell="annotated-cell-43" data-code-lines="8" data-code-annotation="4">Creating the plot</span>
</dd>
</dl>
</div>
<div class="cell-output-display">
<div id="fig-shorttime" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-shorttime-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="index_files/figure-html/fig-shorttime-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-10" title="Figure&nbsp;9: Diurnal profile of short-wavelength light exposure. Each bar represents the average short-wavelength irradiance at that hour of the day (0–23 h), normalized to the daily maximum."><img src="index_files/figure-html/fig-shorttime-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-shorttime-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9: Diurnal profile of short-wavelength light exposure. Each bar represents the average short-wavelength irradiance at that hour of the day (0–23 h), normalized to the daily maximum.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<p>Finally, we compare short-wavelength exposure during daytime vs.&nbsp;nighttime. Using civil dawn and dusk information (based on geographic coordinates, here set for Houston, TX, USA), we label each measurement as day or night and then compute the total short-wavelength exposure in each period. <a href="#tbl-daytime" class="quarto-xref">Table&nbsp;20</a> summarizes the daily short-wavelength dose received during the day vs.&nbsp;during the night.</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Calculate photoperiod dependent measures</strong></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>dataVEET <span class="sc">|&gt;</span></span>
<span id="cb11-2"><a href="#cb11-2"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(Spectrum, long, <span class="st">`</span><span class="at">sl ratio</span><span class="st">`</span>, melEDI, illuminance)) <span class="sc">|&gt;</span></span>
<span id="cb11-3"><a href="#cb11-3"></a>  <span class="fu">add_photoperiod</span>(coordinates) <span class="sc">|&gt;</span> </span>
<span id="cb11-4"><a href="#cb11-4"></a>  <span class="fu">group_by</span>(photoperiod.state, <span class="at">.add =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb11-5"><a href="#cb11-5"></a>  <span class="fu">summarize_numeric</span>(<span class="at">prefix =</span> <span class="st">""</span>, </span>
<span id="cb11-6"><a href="#cb11-6"></a>                    <span class="at">remove =</span> <span class="fu">c</span>(<span class="st">"dawn"</span>, <span class="st">"dusk"</span>, <span class="st">"photoperiod"</span>, <span class="st">"Datetime"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb11-7"><a href="#cb11-7"></a>  <span class="fu">group_by</span>(Id, photoperiod.state) <span class="sc">|&gt;</span> </span>
<span id="cb11-8"><a href="#cb11-8"></a>  <span class="fu">select</span>(<span class="sc">-</span>episodes) <span class="sc">|&gt;</span> </span>
<span id="cb11-9"><a href="#cb11-9"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span>photoperiod.state, <span class="at">values_from =</span> short) <span class="sc">|&gt;</span> </span>
<span id="cb11-10"><a href="#cb11-10"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span> </span>
<span id="cb11-11"><a href="#cb11-11"></a>  <span class="fu">fmt_number</span>(<span class="at">scale_by =</span> <span class="dv">1000</span>, <span class="at">decimals =</span> <span class="dv">1</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="tbl-daytime" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-daytime-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;20: Short wavelength light exposure (mW/m²) during the day and at night
</figcaption>
<div aria-describedby="tbl-daytime-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="jqxmnjrmrl" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#jqxmnjrmrl table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#jqxmnjrmrl thead, #jqxmnjrmrl tbody, #jqxmnjrmrl tfoot, #jqxmnjrmrl tr, #jqxmnjrmrl td, #jqxmnjrmrl th {
  border-style: none;
}

#jqxmnjrmrl p {
  margin: 0;
  padding: 0;
}

#jqxmnjrmrl .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#jqxmnjrmrl .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#jqxmnjrmrl .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#jqxmnjrmrl .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#jqxmnjrmrl .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#jqxmnjrmrl .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jqxmnjrmrl .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#jqxmnjrmrl .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#jqxmnjrmrl .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#jqxmnjrmrl .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#jqxmnjrmrl .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#jqxmnjrmrl .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#jqxmnjrmrl .gt_spanner_row {
  border-bottom-style: hidden;
}

#jqxmnjrmrl .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#jqxmnjrmrl .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#jqxmnjrmrl .gt_from_md > :first-child {
  margin-top: 0;
}

#jqxmnjrmrl .gt_from_md > :last-child {
  margin-bottom: 0;
}

#jqxmnjrmrl .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#jqxmnjrmrl .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#jqxmnjrmrl .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#jqxmnjrmrl .gt_row_group_first td {
  border-top-width: 2px;
}

#jqxmnjrmrl .gt_row_group_first th {
  border-top-width: 2px;
}

#jqxmnjrmrl .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#jqxmnjrmrl .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#jqxmnjrmrl .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#jqxmnjrmrl .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jqxmnjrmrl .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#jqxmnjrmrl .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#jqxmnjrmrl .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#jqxmnjrmrl .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#jqxmnjrmrl .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jqxmnjrmrl .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#jqxmnjrmrl .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#jqxmnjrmrl .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#jqxmnjrmrl .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#jqxmnjrmrl .gt_left {
  text-align: left;
}

#jqxmnjrmrl .gt_center {
  text-align: center;
}

#jqxmnjrmrl .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#jqxmnjrmrl .gt_font_normal {
  font-weight: normal;
}

#jqxmnjrmrl .gt_font_bold {
  font-weight: bold;
}

#jqxmnjrmrl .gt_font_italic {
  font-style: italic;
}

#jqxmnjrmrl .gt_super {
  font-size: 65%;
}

#jqxmnjrmrl .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#jqxmnjrmrl .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#jqxmnjrmrl .gt_indent_1 {
  text-indent: 5px;
}

#jqxmnjrmrl .gt_indent_2 {
  text-indent: 10px;
}

#jqxmnjrmrl .gt_indent_3 {
  text-indent: 15px;
}

#jqxmnjrmrl .gt_indent_4 {
  text-indent: 20px;
}

#jqxmnjrmrl .gt_indent_5 {
  text-indent: 25px;
}

#jqxmnjrmrl .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#jqxmnjrmrl div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-bootstrap="false">
<thead>
<tr class="gt_col_headings header">
<th id="Date" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Date</th>
<th id="day" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">day</th>
<th id="night" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">night</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="gt_group_heading_row odd">
<th colspan="3" id="VEET" class="gt_group_heading" data-quarto-table-cell-role="th" scope="colgroup">VEET</th>
</tr>
<tr class="gt_row_group_first even">
<td class="gt_row gt_right" headers="VEET  Date">2025-06-18</td>
<td class="gt_row gt_right" headers="VEET  day">126.5</td>
<td class="gt_row gt_right" headers="VEET  night">12.3</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="VEET  Date">2025-06-20</td>
<td class="gt_row gt_right" headers="VEET  day">181.8</td>
<td class="gt_row gt_right" headers="VEET  night">1.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</figure>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>In the code cell above, <code>add_photoperiod(coordinates)</code> is used as a convenient way to add columns to the data frame, indicating for each timestamp whether it was day or night, given the latitude/longitude.</p>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="discussion-and-conclusion" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="discussion-and-conclusion"><span class="header-section-number">4</span> Discussion and conclusion</h2>
<p>This tutorial demonstrates a standardized, step-by-step pipeline to calculate a variety of visual experience metrics. We illustrated how a combination of LightLogR functions and tidyverse workflows can yield clear and reproducible analyses for wearable device data. While the full pipeline is detailed, each metric is computed through a dedicated sequence of well-documented steps, yet remains configurable to realize different metric definitions or thresholds.</p>
<p>By leveraging LightLogR’s framework alongside common data analysis approaches, the process remains transparent and relatively easy to follow. The overall goal is to make analysis transparent (with open-source functions), accessible (through thorough documentation, tutorials, and human-readable function naming, all under an MIT license), robust (the package includes &gt;900 unit tests and continuous integration with bug tracking on GitHub), and community-driven (open feature requests and contributions via GitHub).</p>
<p>Even with standardized pipelines, researchers must still make and document many decisions during data cleaning, time-series handling, and metric calculations — especially for complex metrics that involve grouping data in multiple ways (for example, grouping by distance range as well as by duration for cluster metrics). We have highlighted these decision points in the tutorial (such as how to handle irregular intervals, choosing thresholds for “near” distances or “outdoor” light, and deciding on minimum durations for sustained events). Explicitly considering and reporting these choices is important for reproducibility and for comparing results across studies.</p>
<p>The broad set of features in LightLogR — ranging from data import and cleaning tools (for handling time gaps and irregularities) to visualization functions and metric calculators — make it a powerful toolkit for visual experience research. Our examples spanned circadian-light metrics and myopia-related metrics, demonstrating the versatility of a unified analysis approach. By using community-supported tools and workflows, researchers in vision science, chronobiology, myopia, and related fields can reduce time spent on low-level data wrangling and focus more on interpreting results and advancing scientific understanding.</p>
</section>
<section id="sessioninfo" class="level2" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="sessioninfo"><span class="header-section-number">5</span> Session info</h2>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="fu">sessionInfo</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>R version 4.5.2 (2025-10-31)
Platform: x86_64-pc-linux-gnu
Running under: Ubuntu 24.04.3 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 
LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

time zone: UTC
tzcode source: system (glibc)

attached base packages:
[1] stats     graphics  grDevices datasets  utils     methods   base     

other attached packages:
 [1] gt_1.1.0         lubridate_1.9.4  forcats_1.0.1    stringr_1.6.0   
 [5] dplyr_1.1.4      purrr_1.2.0      readr_2.1.6      tidyr_1.3.1     
 [9] tibble_3.3.0     ggplot2_4.0.1    tidyverse_2.0.0  LightLogR_0.10.0

loaded via a namespace (and not attached):
 [1] sass_0.4.10        generics_0.1.4     renv_1.1.5         class_7.3-23      
 [5] xml2_1.5.1         KernSmooth_2.23-26 stringi_1.8.7      hms_1.1.4         
 [9] digest_0.6.39      magrittr_2.0.4     evaluate_1.0.5     grid_4.5.2        
[13] timechange_0.3.0   RColorBrewer_1.1-3 fastmap_1.2.0      jsonlite_2.0.0    
[17] e1071_1.7-16       DBI_1.2.3          viridisLite_0.4.2  scales_1.4.0      
[21] textshaping_1.0.4  cli_3.6.5          rlang_1.1.6        units_1.0-0       
[25] cowplot_1.2.0      withr_3.0.2        yaml_2.3.12        tools_4.5.2       
[29] tzdb_0.5.0         vctrs_0.6.5        R6_2.6.1           proxy_0.4-27      
[33] classInt_0.4-11    lifecycle_1.0.4    fs_1.6.6           htmlwidgets_1.6.4 
[37] ragg_1.5.0         pkgconfig_2.0.3    pillar_1.11.1      gtable_0.3.6      
[41] Rcpp_1.1.0         glue_1.8.0         sf_1.0-23          systemfonts_1.3.1 
[45] xfun_0.54          tidyselect_1.2.1   knitr_1.50         farver_2.1.2      
[49] htmltools_0.5.9    rmarkdown_2.30     ggsci_4.1.0        labeling_0.4.3    
[53] suntools_1.1.0     compiler_4.5.2     S7_0.2.1          </code></pre>
</div>
</div>
</section>
<section id="statements" class="level2" data-number="6">
<h2 data-number="6" class="anchored" data-anchor-id="statements"><span class="header-section-number">6</span> Statements</h2>
<section id="data-availability-statement" class="level3" data-number="6.1">
<h3 data-number="6.1" class="anchored" data-anchor-id="data-availability-statement"><span class="header-section-number">6.1</span> Data availability statement</h3>
<p>All data and code in this tutorial and Supplement 1 are available from the GitHub repository: https://github.com/tscnlab/ZaunerEtAl_JVis_2026/, archived on Zenodo: https://doi.org/10.5281/zenodo.16566014 under a MIT license (data under CC-BY license).</p>
</section>
<section id="funding-statement" class="level3" data-number="6.2">
<h3 data-number="6.2" class="anchored" data-anchor-id="funding-statement"><span class="header-section-number">6.2</span> Funding statement</h3>
<p>JZ’s position is funded by the MeLiDos project. The project has received funding from the European Partnership on Metrology (22NRM05 MeLiDos), co-financed from the European Union’s Horizon Europe Research and Innovation Programme and by the Participating States. Views and opinions expressed are however those of the author(s) only and do not necessarily reflect those of the European Union or EURAMET. Neither the European Union nor the granting authority can be held responsible for them. JZ, LAO, and MS received research funding from Reality Labs Research. The funders had no role in study design, data collection and analysis, decision to publish or preparation of the manuscript.</p>
</section>
<section id="conflict-of-interest-statement" class="level3" data-number="6.3">
<h3 data-number="6.3" class="anchored" data-anchor-id="conflict-of-interest-statement"><span class="header-section-number">6.3</span> Conflict of interest statement</h3>
<p>JZ declares the following potential conflict of interest in the past five years (2021-2025). Funding: Received research funding from Reality Labs Research.</p>
<p>AN declares the following potential conflicts of interest in the past five years (2021-2025). none</p>
<p>LAO declares the following potential conflict of interest in the past five years (2021-2025). Consultancy: Zeiss, Alcon, EssilorLuxottica; Research support: Topcon, Meta, LLC; Patents: US 11375890 B2</p>
<p>MS declares the following potential conflicts of interest in the past five years (2021–2025). Academic roles: Member of the Board of Directors, Society of Light, Rhythms, and Circadian Health (SLRCH); Chair of Joint Technical Committee 20 (JTC20) of the International Commission on Illumination (CIE); Member of the Daylight Academy; Chair of Research Data Alliance Working Group Optical Radiation and Visual Experience Data. Remunerated roles: Speaker of the Steering Committee of the Daylight Academy; Ad-hoc reviewer for the Health and Digital Executive Agency of the European Commission; Ad-hoc reviewer for the Swedish Research Council; Associate Editor for LEUKOS, journal of the Illuminating Engineering Society; Examiner, University of Manchester; Examiner, Flinders University; Examiner, University of Southern Norway. Funding: Received research funding and support from the Max Planck Society, Max Planck Foundation, Max Planck Innovation, Technical University of Munich, Wellcome Trust, National Research Foundation Singapore, European Partnership on Metrology, VELUX Foundation, Bayerisch-Tschechische Hochschulagentur (BTHA), BayFrance (Bayerisch-Französisches Hochschulzentrum), BayFOR (Bayerische Forschungsallianz), and Reality Labs Research. Honoraria for talks: Received honoraria from the ISGlobal, Research Foundation of the City University of New York and the Stadt Ebersberg, Museum Wald und Umwelt. Travel reimbursements: Daimler und Benz Stiftung. Patents: Named on European Patent Application EP23159999.4A (“System and method for corneal-plane physiologically-relevant light logging with an application to personalized light interventions related to health and well-being”). With the exception of the funding source supporting this work, M.S. declares no influence of the disclosed roles or relationships on the work presented herein.</p>
</section>
<section id="statement-of-generative-ai-and-ai-assisted-technologies-in-the-writing-process" class="level3" data-number="6.4">
<h3 data-number="6.4" class="anchored" data-anchor-id="statement-of-generative-ai-and-ai-assisted-technologies-in-the-writing-process"><span class="header-section-number">6.4</span> Statement of generative AI and AI-assisted technologies in the writing process</h3>
<p>The authors used ChatGPT during the preparation of this work. After using this tool, the authors reviewed and edited the content as needed and take full responsibility for the content of the publication.</p>
<p>Use of AI in contributor roles <a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a>: Conceptualization: no Data curation: no Formal analysis: bug fixing Methodology: no Software: bug fixing Validation: no Visualization: tweaking of options Writing – original draft: abstract refinement Writing – review &amp; editing: improve readability and language</p>
</section>
</section>
<section id="references" class="level2" data-number="7">



<!-- -->


</section>


<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">7 References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-Bhandari2020OphthalmicPhysiolOpt" class="csl-entry" role="listitem">
Bhandari, Khob R, and Lisa A Ostrin. 2020. <span>“Validation of the Clouclip and Utility in Measuring Viewing Distance in Adults.”</span> <em>Ophthalmic and Physiological Optics</em> 40 (6): 801–14. https://doi.org/<a href="https://doi.org/10.1111/opo.12735">https://doi.org/10.1111/opo.12735</a>.
</div>
<div id="ref-Biller2024CommunPsychol" class="csl-entry" role="listitem">
Biller, A. M., P. Balakrishnan, and M. Spitschan. 2024. <span>“Behavioural Determinants of Physiologically-Relevant Light Exposure.”</span> Journal Article. <em>Commun Psychol</em> 2 (1): 114. <a href="https://doi.org/10.1038/s44271-024-00159-5">https://doi.org/10.1038/s44271-024-00159-5</a>.
</div>
<div id="ref-Blume2019Somnologie" class="csl-entry" role="listitem">
Blume, C., C. Garbazza, and M. Spitschan. 2019. <span>“Effects of Light on Human Circadian Rhythms, Sleep and Mood.”</span> Journal Article. <em>Somnologie (Berl)</em> 23 (3): 147–56. <a href="https://doi.org/10.1007/s11818-019-00215-x">https://doi.org/10.1007/s11818-019-00215-x</a>.
</div>
<div id="ref-Brown2022PLoSBiol" class="csl-entry" role="listitem">
Brown, T. M., G. C. Brainard, C. Cajochen, C. A. Czeisler, J. P. Hanifin, S. W. Lockley, R. J. Lucas, et al. 2022. <span>“Recommendations for Daytime, Evening, and Nighttime Indoor Light Exposure to Best Support Physiology, Sleep, and Wakefulness in Healthy Adults.”</span> Journal Article. <em>PLoS Biol</em> 20 (3): e3001571. <a href="https://doi.org/10.1371/journal.pbio.3001571">https://doi.org/10.1371/journal.pbio.3001571</a>.
</div>
<div id="ref-CIE_S026_2018" class="csl-entry" role="listitem">
<span>“CIE System for Metrology of Optical Radiation for <span class="nocase">ipRGC</span>-Influenced Responses to Light.”</span> 2018, no. CIE S 026/E:2018. <a href="https://doi.org/10.25039/S026.2018">https://doi.org/10.25039/S026.2018</a>.
</div>
<div id="ref-DahlmannNoor2025GraefesArchClinExpOphthal" class="csl-entry" role="listitem">
Dahlmann-Noor, A. H., D. Bokre, M. Khazova, and L. L. A. Price. 2025. <span>“Measuring the Visual Environment of Children and Young People at Risk of Myopia: A Scoping Review.”</span> Journal Article. <em>Graefes Arch Clin Exp Ophthalmol</em>. <a href="https://doi.org/10.1007/s00417-024-06719-z">https://doi.org/10.1007/s00417-024-06719-z</a>.
</div>
<div id="ref-Gibaldi2024TranslVisSciTechnol" class="csl-entry" role="listitem">
Gibaldi, A., E. N. Harb, C. F. Wildsoet, and M. S. Banks. 2024. <span>“A Child-Friendly Wearable Device for Quantifying Environmental Risk Factors for Myopia.”</span> Journal Article. <em>Transl Vis Sci Technol</em> 13 (10): 28. <a href="https://doi.org/10.1167/tvst.13.10.28">https://doi.org/10.1167/tvst.13.10.28</a>.
</div>
<div id="ref-Guidolin2025BehavResMethods" class="csl-entry" role="listitem">
Guidolin, Carolina, Johannes Zauner, Steffen Lutz Hartmeyer, and Manuel Spitschan. 2024. <span>“Collecting, Detecting and Handling Non-Wear Intervals in Longitudinal Light Exposure Data.”</span> <em>bioRxiv</em>. <a href="https://doi.org/10.1101/2024.12.23.627604">https://doi.org/10.1101/2024.12.23.627604</a>.
</div>
<div id="ref-Hartmeyer2023LightResTechnol" class="csl-entry" role="listitem">
Hartmeyer, S. L., and M. Andersen. 2023. <span>“Towards a Framework for Light-Dosimetry Studies: Quantification Metrics.”</span> Journal Article. <em>Lighting Research &amp; Technology</em> 56 (4): 337–65. <a href="https://doi.org/10.1177/14771535231170500">https://doi.org/10.1177/14771535231170500</a>.
</div>
<div id="ref-Hartmeyer2022LightResTechnol" class="csl-entry" role="listitem">
Hartmeyer, S. L., F. S. Webler, and M. Andersen. 2022. <span>“Towards a Framework for Light-Dosimetry Studies: Methodological Considerations.”</span> Journal Article. <em>Lighting Research &amp; Technology</em> 55 (4-5): 377–99. <a href="https://doi.org/10.1177/14771535221103258">https://doi.org/10.1177/14771535221103258</a>.
</div>
<div id="ref-Honekopp2023ClinOphthalmol" class="csl-entry" role="listitem">
Hönekopp, A., and S. Weigelt. 2023. <span>“Using Light Meters to Investigate the Light-Myopia Association - a Literature Review of Devices and Research Methods.”</span> Journal Article. <em>Clin Ophthalmol</em> 17: 2737–60. <a href="https://doi.org/10.2147/OPTH.S420631">https://doi.org/10.2147/OPTH.S420631</a>.
</div>
<div id="ref-Mohamed2021OptExpress" class="csl-entry" role="listitem">
Mohamed, A., V. Kalavally, S. W. Cain, A. J. K. Phillips, E. M. McGlashan, and C. P. Tan. 2021. <span>“Wearable Light Spectral Sensor Optimized for Measuring Daily Alpha-Opic Light Exposure.”</span> Journal Article. <em>Opt Express</em> 29 (17): 27612–27. <a href="https://doi.org/10.1364/OE.431373">https://doi.org/10.1364/OE.431373</a>.
</div>
<div id="ref-murukesu2025ADID" class="csl-entry" role="listitem">
Murukesu, Resshaya Roobini, Johannes Zauner, and Manuel Spitschan. 2025. <span>“A Day in Daylight,”</span> November. <a href="https://doi.org/10.5281/zenodo.17513996">https://doi.org/10.5281/zenodo.17513996</a>.
</div>
<div id="ref-Okudaira1983AmJPhysiol" class="csl-entry" role="listitem">
Okudaira, N., D. F. Kripke, and J. B. Webster. 1983. <span>“Naturalistic Studies of Human Light Exposure.”</span> Journal Article. <em>Am J Physiol</em> 245 (4): R613–5. <a href="https://doi.org/10.1152/ajpregu.1983.245.4.R613">https://doi.org/10.1152/ajpregu.1983.245.4.R613</a>.
</div>
<div id="ref-pattersongentile2025" class="csl-entry" role="listitem">
Patterson Gentile, Carlyn, Ryan Shah, Blanca Marquez De Prado, Nichelle Raj, Christina L. Szperka, Andrew D. Hershey, and Geoffrey K. Aguirre. 2025. <span>“Daily Light Exposure Habits of Youth with Migraine: A Prospective Exploratory Study.”</span> <em>Npj Biological Timing and Sleep</em> 2 (1). <a href="https://doi.org/10.1038/s44323-025-00056-y">https://doi.org/10.1038/s44323-025-00056-y</a>.
</div>
<div id="ref-Sah2025OphtalmicPhysiolOpt" class="csl-entry" role="listitem">
Sah, Raman Prasad, Pavan Kalyan Narra, and Lisa A. Ostrin. 2025. <span>“A Novel Wearable Sensor for Objective Measurement of Distance and Illumination.”</span> <em>Ophthalmic and Physiological Optics</em> 00 (n/a): 1–13. https://doi.org/<a href="https://doi.org/10.1111/opo.13523">https://doi.org/10.1111/opo.13523</a>.
</div>
<div id="ref-Sullivan2024" class="csl-entry" role="listitem">
Sullivan, David, Aaron Nicholls, George Hatoun, Samuel Thompson, Cory Schwarzmiller, Fathollah Memarzanjany, Alyssa Gunderson, et al. 2024. <span>“The Visual Experience Evaluation Tool: A Myopia Research Instrument for Quantifying Visual Experience.”</span> <em>bioRxiv</em>. <a href="https://doi.org/10.1101/2024.09.20.614212">https://doi.org/10.1101/2024.09.20.614212</a>.
</div>
<div id="ref-tabandeh2025" class="csl-entry" role="listitem">
Tabandeh, Niloufar, and Manuel Spitschan. 2025. <span>“Photoreceptor-Specific Scene Statistics Reveal Melanopic Structure in Natural Environments,”</span> November. <a href="http://dx.doi.org/10.1101/2025.11.10.687567">http://dx.doi.org/10.1101/2025.11.10.687567</a>.
</div>
<div id="ref-vanDuijnhoven2025BuildEnviron" class="csl-entry" role="listitem">
van Duijnhoven, J., S. L. Hartmeyer, A. Didikoglu, O. Stefani, K. W. Houser, V. Kalavally, and M. Spitschan. 2025. <span>“Measuring Light Exposure in Daily Life: A Review of Wearable Light Loggers.”</span> Journal Article. <em>Build Environ</em> 274. <a href="https://doi.org/10.1016/j.buildenv.2025.112771">https://doi.org/10.1016/j.buildenv.2025.112771</a>.
</div>
<div id="ref-Webler2019CurrOpinBehavSci" class="csl-entry" role="listitem">
Webler, F. S., M. Spitschan, R. G. Foster, M. Andersen, and S. N. Peirson. 2019. <span>“What Is the ’Spectral Diet’ of Humans?”</span> Journal Article. <em>Curr Opin Behav Sci</em> 30: 80–86. <a href="https://doi.org/10.1016/j.cobeha.2019.06.006">https://doi.org/10.1016/j.cobeha.2019.06.006</a>.
</div>
<div id="ref-Wen2020bjophthalmol" class="csl-entry" role="listitem">
Wen, Longbo, Yingpin Cao, Qian Cheng, Xiaoning Li, Lun Pan, Lei Li, HaoGang Zhu, Weizhong Lan, and Zhikuan Yang. 2020. <span>“Objectively Measured Near Work, Outdoor Exposure and Myopia in Children.”</span> <em>British Journal of Ophthalmology</em> 104 (11): 1542–47. <a href="https://doi.org/10.1136/bjophthalmol-2019-315258">https://doi.org/10.1136/bjophthalmol-2019-315258</a>.
</div>
<div id="ref-Wen2021ActaOphtalmol" class="csl-entry" role="listitem">
Wen, Longbo, Qian Cheng, Yingpin Cao, Xiaoning Li, Lun Pan, Lei Li, Haogang Zhu, Ian Mogran, Weizhong Lan, and Zhikuan Yang. 2021. <span>“The Clouclip, a Wearable Device for Measuring Near-Work and Outdoor Time: Validation and Comparison of Objective Measures with Questionnaire Estimates.”</span> <em>Acta Ophthalmologica</em> 99 (7): e1222–35. https://doi.org/<a href="https://doi.org/10.1111/aos.14785">https://doi.org/10.1111/aos.14785</a>.
</div>
<div id="ref-Wen2019TransVisSciTech" class="csl-entry" role="listitem">
Wen, Longbo, Qian Cheng, Weizhong Lan, Yingpin Cao, Xiaoning Li, Yiqiu Lu, Zhenghua Lin, Lun Pan, Haogang Zhu, and Zhikuan Yang. 2019. <span>“An Objective Comparison of Light Intensity and Near-Visual Tasks Between Rural and Urban School Children in China by a Wearable Device Clouclip.”</span> <em>Translational Vision Science &amp; Technology</em> 8 (6): 15–15. <a href="https://doi.org/10.1167/tvst.8.6.15">https://doi.org/10.1167/tvst.8.6.15</a>.
</div>
<div id="ref-Williams2019Scientificreports" class="csl-entry" role="listitem">
Williams, Rachel, Suyash Bakshi, Edwin J Ostrin, and Lisa A Ostrin. 2019. <span>“Continuous Objective Assessment of Near Work.”</span> <em>Scientific Reports</em> 9 (1): 6901.
</div>
<div id="ref-ZaunerEtAl2025JBR" class="csl-entry" role="listitem">
Zauner, J., C. Guidolin, and M. Spitschan. <span>“How to Deal with Darkness: Modeling and Visualization of Zero-Inflated Personal Light Exposure Data on a Logarithmic Scale.”</span> <em>Journal of Biological Rhythms</em> 0 (0): 07487304251336624. <a href="https://doi.org/10.1177/07487304251336624">https://doi.org/10.1177/07487304251336624</a>.
</div>
<div id="ref-Zauner2025JOpenSourceSoftw" class="csl-entry" role="listitem">
Zauner, J., S. Hartmeyer, and M. Spitschan. 2025. <span>“LightLogR: Reproducible Analysis of Personal Light Exposure Data.”</span> Journal Article. <em>J Open Source Softw</em> 10 (107): 7601. <a href="https://doi.org/10.21105/joss.07601">https://doi.org/10.21105/joss.07601</a>.
</div>
<div id="ref-zauner2025" class="csl-entry" role="listitem">
Zauner, Johannes, Rigmor C. Baraas, Elise N. Harb, Ali Heshmati, Francisco Imai, Pauline Kang, Raymond P. Najjar, et al. 2025. <span>“Technical Guide for Wearable Optical Radiation Dosimetry and Visual Experience Assessment.”</span> <a href="https://doi.org/10.17617/6XCA-CG59">https://doi.org/10.17617/6XCA-CG59</a>.
</div>
<div id="ref-Zauner2025LightResTech" class="csl-entry" role="listitem">
Zauner, Johannes, Oliver Stefani, Anna M. Biller, Carolina Guidolin, and Manuel Spitschan. 2025. <span>“A Web-Based Specification Tool for Wearable Light Loggers and Optical Radiation Dosimeters.”</span> <em>Preprints</em>. <a href="https://doi.org/10.20944/preprints202511.0644.v1">https://doi.org/10.20944/preprints202511.0644.v1</a>.
</div>
<div id="ref-Zauner2025npj" class="csl-entry" role="listitem">
Zauner, J., O. Stefani, G. Bocanegra, C. Guidolin, B. Schrader, L. Udovicic, and M. Spitschan. 2025. <span>“Auxiliary Data, Quality Assurance and Quality Control for Wearable Light Loggers and Optical Radiation Dosimeters.”</span> <em>bioRxiv</em>. <a href="https://doi.org/10.1101/2025.09.11.675633">https://doi.org/10.1101/2025.09.11.675633</a>.
</div>
<div id="ref-Zauner2024PLOSONE" class="csl-entry" role="listitem">
Zauner, J., L. Udovicic, and M. Spitschan. 2024. <span>“Power Analysis for Personal Light Exposure Measurements and Interventions.”</span> <em>PLOS ONE</em> 19 (12): 1–15. <a href="https://doi.org/10.1371/journal.pone.0308768">https://doi.org/10.1371/journal.pone.0308768</a>.
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>Functions from <code>LightLogR</code> are presented as links to the function documentation. General analysis functions (from package <code>dplyr</code>) are presented as normal text.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>The upper threshold refers to the <code>Clouclips</code>` maximum distance measurement and is not theoretically based<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>This deviates from the common definition of luminous exposure, which is the sum of illuminance measurements scaled to hourly observation intervals<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>Note that older firmware versions of the <code>VEET</code> prior to <em>2.1.7</em> contained two <code>Clear</code> channels and the highest spectral channel was indicated as 940&nbsp;nm. Data collected with this early firmware version are not suitable for spectral reconstruction in the context of research projects.<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>Based on the CRediT taxonomy. Funding acquisition, investigation, project administration, resources, and supervision were deemed irrelevant in this context and thus removed.<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/tscnlab\.github\.io\/ZaunerEtAl_JVis_2026\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb14" data-shortcodes="false"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb14-1"><a href="#cb14-1"></a><span class="co">---</span></span>
<span id="cb14-2"><a href="#cb14-2"></a><span class="an">title:</span><span class="co"> "Analysis of human visual experience data"</span></span>
<span id="cb14-3"><a href="#cb14-3"></a><span class="an">author:</span><span class="co"> </span></span>
<span id="cb14-4"><a href="#cb14-4"></a><span class="co">  - name: "Johannes Zauner"</span></span>
<span id="cb14-5"><a href="#cb14-5"></a><span class="co">    id: JZ</span></span>
<span id="cb14-6"><a href="#cb14-6"></a><span class="co">    affiliation: </span></span>
<span id="cb14-7"><a href="#cb14-7"></a><span class="co">      - Technical University of Munich, Germany</span></span>
<span id="cb14-8"><a href="#cb14-8"></a><span class="co">      - Max Planck Institute for Biological Cybernetics, Germany</span></span>
<span id="cb14-9"><a href="#cb14-9"></a><span class="co">    orcid: "0000-0003-2171-4566"</span></span>
<span id="cb14-10"><a href="#cb14-10"></a><span class="co">    corresponding: true</span></span>
<span id="cb14-11"><a href="#cb14-11"></a><span class="co">    email: johannes.zauner@tum.de</span></span>
<span id="cb14-12"><a href="#cb14-12"></a><span class="co">  - name: "Aaron Nicholls"</span></span>
<span id="cb14-13"><a href="#cb14-13"></a><span class="co">    id: AN</span></span>
<span id="cb14-14"><a href="#cb14-14"></a><span class="co">    affiliation: "Reality Labs Research, USA"</span></span>
<span id="cb14-15"><a href="#cb14-15"></a><span class="co">    orcid: "0009-0001-6683-6826"</span></span>
<span id="cb14-16"><a href="#cb14-16"></a><span class="co">  - name: "Lisa A. Ostrin"</span></span>
<span id="cb14-17"><a href="#cb14-17"></a><span class="co">    id: LAO</span></span>
<span id="cb14-18"><a href="#cb14-18"></a><span class="co">    affiliation: "University of Houston College of Optometry, USA"</span></span>
<span id="cb14-19"><a href="#cb14-19"></a><span class="co">    orcid: "0000-0001-8675-1478"</span></span>
<span id="cb14-20"><a href="#cb14-20"></a><span class="co">  - name: "Manuel Spitschan"</span></span>
<span id="cb14-21"><a href="#cb14-21"></a><span class="co">    id: MS</span></span>
<span id="cb14-22"><a href="#cb14-22"></a><span class="co">    affiliation: </span></span>
<span id="cb14-23"><a href="#cb14-23"></a><span class="co">      - Technical University of Munich, Germany</span></span>
<span id="cb14-24"><a href="#cb14-24"></a><span class="co">      - Max Planck Institute for Biological Cybernetics, Germany</span></span>
<span id="cb14-25"><a href="#cb14-25"></a><span class="co">      - Technical University of Munich, Institute for Advanced Study (TUM-IAS), Germany</span></span>
<span id="cb14-26"><a href="#cb14-26"></a><span class="co">    orcid: "0000-0002-8572-9268"</span></span>
<span id="cb14-27"><a href="#cb14-27"></a><span class="an">abstract:</span><span class="co"> &gt;</span></span>
<span id="cb14-28"><a href="#cb14-28"></a><span class="co">  Exposure to the optical environment — often referred to as *visual experience* — profoundly influences human physiology and behavior across multiple time scales. In controlled laboratory settings, stimuli can be held constant or manipulated parametrically. However, such exposures rarely replicate real-world conditions, which are inherently complex and dynamic, generating high-dimensional datasets that demand rigorous and flexible analysis strategies. This tutorial presents an analysis pipeline for visual experience datasets, with a focus on reproducible workflows for human chronobiology and myopia research. Light exposure and its retinal encoding affect human physiology and behavior across multiple time scales. Here we provide step-by-step instructions for importing, visualizing, and processing viewing distance and light exposure data. This includes time-series analyses for working distance, biologically relevant light metrics, and spectral characteristics. The tasks are standardized through the open-source R package [**LightLogR**](https://tscnlab.github.io/LightLogR/). By leveraging a modular approach, the tutorial supports researchers in building flexible and robust pipelines that accommodate diverse experimental paradigms and measurement systems.</span></span>
<span id="cb14-29"><a href="#cb14-29"></a><span class="an">keywords:</span><span class="co"> </span></span>
<span id="cb14-30"><a href="#cb14-30"></a><span class="co">  - wearable</span></span>
<span id="cb14-31"><a href="#cb14-31"></a><span class="co">  - light logging</span></span>
<span id="cb14-32"><a href="#cb14-32"></a><span class="co">  - viewing-distance</span></span>
<span id="cb14-33"><a href="#cb14-33"></a><span class="co">  - visual experience</span></span>
<span id="cb14-34"><a href="#cb14-34"></a><span class="co">  - metrics</span></span>
<span id="cb14-35"><a href="#cb14-35"></a><span class="co">  - circadian</span></span>
<span id="cb14-36"><a href="#cb14-36"></a><span class="co">  - myopia</span></span>
<span id="cb14-37"><a href="#cb14-37"></a><span class="co">  - risk factors</span></span>
<span id="cb14-38"><a href="#cb14-38"></a><span class="co">  - spectral analysis</span></span>
<span id="cb14-39"><a href="#cb14-39"></a><span class="co">  - open-source</span></span>
<span id="cb14-40"><a href="#cb14-40"></a><span class="co">  - reproducibility</span></span>
<span id="cb14-41"><a href="#cb14-41"></a><span class="an">funding:</span><span class="co"> "JZs position is funded by MeLiDos, The project (22NRM05 MeLiDos) has received funding from the European Partnership on Metrology, co-financed from the European Union’s Horizon Europe Research and Innovation Programme and by the Participating States. Views and opinions expressed are however those of the author(s) only and do not necessarily reflect those of the European Union or EURAMET. Neither the European Union nor the granting authority can be held responsible for them. JZ, LAO, and MS received funding from Reality Labs Research."</span></span>
<span id="cb14-42"><a href="#cb14-42"></a><span class="an">format:</span></span>
<span id="cb14-43"><a href="#cb14-43"></a><span class="co">  html:</span></span>
<span id="cb14-44"><a href="#cb14-44"></a><span class="co">    toc: true</span></span>
<span id="cb14-45"><a href="#cb14-45"></a><span class="co">    toc-depth: 3</span></span>
<span id="cb14-46"><a href="#cb14-46"></a><span class="co">    toc-location: right</span></span>
<span id="cb14-47"><a href="#cb14-47"></a><span class="co">    number-sections: true</span></span>
<span id="cb14-48"><a href="#cb14-48"></a><span class="co">    code-link: true</span></span>
<span id="cb14-49"><a href="#cb14-49"></a><span class="co">    code-tools: true</span></span>
<span id="cb14-50"><a href="#cb14-50"></a><span class="co">    grid:</span></span>
<span id="cb14-51"><a href="#cb14-51"></a><span class="co">      body-width: 850px</span></span>
<span id="cb14-52"><a href="#cb14-52"></a><span class="co">    html-math-method:</span></span>
<span id="cb14-53"><a href="#cb14-53"></a><span class="co">      method: mathjax</span></span>
<span id="cb14-54"><a href="#cb14-54"></a><span class="co">      url: "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML"</span></span>
<span id="cb14-55"><a href="#cb14-55"></a><span class="an">doi:</span><span class="co"> 10.5281/zenodo.16566014</span></span>
<span id="cb14-56"><a href="#cb14-56"></a><span class="an">bibliography:</span><span class="co"> references.bib</span></span>
<span id="cb14-57"><a href="#cb14-57"></a><span class="an">lightbox:</span><span class="co"> true</span></span>
<span id="cb14-58"><a href="#cb14-58"></a><span class="an">execute:</span></span>
<span id="cb14-59"><a href="#cb14-59"></a><span class="co">  echo: true</span></span>
<span id="cb14-60"><a href="#cb14-60"></a><span class="co">---</span></span>
<span id="cb14-61"><a href="#cb14-61"></a></span>
<span id="cb14-62"><a href="#cb14-62"></a><span class="fu">## Introduction</span></span>
<span id="cb14-63"><a href="#cb14-63"></a></span>
<span id="cb14-64"><a href="#cb14-64"></a><span class="al">![](assets/abstract_med.gif)</span>{width=40%}</span>
<span id="cb14-65"><a href="#cb14-65"></a></span>
<span id="cb14-66"><a href="#cb14-66"></a>Exposure to the optical environment — often referred to as *visual experience* — profoundly influences human physiology and behavior across multiple time scales. Two notable examples, from distinct research domains, can be understood through a common retinally-referenced framework.</span>
<span id="cb14-67"><a href="#cb14-67"></a></span>
<span id="cb14-68"><a href="#cb14-68"></a>The first example relates to the non-visual effects of light on human circadian and neuroendocrine physiology. The light–dark cycle entrains the circadian clock, and light exposure at night suppresses melatonin production <span class="co">[</span><span class="ot">@Brown2022PLoSBiol; @Blume2019Somnologie</span><span class="co">]</span>. The second example concerns the influence of visual experience on ocular development, particularly myopia. Time spent outdoors — which features distinct optical environments — has been consistently associated with protective effects on ocular growth and health outcomes <span class="co">[</span><span class="ot">@DahlmannNoor2025GraefesArchClinExpOphthal</span><span class="co">]</span>.</span>
<span id="cb14-69"><a href="#cb14-69"></a></span>
<span id="cb14-70"><a href="#cb14-70"></a>In controlled laboratory settings, light exposure can be held constant or manipulated parametrically. In contrast, real-world conditions are inherently complex and dynamic, and cannot be captured by single spot measurements. As people move in and between spaces (indoors and outdoors) and move their body, head, and eyes, exposure to the optical environment varies significantly <span class="co">[</span><span class="ot">@Webler2019CurrOpinBehavSci</span><span class="co">]</span> and is modulated by behavior <span class="co">[</span><span class="ot">@Biller2024CommunPsychol</span><span class="co">]</span>. Wearable devices for measuring light exposure have thus emerged as vital tools to capture the ecological visual experience. These tools generate high-dimensional datasets that demand rigorous and flexible analysis strategies.</span>
<span id="cb14-71"><a href="#cb14-71"></a></span>
<span id="cb14-72"><a href="#cb14-72"></a>Starting in the 1980s <span class="co">[</span><span class="ot">@Okudaira1983AmJPhysiol</span><span class="co">]</span>, technology to measure optical exposure has matured, with miniaturized illuminance sensors now (in 2025) very common in consumer wearables <span class="co">[</span><span class="ot">@vanDuijnhoven2025BuildEnviron</span><span class="co">]</span>. In research, several devices are available that differ in functionality, ranging from small pins measuring ambient illuminance <span class="co">[</span><span class="ot">@Mohamed2021OptExpress</span><span class="co">]</span> to head-mounted multi-modal devices capturing nearly all relevant aspects of visual experience <span class="co">[</span><span class="ot">@Gibaldi2024TranslVisSciTechnol</span><span class="co">]</span>. Increased capabilities in wearables bring complex, dense datasets. These go hand-in-hand with a proliferation of metrics, as highlighted by recent review papers in both circadian and myopia research <span class="co">[</span><span class="ot">@Honekopp2023ClinOphthalmol; @Hartmeyer2023LightResTechnol</span><span class="co">]</span>.</span>
<span id="cb14-73"><a href="#cb14-73"></a></span>
<span id="cb14-74"><a href="#cb14-74"></a>At present, the analysis processes to derive metrics are often implemented on a per-laboratory or even per-researcher basis. This fragmentation is a potential source of errors and inconsistencies between studies, consumes considerable researcher time <span class="co">[</span><span class="ot">@Hartmeyer2022LightResTechnol</span><span class="co">]</span>, and these bespoke processes and formats hinder harmonization or meta-analysis across multiple studies. It is very common that more time is spent preparing data than gaining insights through rigorous statistical analysis. These preparation tasks are best handled, or at least facilitated, by standardized, transparent, community-based analysis pipelines <span class="co">[</span><span class="ot">@Zauner2024PLOSONE</span><span class="co">]</span>.</span>
<span id="cb14-75"><a href="#cb14-75"></a></span>
<span id="cb14-76"><a href="#cb14-76"></a>In circadian research, the R package LightLogR was developed to address this need <span class="co">[</span><span class="ot">@Zauner2025JOpenSourceSoftw</span><span class="co">]</span>. LightLogR is an open-source, MIT-licensed, community-driven package specifically designed for data from wearable light loggers and optical radiation dosimeters. It contains functions to calculate over sixty different metrics used in the field <span class="co">[</span><span class="ot">@Hartmeyer2023LightResTechnol</span><span class="co">]</span>. The package functions come with light-related defaults, but they remain fundamentally agnostic to modality. As a result, parameters like viewing distance and light spectra, both highly relevant to myopia research <span class="co">[</span><span class="ot">@Honekopp2023ClinOphthalmol</span><span class="co">]</span>, can easily be handled.</span>
<span id="cb14-77"><a href="#cb14-77"></a></span>
<span id="cb14-78"><a href="#cb14-78"></a>In this article, we demonstrate that LightLogR’s analysis pipelines and metric functions apply broadly across the field of visual experience research, not just to circadian rhythms and chronobiology. Our approach is modular and extensible, allowing researchers to adapt it to a variety of devices and research questions. Emphasis is placed on clarity, transparency, and reproducibility, aligning with best practices in scientific computing and open science. We use example data from two devices (worn by different individuals and at different times) to showcase the LightLogR workflow with metrics relevant to myopia research, covering working distance, (day)light exposure, and spectral analysis. Readers are encouraged to recreate the analysis using the provided code. All necessary data and code are openly available in the <span class="co">[</span><span class="ot">GitHub repository</span><span class="co">](https://github.com/tscnlab/ZaunerEtAl_JVis_2026)</span>.</span>
<span id="cb14-79"><a href="#cb14-79"></a></span>
<span id="cb14-80"><a href="#cb14-80"></a>::: {.callout-tip}</span>
<span id="cb14-81"><a href="#cb14-81"></a><span class="fu">### Scope</span></span>
<span id="cb14-82"><a href="#cb14-82"></a></span>
<span id="cb14-83"><a href="#cb14-83"></a>This article focuses on workflows for deriving condensed metrics from time-series data collected with wearable devices in the visual-experience domain. Specifically, we address illuminance, viewing distance, and spectral irradiance. Example datasets from two types of wearable devices are used for illustration.</span>
<span id="cb14-84"><a href="#cb14-84"></a></span>
<span id="cb14-85"><a href="#cb14-85"></a>Many relevant considerations arise when collecting data with wearable devices. This article covers only a subset of these. In particular, it does not address:</span>
<span id="cb14-86"><a href="#cb14-86"></a></span>
<span id="cb14-87"><a href="#cb14-87"></a><span class="ss">-   </span>device selection (see, e.g., <span class="co">[</span><span class="ot">@vanDuijnhoven2025BuildEnviron; @Zauner2025LightResTech</span><span class="co">]</span>)</span>
<span id="cb14-88"><a href="#cb14-88"></a><span class="ss">-   </span>measurement accuracy or device calibration</span>
<span id="cb14-89"><a href="#cb14-89"></a><span class="ss">-   </span>auxiliary data such as sleep/wake information (see, e.g., <span class="co">[</span><span class="ot">@Zauner2025npj; @Guidolin2025BehavResMethods</span><span class="co">]</span>)</span>
<span id="cb14-90"><a href="#cb14-90"></a></span>
<span id="cb14-91"><a href="#cb14-91"></a>More information on those aspects can be found in the <span class="co">[</span><span class="ot">*Technical guide for wearable optical radiation dosimetry and visual experience assessment*</span><span class="co">](https://doi.org/10.17617/6xca-cg59)</span> <span class="co">[</span><span class="ot">@zauner2025</span><span class="co">]</span>.</span>
<span id="cb14-92"><a href="#cb14-92"></a></span>
<span id="cb14-93"><a href="#cb14-93"></a>To demonstrate the workflows, this article uses expert-informed definitions of metrics and metric parameters (see, e.g., @tbl-one, @tbl-two, and the non-wear detection rules based on activity data described in <span class="co">[</span><span class="ot">Supplement&nbsp;1</span><span class="co">](supplement.qmd)</span>). These definitions and thresholds should not be interpreted as universal standards, nor are they hard-coded into the software package. For any application, parameter choices must be tailored to the research domain, study context and design, and the specifications of the wearable device.</span>
<span id="cb14-94"><a href="#cb14-94"></a></span>
<span id="cb14-95"><a href="#cb14-95"></a>Further, the article is split up in the main analysis part, where all metrics are calculated, and the <span class="co">[</span><span class="ot">Supplement&nbsp;1</span><span class="co">](supplement.qmd)</span>, where data is imported, screened, and prepared. Thus, the reader is referred to <span class="co">[</span><span class="ot">Supplement&nbsp;1</span><span class="co">](supplement.qmd)</span> for all aspects regarding data formats, preparation steps, and handling of gaps, i.e., missing data.</span>
<span id="cb14-96"><a href="#cb14-96"></a></span>
<span id="cb14-97"><a href="#cb14-97"></a>Lastly, the example data used in the article do not stem from a controlled experimental data collection but consist of pilot data gathered in an ecological setting without a fixed protocol. Given the substantial interindividual differences in visual experience metrics, and because the analyses focus on one participant at a time, the reported results should be interpreted as illustrative rather than representative of typical or population-level values.</span>
<span id="cb14-98"><a href="#cb14-98"></a>:::</span>
<span id="cb14-99"><a href="#cb14-99"></a></span>
<span id="cb14-100"><a href="#cb14-100"></a><span class="fu">## Methods and materials</span></span>
<span id="cb14-101"><a href="#cb14-101"></a></span>
<span id="cb14-102"><a href="#cb14-102"></a><span class="fu">### Software</span></span>
<span id="cb14-103"><a href="#cb14-103"></a></span>
<span id="cb14-104"><a href="#cb14-104"></a>This tutorial was built with <span class="in">`Quarto`</span>, an open-source scientific and technical publishing system that integrates text, code, and code output into a single document. The source code to reproduce all results is included and accessible via the Quarto document's <span class="in">`code tool`</span> menu. All analyses were conducted in R (version 4.5.0, "How About a Twenty-Six") using <span class="in">`LightLogR`</span> (version&nbsp;0.10.0 "High noon"). We also used the <span class="in">`tidyverse`</span> suite (version&nbsp;2.0.0) for data manipulation (which LightLogR follows in its design), and the <span class="in">`gt`</span> package (version&nbsp;1.1.0) for generating summary tables. A comprehensive overview of the R computing environment is provided in the session info (see <span class="co">[</span><span class="ot">Session info</span><span class="co">](#sessioninfo)</span> section).</span>
<span id="cb14-105"><a href="#cb14-105"></a></span>
<span id="cb14-106"><a href="#cb14-106"></a><span class="fu">### Metric selection and definitions</span></span>
<span id="cb14-107"><a href="#cb14-107"></a></span>
<span id="cb14-108"><a href="#cb14-108"></a>In March 2025, two workshops with myopia researchers — initiated by the Research Data Alliance (RDA) Working Group on Optical Radiation Exposure and Visual Experience Data — focused on current needs and future opportunities in data analysis, including the development and standardization of metrics. Based on expert input from these workshops, the authors of this tutorial compiled a list of visual experience metrics, shown in @tbl-one. These include many currently used metrics and definitions <span class="co">[</span><span class="ot">@Wen2020bjophthalmol; @Wen2019TransVisSciTech; @Bhandari2020OphthalmicPhysiolOpt; @Williams2019Scientificreports</span><span class="co">]</span>, as well as new metrics enabled by spectrally-resolved measurements. While they are not derived by a formal consensus process, they are expert-informed and used in current scientific research, and thus will serve as example-definitions for metrics and thresholds throughout this article.</span>
<span id="cb14-109"><a href="#cb14-109"></a></span>
<span id="cb14-110"><a href="#cb14-110"></a>{{&lt; include _Table1.qmd &gt;}}</span>
<span id="cb14-111"><a href="#cb14-111"></a></span>
<span id="cb14-112"><a href="#cb14-112"></a>@tbl-two provides definitions for the terms used in @tbl-one. Note that specific definitions may vary depending on the research question or device capabilities.</span>
<span id="cb14-113"><a href="#cb14-113"></a></span>
<span id="cb14-114"><a href="#cb14-114"></a>{{&lt; include _Table2.qmd &gt;}}</span>
<span id="cb14-115"><a href="#cb14-115"></a></span>
<span id="cb14-116"><a href="#cb14-116"></a>It should be noted that although daylight levels can far exceed the thresholds defined in @tbl-two - and may reach or even exceed 10^5 lux - empirical daylight levels measured at eye level are much lower, typically around 10^3 lux, especially when considering aggregated time-series data over minutes to hours.</span>
<span id="cb14-117"><a href="#cb14-117"></a></span>
<span id="cb14-118"><a href="#cb14-118"></a><span class="fu">### Devices</span></span>
<span id="cb14-119"><a href="#cb14-119"></a></span>
<span id="cb14-120"><a href="#cb14-120"></a>Data from two wearable devices are used in this analysis:</span>
<span id="cb14-121"><a href="#cb14-121"></a></span>
<span id="cb14-122"><a href="#cb14-122"></a><span class="ss">-   </span><span class="in">`Clouclip`</span>: A wearable device that measures viewing distance and ambient light simultaneously <span class="co">[</span><span class="ot">Glasson Technology Co., Ltd, Hangzhou, China; @Wen2021ActaOphtalmol; @Wen2020bjophthalmol</span><span class="co">]</span>. The Clouclip provides a simple data output with only distance (working distance, in centimeters) and illuminance (ambient light, in lux). Data in our example were recorded at 5-second intervals. Approximately one week of data (\~120,960 observations) is about 1.6&nbsp;MB in size.</span>
<span id="cb14-123"><a href="#cb14-123"></a></span>
<span id="cb14-124"><a href="#cb14-124"></a><span class="ss">-   </span><span class="in">`Visual Environment Evaluation Tool`</span> (VEET): A head-mounted multi-modal device that logs multiple data streams <span class="co">[</span><span class="ot">Reality Labs Research, Menlo Park, CA, USA; @Sah2025OphtalmicPhysiolOpt; @Sullivan2024</span><span class="co">]</span>. The VEET dataset used here contains simultaneous measurements of distance (via a time-of-flight sensor), ambient light (illuminance), activity (accelerometer &amp; gyroscope), and spectral irradiance (multi-channel light sensor). Data were recorded at 2-second intervals, yielding a very dense dataset (\~270&nbsp;MB per week).</span>
<span id="cb14-125"><a href="#cb14-125"></a></span>
<span id="cb14-126"><a href="#cb14-126"></a><span class="fu">### Data processing summary</span></span>
<span id="cb14-127"><a href="#cb14-127"></a></span>
<span id="cb14-128"><a href="#cb14-128"></a>The <span class="co">[</span><span class="ot">Results</span><span class="co">](#results)</span> section uses imported and pre-processed data from the two devices to calculate metrics. <span class="co">[</span><span class="ot">Supplement&nbsp;1</span><span class="co">](supplement.qmd)</span> contains the annotated code and description for the steps involved. The following summarizes the steps involved, please refer to the supplement for details:</span>
<span id="cb14-129"><a href="#cb14-129"></a></span>
<span id="cb14-130"><a href="#cb14-130"></a>**Data import:** We imported raw data from the <span class="in">`Clouclip`</span> and <span class="in">`VEET`</span> devices using LightLogR’s built-in import functions, which automatically handle device-specific formats and idiosyncrasies. </span>
<span id="cb14-131"><a href="#cb14-131"></a></span>
<span id="cb14-132"><a href="#cb14-132"></a>The <span class="in">`Clouclip`</span> export file (provided as a tab-delimited text file) contains timestamped records of distance (cm) and illuminance (lux). LightLogR’s <span class="in">`import$Clouclip`</span> function reads this file, after specifying the device’s recording timezone, and converts device-specific sentinel codes into proper missing values. For instance, the Clouclip uses special numeric codes to indicate when it is in “sleep mode” or when a reading is out of the sensor’s range, rather than recording a normal value. LightLogR identifies <span class="in">`-1`</span> (for both distance and lux) as indicating the device’s sleep mode and <span class="in">`204`</span> (for distance) as indicating the object was beyond the measurable range, replacing these with <span class="in">`NA`</span> and logging their status in separate columns. The import routine also provides an initial summary of the dataset, including start and end times and any irregular sampling intervals or gaps.</span>
<span id="cb14-133"><a href="#cb14-133"></a></span>
<span id="cb14-134"><a href="#cb14-134"></a>For the <span class="in">`VEET`</span> device, data were provided as CSV logs (zipped on Github, due to size). We focused on the ambient light sensor modality first. Using <span class="in">`import$VEET(..., modality = "ALS")`</span>, we extracted the illuminance (<span class="in">`Lux`</span>) data stream and its timestamps. The raw VEET data similarly contains irregular intervals and can contain missing periods (e.g., if the device stopped recording or was reset); the import summary flags these issues.</span>
<span id="cb14-135"><a href="#cb14-135"></a></span>
<span id="cb14-136"><a href="#cb14-136"></a>Besides the <span class="in">`Clouclip`</span> and <span class="in">`VEET`</span>, LightLogR 0.10.0 contains import functions for 18 more wearable devices. The package further supports versions due to evolving data formats, and includes documentation for both <span class="co">[</span><span class="ot">code-based</span><span class="co">](https://tscnlab.github.io/LightLogR/reference/import_adjustment.html)</span> and <span class="co">[</span><span class="ot">code-less</span><span class="co">](https://tscnlab.github.io/LightLogR/articles/Import.html#from-which-devices-can-i-import-data)</span> additions of new device import-functions.</span>
<span id="cb14-137"><a href="#cb14-137"></a></span>
<span id="cb14-138"><a href="#cb14-138"></a>**Irregular intervals, gaps, non-wear times:** Both datasets showed irregular timing and missing data, i.e., gaps. Irregular data means that some observations did not align to the nominal sampling interval (e.g., slight timing drift or pauses in recording). For the <span class="in">`Clouclip`</span> 5-second data, we detected irregular timestamps spanning all but the first and last day of the recording. Handling such irregularities is important because many downstream analyses assume a regular time series. We evaluated strategies to address this, including:</span>
<span id="cb14-139"><a href="#cb14-139"></a></span>
<span id="cb14-140"><a href="#cb14-140"></a><span class="ss">-   </span>Removing an initial portion of data if irregularities occur mainly during device start-up.</span>
<span id="cb14-141"><a href="#cb14-141"></a></span>
<span id="cb14-142"><a href="#cb14-142"></a><span class="ss">-   </span>Rounding all timestamps to the nearest regular interval (5&nbsp;s in this case).</span>
<span id="cb14-143"><a href="#cb14-143"></a></span>
<span id="cb14-144"><a href="#cb14-144"></a><span class="ss">-   </span>Aggregating to a coarser time interval (with some loss of temporal resolution).</span>
<span id="cb14-145"><a href="#cb14-145"></a></span>
<span id="cb14-146"><a href="#cb14-146"></a>Based on the import summary and visual inspection of the time gaps, we chose to round the observation times to the nearest 5-second mark, as this addressed the minor offsets without significant data loss. After rounding timestamps, we added an explicit date column for convenient grouping by day.</span>
<span id="cb14-147"><a href="#cb14-147"></a></span>
<span id="cb14-148"><a href="#cb14-148"></a>We then generated a summary of missing data for each day. Implicit gaps (intervals where the device should have recorded data but did not) were converted into explicit missing entries using LightLogR’s gap-handling functions. We also removed days that had very little data to focus on days with substantial wear time. In our <span class="in">`Clouclip`</span> example, days with <span class="sc">\&lt;</span>1&nbsp;hour of recordings were dropped. This threshold should be adjusted based on how much complete days matter for a given analysis at hand. E.g., in circadian science, the metrics of *interdaily stability* and *intradaily variation* require measurements for each hour of the day.</span>
<span id="cb14-149"><a href="#cb14-149"></a></span>
<span id="cb14-150"><a href="#cb14-150"></a>After these preprocessing steps, the <span class="in">`Clouclip`</span> dataset had no irregular timestamps remaining and contained explicit markers for all periods of missing data (e.g., times when the device was off or not worn). The distance and illuminance values were now ready for metric calculations. Because the device was put in <span class="in">`sleep mode`</span> when not worn, there are no measurements during non-wear times. </span>
<span id="cb14-151"><a href="#cb14-151"></a></span>
<span id="cb14-152"><a href="#cb14-152"></a>The <span class="in">`VEET`</span> illuminance data underwent a similar cleaning procedure. To make the <span class="in">`VEET`</span>’s 2-second illuminance data more comparable to the <span class="in">`Clouclip`</span>’s and to reduce computational load, we aggregated the illuminance time series to 5-second intervals. Aggregation was performed with the arithmetic mean of values in a 5-second bin. We then inserted explicit missing entries for each whole day and removed days with more than one hour of missing illuminance data. After cleaning, six days of <span class="in">`VEET`</span> illuminance data with good coverage remained for analysis (see <span class="co">[</span><span class="ot">Supplement 1</span><span class="co">](supplement.qmd)</span> for details).</span>
<span id="cb14-153"><a href="#cb14-153"></a></span>
<span id="cb14-154"><a href="#cb14-154"></a>Finally, for spectral analysis, we imported the <span class="in">`VEET`</span>’s spectral sensor modality, and, for the distance analysis, the time-of-flight modality. This required additional processing: the raw spectral data consists of counts from 10 wavelength-specific channels (approximately 415&nbsp;nm through 940&nbsp;nm, unequally spaced between 30 and 50 nm, plus one broadband clear channel covering the whole range of individual channels and a dark channel) along with a sensor gain setting. We aggregated the spectral data to 5-minute intervals to focus on broader trends and reduce data volume. Each channel’s counts were normalized by the appropriate gain. Using a calibration matrix provided by the manufacturer (specific to the spectral sensor model), we reconstructed full spectral power distributions for each 5-minute interval. The end result is a list-column in the dataset where each entry is the estimated spectral irradiance across wavelengths for that time interval. Detailed spectral preprocessing steps, including the calibration and normalization, are provided in the <span class="co">[</span><span class="ot">Supplement 1</span><span class="co">](supplement.qmd)</span>. After spectral reconstruction, the dataset was ready for calculating example spectrum-based metrics.</span>
<span id="cb14-155"><a href="#cb14-155"></a></span>
<span id="cb14-156"><a href="#cb14-156"></a>Similarly, the time-of-flight modality contains 256 values per observation, encoding an 8x8 grid of distance and confidence measurements for up to two objects (8x8 grid, times two objects, times distance + confidence column for each object and grid point -&gt; 256 values). For computational reasons, only the first object was kept. These data were pivoted into a long format, where each row contains the distance and confidence data for a given position in the grid and a given datetime. After pivoting and converting grid positions into a deviation angle from central view, the dataset was ready to be used for distance analysis.</span>
<span id="cb14-157"><a href="#cb14-157"></a></span>
<span id="cb14-158"><a href="#cb14-158"></a>Because the <span class="in">`VEET`</span> devices record even when not worn, a non-wear detection using the devices' actigraphy modality was implemented. This process used the standard deviation of a linear motion sensor in a 5-minute bin with a visually derived threshold to separate wear from non-wear time. Measurements of illuminance and distance were consequently removed during the calculated non-wear times.</span>
<span id="cb14-159"><a href="#cb14-159"></a></span>
<span id="cb14-160"><a href="#cb14-160"></a>This tutorial will start by importing a <span class="in">`Clouclip`</span> dataset and providing an overview of the data. The <span class="in">`Clouclip`</span> export is considerably simpler compared to the <span class="in">`VEET`</span> export, only containing <span class="in">`Distance`</span> and <span class="in">`Illuminance`</span> measurements. The <span class="in">`VEET`</span> dataset will be imported later for the spectrum related metrics.</span>
<span id="cb14-161"><a href="#cb14-161"></a></span>
<span id="cb14-164"><a href="#cb14-164"></a><span class="in">```{r}</span></span>
<span id="cb14-165"><a href="#cb14-165"></a><span class="co">#| label: setup</span></span>
<span id="cb14-166"><a href="#cb14-166"></a><span class="co">#| output: false</span></span>
<span id="cb14-167"><a href="#cb14-167"></a><span class="co">#| filename: Load libraries and preprocessed data</span></span>
<span id="cb14-168"><a href="#cb14-168"></a><span class="fu">library</span>(LightLogR)</span>
<span id="cb14-169"><a href="#cb14-169"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb14-170"><a href="#cb14-170"></a><span class="fu">library</span>(gt)</span>
<span id="cb14-171"><a href="#cb14-171"></a><span class="fu">load</span>(<span class="st">"data/cleaned/data.RData"</span>)</span>
<span id="cb14-172"><a href="#cb14-172"></a><span class="in">```</span></span>
<span id="cb14-173"><a href="#cb14-173"></a></span>
<span id="cb14-176"><a href="#cb14-176"></a><span class="in">```{r}</span></span>
<span id="cb14-177"><a href="#cb14-177"></a><span class="co">#| filename: Store coordinates of data collection</span></span>
<span id="cb14-178"><a href="#cb14-178"></a>coordinates <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">29.75</span>, <span class="sc">-</span><span class="fl">95.36</span>) <span class="co">#&lt;1&gt; </span></span>
<span id="cb14-179"><a href="#cb14-179"></a><span class="in">```</span></span>
<span id="cb14-180"><a href="#cb14-180"></a></span>
<span id="cb14-181"><a href="#cb14-181"></a><span class="ss">1. </span>Coordinates for Houston, Texas; coordinates are important to calculate and visualize photoperiods later</span>
<span id="cb14-182"><a href="#cb14-182"></a></span>
<span id="cb14-183"><a href="#cb14-183"></a><span class="fu">## Results {#results}</span></span>
<span id="cb14-184"><a href="#cb14-184"></a></span>
<span id="cb14-185"><a href="#cb14-185"></a><span class="fu">### Distance</span></span>
<span id="cb14-186"><a href="#cb14-186"></a></span>
<span id="cb14-187"><a href="#cb14-187"></a>We first examine metrics related to viewing distance, using the processed <span class="in">`Clouclip`</span> dataset. Many distance-based metrics are computed for each day and then averaged over weekdays, weekends, or across all days. To facilitate this, we define a helper function that will take daily metric values and calculate the mean values for weekdays, weekends, and the overall daily average:</span>
<span id="cb14-188"><a href="#cb14-188"></a></span>
<span id="cb14-191"><a href="#cb14-191"></a><span class="in">```{r}</span></span>
<span id="cb14-192"><a href="#cb14-192"></a><span class="co">#| filename: Define helper function to_mean_daily()</span></span>
<span id="cb14-193"><a href="#cb14-193"></a>to_mean_daily <span class="ot">&lt;-</span> <span class="cf">function</span>(data, <span class="at">prefix =</span> <span class="st">"average_"</span>) {</span>
<span id="cb14-194"><a href="#cb14-194"></a>  data <span class="sc">|&gt;</span> </span>
<span id="cb14-195"><a href="#cb14-195"></a>    <span class="fu">ungroup</span>(Date) <span class="sc">|&gt;</span>  <span class="co">#&lt;1&gt;      </span></span>
<span id="cb14-196"><a href="#cb14-196"></a>    <span class="fu">mean_daily</span>(<span class="at">prefix =</span> prefix) <span class="sc">|&gt;</span>   <span class="co"># &lt;2&gt;</span></span>
<span id="cb14-197"><a href="#cb14-197"></a>    <span class="fu">rename_with</span>(<span class="at">.fn =</span> \(x) <span class="fu">str_replace_all</span>(x,<span class="st">"_"</span>,<span class="st">" "</span>)) <span class="sc">|&gt;</span>  <span class="co"># &lt;3&gt;</span></span>
<span id="cb14-198"><a href="#cb14-198"></a>    <span class="fu">gt</span>()               <span class="co"># &lt;4&gt;</span></span>
<span id="cb14-199"><a href="#cb14-199"></a>}</span>
<span id="cb14-200"><a href="#cb14-200"></a></span>
<span id="cb14-201"><a href="#cb14-201"></a><span class="in">```</span></span>
<span id="cb14-202"><a href="#cb14-202"></a></span>
<span id="cb14-203"><a href="#cb14-203"></a><span class="ss">1. </span>Ungroup by days</span>
<span id="cb14-204"><a href="#cb14-204"></a><span class="ss">2. </span>Calculate the averages per grouping</span>
<span id="cb14-205"><a href="#cb14-205"></a><span class="ss">3. </span>Remove underscores in names</span>
<span id="cb14-206"><a href="#cb14-206"></a><span class="ss">4. </span>Format as a gt table for display</span>
<span id="cb14-207"><a href="#cb14-207"></a></span>
<span id="cb14-208"><a href="#cb14-208"></a><span class="fu">#### Total wear time daily</span></span>
<span id="cb14-209"><a href="#cb14-209"></a></span>
<span id="cb14-210"><a href="#cb14-210"></a>*Total wear time daily*&nbsp;refers to the amount of time the device was actively collecting distance data each day (i.e. the time the device was worn and operational). We compute this by summing all intervals where a valid distance measurement is present, ignoring periods where data are missing or the device was off. The results are shown in @tbl-wear.</span>
<span id="cb14-211"><a href="#cb14-211"></a></span>
<span id="cb14-214"><a href="#cb14-214"></a><span class="in">```{r}</span></span>
<span id="cb14-215"><a href="#cb14-215"></a><span class="co">#| filename: Calculate total wear time</span></span>
<span id="cb14-216"><a href="#cb14-216"></a><span class="co">#| label: tbl-wear</span></span>
<span id="cb14-217"><a href="#cb14-217"></a><span class="co">#| tbl-cap: "Total wear time per day (average across days)"</span></span>
<span id="cb14-218"><a href="#cb14-218"></a>dataCC <span class="sc">|&gt;</span> </span>
<span id="cb14-219"><a href="#cb14-219"></a>  <span class="fu">durations</span>(Dis) <span class="sc">|&gt;</span> <span class="co">#&lt;1&gt;</span></span>
<span id="cb14-220"><a href="#cb14-220"></a>  <span class="fu">to_mean_daily</span>(<span class="st">"Total wear "</span>) <span class="co">#&lt;2&gt;</span></span>
<span id="cb14-221"><a href="#cb14-221"></a><span class="in">```</span></span>
<span id="cb14-222"><a href="#cb14-222"></a></span>
<span id="cb14-223"><a href="#cb14-223"></a><span class="ss">1. </span>Calculate total duration of data per day</span>
<span id="cb14-224"><a href="#cb14-224"></a><span class="ss">2. </span>Using the helper function defined above</span>
<span id="cb14-225"><a href="#cb14-225"></a></span>
<span id="cb14-226"><a href="#cb14-226"></a><span class="fu">#### Duration within distance ranges {#distance-range}</span></span>
<span id="cb14-227"><a href="#cb14-227"></a></span>
<span id="cb14-228"><a href="#cb14-228"></a>Many myopia-relevant metrics concern the time spent at certain viewing distances (e.g., “near work” vs. intermediate or far distances). We calculate the duration of time spent in specific distance ranges. @tbl-nearwork shows the average daily *duration of near work*, defined here as time viewing at 15–60&nbsp;cm. @tbl-ranges provides a more detailed breakdown across multiple distance bands.</span>
<span id="cb14-229"><a href="#cb14-229"></a></span>
<span id="cb14-230"><a href="#cb14-230"></a>::: panel-tabset</span>
<span id="cb14-231"><a href="#cb14-231"></a><span class="fu">##### Duration of near work</span></span>
<span id="cb14-232"><a href="#cb14-232"></a></span>
<span id="cb14-235"><a href="#cb14-235"></a><span class="in">```{r}</span></span>
<span id="cb14-236"><a href="#cb14-236"></a><span class="co">#| label: tbl-nearwork</span></span>
<span id="cb14-237"><a href="#cb14-237"></a><span class="co">#| filename: Calculate daily duration of near work</span></span>
<span id="cb14-238"><a href="#cb14-238"></a><span class="co">#| tbl-cap: "Daily duration of near work (15–60&nbsp;cm viewing distance)"</span></span>
<span id="cb14-239"><a href="#cb14-239"></a>dataCC <span class="sc">|&gt;</span> </span>
<span id="cb14-240"><a href="#cb14-240"></a>  <span class="fu">filter</span>(Dis <span class="sc">&gt;=</span> <span class="dv">15</span>, Dis <span class="sc">&lt;</span> <span class="dv">60</span>) <span class="sc">|&gt;</span>   <span class="co"># &lt;1&gt;</span></span>
<span id="cb14-241"><a href="#cb14-241"></a>  <span class="fu">durations</span>(Dis) <span class="sc">|&gt;</span>                <span class="co"># &lt;2&gt;</span></span>
<span id="cb14-242"><a href="#cb14-242"></a>  <span class="fu">to_mean_daily</span>(<span class="st">"Near work "</span>)</span>
<span id="cb14-243"><a href="#cb14-243"></a><span class="in">```</span></span>
<span id="cb14-244"><a href="#cb14-244"></a></span>
<span id="cb14-245"><a href="#cb14-245"></a><span class="ss">1. </span>Consider only distances in [15, 60) cm</span>
<span id="cb14-246"><a href="#cb14-246"></a><span class="ss">2. </span>Total duration in that range per day</span>
<span id="cb14-247"><a href="#cb14-247"></a></span>
<span id="cb14-248"><a href="#cb14-248"></a><span class="fu">##### Duration within distance ranges</span></span>
<span id="cb14-249"><a href="#cb14-249"></a></span>
<span id="cb14-250"><a href="#cb14-250"></a>First, we define a set of distance breakpoints and descriptive labels for each range:</span>
<span id="cb14-251"><a href="#cb14-251"></a></span>
<span id="cb14-254"><a href="#cb14-254"></a><span class="in">```{r}</span></span>
<span id="cb14-255"><a href="#cb14-255"></a><span class="co">#| filename: Defining distance ranges (in cm)</span></span>
<span id="cb14-256"><a href="#cb14-256"></a>dist_breaks <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">15</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">40</span>, <span class="dv">50</span>, <span class="dv">60</span>, <span class="dv">70</span>, <span class="dv">80</span>, <span class="dv">90</span>, <span class="dv">100</span>, <span class="cn">Inf</span>)</span>
<span id="cb14-257"><a href="#cb14-257"></a>dist_labels <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb14-258"><a href="#cb14-258"></a>    <span class="st">"Extremely near"</span>,          <span class="co"># [15, 20)</span></span>
<span id="cb14-259"><a href="#cb14-259"></a>    <span class="st">"Very near"</span>,               <span class="co"># [20, 30)</span></span>
<span id="cb14-260"><a href="#cb14-260"></a>    <span class="st">"Fairly near"</span>,             <span class="co"># [30, 40)</span></span>
<span id="cb14-261"><a href="#cb14-261"></a>    <span class="st">"Near"</span>,                    <span class="co"># [40, 50)</span></span>
<span id="cb14-262"><a href="#cb14-262"></a>    <span class="st">"Moderately near"</span>,         <span class="co"># [50, 60)</span></span>
<span id="cb14-263"><a href="#cb14-263"></a>    <span class="st">"Near intermediate"</span>,       <span class="co"># [60, 70)</span></span>
<span id="cb14-264"><a href="#cb14-264"></a>    <span class="st">"Intermediate"</span>,            <span class="co"># [70, 80)</span></span>
<span id="cb14-265"><a href="#cb14-265"></a>    <span class="st">"Moderately intermediate"</span>, <span class="co"># [80, 90)</span></span>
<span id="cb14-266"><a href="#cb14-266"></a>    <span class="st">"Far intermediate"</span>,        <span class="co"># [90, 100)</span></span>
<span id="cb14-267"><a href="#cb14-267"></a>    <span class="st">"Far"</span>                      <span class="co"># [100, Inf)</span></span>
<span id="cb14-268"><a href="#cb14-268"></a>  )</span>
<span id="cb14-269"><a href="#cb14-269"></a><span class="in">```</span></span>
<span id="cb14-270"><a href="#cb14-270"></a></span>
<span id="cb14-271"><a href="#cb14-271"></a>Now we cut the distance data into these ranges and compute the daily duration spent in each range:</span>
<span id="cb14-272"><a href="#cb14-272"></a></span>
<span id="cb14-275"><a href="#cb14-275"></a><span class="in">```{r}</span></span>
<span id="cb14-276"><a href="#cb14-276"></a><span class="co">#| label: tbl-ranges</span></span>
<span id="cb14-277"><a href="#cb14-277"></a><span class="co">#| filename: Calculate daily duration within viewing distance range</span></span>
<span id="cb14-278"><a href="#cb14-278"></a><span class="co">#| tbl-cap: "Daily duration in each viewing distance range"</span></span>
<span id="cb14-279"><a href="#cb14-279"></a>dataCC <span class="sc">|&gt;</span> </span>
<span id="cb14-280"><a href="#cb14-280"></a>  <span class="fu">mutate</span>(<span class="at">Dis_range =</span> <span class="fu">cut</span>(Dis, <span class="at">breaks =</span> dist_breaks, <span class="at">labels =</span> dist_labels)) <span class="sc">|&gt;</span>  <span class="co">#&lt;1&gt;</span></span>
<span id="cb14-281"><a href="#cb14-281"></a>  <span class="fu">drop_na</span>(Dis_range) <span class="sc">|&gt;</span>           <span class="co">#&lt;2&gt;</span></span>
<span id="cb14-282"><a href="#cb14-282"></a>  <span class="fu">group_by</span>(Dis_range, <span class="at">.add =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span>  <span class="co"># &lt;3&gt;</span></span>
<span id="cb14-283"><a href="#cb14-283"></a>  <span class="fu">durations</span>(Dis) <span class="sc">|&gt;</span>               <span class="co"># &lt;4&gt;</span></span>
<span id="cb14-284"><a href="#cb14-284"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> Dis_range, <span class="at">values_from =</span> duration) <span class="sc">|&gt;</span>  <span class="co"># &lt;5&gt;</span></span>
<span id="cb14-285"><a href="#cb14-285"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span> </span>
<span id="cb14-286"><a href="#cb14-286"></a>  <span class="fu">mean_daily</span>(<span class="at">prefix =</span> <span class="st">""</span>) <span class="sc">|&gt;</span> </span>
<span id="cb14-287"><a href="#cb14-287"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>Date) <span class="sc">|&gt;</span> </span>
<span id="cb14-288"><a href="#cb14-288"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> Date) <span class="sc">|&gt;</span> </span>
<span id="cb14-289"><a href="#cb14-289"></a>  <span class="fu">mutate</span>(<span class="at">name =</span> <span class="fu">factor</span>(name, <span class="at">levels =</span> <span class="fu">rev</span>(dist_labels))) <span class="sc">|&gt;</span> </span>
<span id="cb14-290"><a href="#cb14-290"></a>  <span class="fu">arrange</span>(name) <span class="sc">|&gt;</span> </span>
<span id="cb14-291"><a href="#cb14-291"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span> </span>
<span id="cb14-292"><a href="#cb14-292"></a>  <span class="fu">fmt_duration</span>(<span class="at">input_units =</span> <span class="st">"seconds"</span>, <span class="at">output_units =</span> <span class="st">"minutes"</span>)  <span class="co"># &lt;6&gt;</span></span>
<span id="cb14-293"><a href="#cb14-293"></a><span class="in">```</span></span>
<span id="cb14-294"><a href="#cb14-294"></a></span>
<span id="cb14-295"><a href="#cb14-295"></a><span class="ss">1. </span>Categorize distances</span>
<span id="cb14-296"><a href="#cb14-296"></a><span class="ss">2. </span>Remove intervals with no data</span>
<span id="cb14-297"><a href="#cb14-297"></a><span class="ss">3. </span>Group by distance range (in addition to the date)</span>
<span id="cb14-298"><a href="#cb14-298"></a><span class="ss">4. </span>Duration per range per day</span>
<span id="cb14-299"><a href="#cb14-299"></a><span class="ss">5. </span>Pivot data from long to wide format (ranges as columns)</span>
<span id="cb14-300"><a href="#cb14-300"></a><span class="ss">6. </span>Convert seconds to minutes</span>
<span id="cb14-301"><a href="#cb14-301"></a></span>
<span id="cb14-302"><a href="#cb14-302"></a>To visualize this, @fig-ranges illustrates the relative proportion of time spent in each distance range:</span>
<span id="cb14-303"><a href="#cb14-303"></a></span>
<span id="cb14-306"><a href="#cb14-306"></a><span class="in">```{r}</span></span>
<span id="cb14-307"><a href="#cb14-307"></a><span class="co">#| label: fig-ranges</span></span>
<span id="cb14-308"><a href="#cb14-308"></a><span class="co">#| filename: Plot time spent within each viewing distance range</span></span>
<span id="cb14-309"><a href="#cb14-309"></a><span class="co">#| fig-cap: "Percentage of total time spent in each viewing distance range for an average day (mean daily), average weekday, or weekend"</span></span>
<span id="cb14-310"><a href="#cb14-310"></a>dataCC <span class="sc">|&gt;</span> </span>
<span id="cb14-311"><a href="#cb14-311"></a>  <span class="fu">mutate</span>(<span class="at">Dis_range =</span> <span class="fu">cut</span>(Dis, <span class="at">breaks =</span> dist_breaks, <span class="at">labels =</span> dist_labels)) <span class="sc">|&gt;</span> <span class="co">#&lt;1&gt;</span></span>
<span id="cb14-312"><a href="#cb14-312"></a>  <span class="fu">drop_na</span>(Dis_range) <span class="sc">|&gt;</span> <span class="co">#&lt;1&gt;</span></span>
<span id="cb14-313"><a href="#cb14-313"></a>  <span class="fu">group_by</span>(Dis_range, <span class="at">.add =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> <span class="co">#&lt;1&gt;</span></span>
<span id="cb14-314"><a href="#cb14-314"></a>  <span class="fu">durations</span>(Dis) <span class="sc">|&gt;</span> <span class="co">#&lt;1&gt;</span></span>
<span id="cb14-315"><a href="#cb14-315"></a>  <span class="fu">group_by</span>(Dis_range) <span class="sc">|&gt;</span> <span class="co">#&lt;1&gt;</span></span>
<span id="cb14-316"><a href="#cb14-316"></a>  <span class="fu">mean_daily</span>(<span class="at">prefix =</span> <span class="st">""</span>) <span class="sc">|&gt;</span> <span class="co">#&lt;1&gt;</span></span>
<span id="cb14-317"><a href="#cb14-317"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span> <span class="co">#&lt;1&gt;</span></span>
<span id="cb14-318"><a href="#cb14-318"></a>  <span class="fu">mutate</span>(<span class="at">Dis_range =</span> forcats<span class="sc">::</span><span class="fu">fct_relabel</span>(Dis_range, \(x) <span class="fu">str_replace</span>(x, <span class="st">" "</span>, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>))) <span class="sc">|&gt;</span> </span>
<span id="cb14-319"><a href="#cb14-319"></a>  <span class="fu">mutate</span>(<span class="at">duration =</span> duration<span class="sc">/</span><span class="fu">sum</span>(duration), <span class="at">.by =</span> Date) <span class="sc">|&gt;</span>    <span class="co">#&lt;2&gt;</span></span>
<span id="cb14-320"><a href="#cb14-320"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Dis_range, <span class="at">y =</span> duration, <span class="at">fill =</span> Date)) <span class="sc">+</span></span>
<span id="cb14-321"><a href="#cb14-321"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb14-322"><a href="#cb14-322"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_percent</span>()) <span class="sc">+</span></span>
<span id="cb14-323"><a href="#cb14-323"></a>  ggsci<span class="sc">::</span><span class="fu">scale_fill_jco</span>() <span class="sc">+</span></span>
<span id="cb14-324"><a href="#cb14-324"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb14-325"><a href="#cb14-325"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Relative duration (%)"</span>, <span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">fill =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb14-326"><a href="#cb14-326"></a>  <span class="fu">coord_flip</span>()</span>
<span id="cb14-327"><a href="#cb14-327"></a><span class="fu">ggsave</span>(<span class="st">"manuscript/figures/Figure1.png"</span>,</span>
<span id="cb14-328"><a href="#cb14-328"></a>                <span class="at">width =</span> <span class="dv">7</span>,</span>
<span id="cb14-329"><a href="#cb14-329"></a>                <span class="at">height =</span> <span class="dv">5</span>)</span>
<span id="cb14-330"><a href="#cb14-330"></a><span class="in">```</span></span>
<span id="cb14-331"><a href="#cb14-331"></a></span>
<span id="cb14-332"><a href="#cb14-332"></a><span class="ss">1. </span>Broadly, this portion repeats the prior code cell</span>
<span id="cb14-333"><a href="#cb14-333"></a><span class="ss">2. </span>Convert to percentage of daily total</span>
<span id="cb14-334"><a href="#cb14-334"></a></span>
<span id="cb14-335"><a href="#cb14-335"></a>:::</span>
<span id="cb14-336"><a href="#cb14-336"></a></span>
<span id="cb14-337"><a href="#cb14-337"></a><span class="fu">#### Frequency of continuous near work</span></span>
<span id="cb14-338"><a href="#cb14-338"></a></span>
<span id="cb14-339"><a href="#cb14-339"></a>Continuous near-work can be understood as sustained viewing within a near distance for some minimum duration, allowing only brief interruptions. We use LightLogR’s <span class="in">`cluster`</span> function to identify episodes of continuous near work. Here, we define a near-work episode as viewing distance between 20&nbsp;cm and 60&nbsp;cm that lasts at least 30&nbsp;minutes, with interruptions of up to 1&nbsp;minute allowed (meaning short breaks ≤1&nbsp;min do not end the episode). Using <span class="co">[</span><span class="ot">extract_clusters()</span><span class="co">](https://tscnlab.github.io/LightLogR/reference/extract_clusters.html)</span> with those parameters, we count how many such episodes occur per day.</span>
<span id="cb14-340"><a href="#cb14-340"></a></span>
<span id="cb14-341"><a href="#cb14-341"></a>@tbl-continuousnear summarizes the average frequency of continuous near-work episodes per day, and @fig-visbreak provides an example visualization of these episodes on the distance time series.</span>
<span id="cb14-342"><a href="#cb14-342"></a></span>
<span id="cb14-345"><a href="#cb14-345"></a><span class="in">```{r}</span></span>
<span id="cb14-346"><a href="#cb14-346"></a><span class="co">#| label: tbl-continuousnear</span></span>
<span id="cb14-347"><a href="#cb14-347"></a><span class="co">#| filename: Calculate the frequency of continuous near-work episodes per day</span></span>
<span id="cb14-348"><a href="#cb14-348"></a><span class="co">#| tbl-cap: "Frequency of continuous near-work episodes per day"</span></span>
<span id="cb14-349"><a href="#cb14-349"></a>dataCC <span class="sc">|&gt;</span> </span>
<span id="cb14-350"><a href="#cb14-350"></a>  <span class="fu">extract_clusters</span>(</span>
<span id="cb14-351"><a href="#cb14-351"></a>    Dis <span class="sc">&gt;=</span> <span class="dv">20</span> <span class="sc">&amp;</span> Dis <span class="sc">&lt;</span> <span class="dv">60</span>,            <span class="co"># &lt;1&gt;</span></span>
<span id="cb14-352"><a href="#cb14-352"></a>    <span class="at">cluster.duration =</span> <span class="st">"30 mins"</span>,    <span class="co"># &lt;2&gt;</span></span>
<span id="cb14-353"><a href="#cb14-353"></a>    <span class="at">interruption.duration =</span> <span class="st">"1 min"</span>, <span class="co"># &lt;3&gt;</span></span>
<span id="cb14-354"><a href="#cb14-354"></a>    <span class="at">drop.empty.groups =</span> <span class="cn">FALSE</span>        <span class="co"># &lt;4&gt;</span></span>
<span id="cb14-355"><a href="#cb14-355"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb14-356"><a href="#cb14-356"></a>  <span class="fu">summarize_numeric</span>(<span class="at">remove =</span> <span class="fu">c</span>(<span class="st">"start"</span>, <span class="st">"end"</span>, <span class="st">"epoch"</span>, <span class="st">"duration"</span>),</span>
<span id="cb14-357"><a href="#cb14-357"></a>                    <span class="at">add.total.duration =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span>    <span class="co"># &lt;5&gt;</span></span>
<span id="cb14-358"><a href="#cb14-358"></a>  <span class="fu">mean_daily</span>(<span class="at">prefix =</span> <span class="st">"Frequency of "</span>) <span class="sc">|&gt;</span>             <span class="co"># &lt;6&gt;</span></span>
<span id="cb14-359"><a href="#cb14-359"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span> <span class="fu">fmt_number</span>() </span>
<span id="cb14-360"><a href="#cb14-360"></a><span class="in">```</span></span>
<span id="cb14-361"><a href="#cb14-361"></a></span>
<span id="cb14-362"><a href="#cb14-362"></a><span class="ss">1. </span>Condition: near-work distance</span>
<span id="cb14-363"><a href="#cb14-363"></a><span class="ss">2. </span>Minimum duration of a continuous episode</span>
<span id="cb14-364"><a href="#cb14-364"></a><span class="ss">3. </span>Maximum gap allowed within an episode</span>
<span id="cb14-365"><a href="#cb14-365"></a><span class="ss">4. </span>Keep days with zero episodes in output</span>
<span id="cb14-366"><a href="#cb14-366"></a><span class="ss">5. </span>Count number of episodes per day</span>
<span id="cb14-367"><a href="#cb14-367"></a><span class="ss">6. </span>Compute daily mean frequency</span>
<span id="cb14-368"><a href="#cb14-368"></a></span>
<span id="cb14-369"><a href="#cb14-369"></a></span>
<span id="cb14-372"><a href="#cb14-372"></a><span class="in">```{r}</span></span>
<span id="cb14-373"><a href="#cb14-373"></a><span class="co">#| label: fig-visbreak</span></span>
<span id="cb14-374"><a href="#cb14-374"></a><span class="co">#| filename: Plot continuous near-work episodes</span></span>
<span id="cb14-375"><a href="#cb14-375"></a><span class="co">#| fig-cap: "Example of continuous near-work episodes. Red shaded areas indicate periods of continuous near work (20–60&nbsp;cm for ≥30&nbsp;min, allowing ≤1&nbsp;min interruptions). Black trace is viewing distance over time; red dashed lines mark the 20&nbsp;cm and 60&nbsp;cm boundaries. Grey shaded areas indicate nighttime."</span></span>
<span id="cb14-376"><a href="#cb14-376"></a><span class="co">#| warning: false</span></span>
<span id="cb14-377"><a href="#cb14-377"></a><span class="co">#| fig-height: 8</span></span>
<span id="cb14-378"><a href="#cb14-378"></a>dataCC <span class="sc">|&gt;</span> <span class="co"># &lt;1&gt;</span></span>
<span id="cb14-379"><a href="#cb14-379"></a>  <span class="fu">add_clusters</span>(<span class="co"># &lt;1&gt;</span></span>
<span id="cb14-380"><a href="#cb14-380"></a>    Dis <span class="sc">&gt;=</span> <span class="dv">20</span> <span class="sc">&amp;</span> Dis <span class="sc">&lt;</span> <span class="dv">60</span>,<span class="co"># &lt;1&gt;</span></span>
<span id="cb14-381"><a href="#cb14-381"></a>    <span class="at">cluster.duration =</span> <span class="st">"30 mins"</span>,<span class="co"># &lt;1&gt;</span></span>
<span id="cb14-382"><a href="#cb14-382"></a>    <span class="at">interruption.duration =</span> <span class="st">"1 min"</span><span class="co"># &lt;1&gt;</span></span>
<span id="cb14-383"><a href="#cb14-383"></a>  ) <span class="sc">|&gt;</span> <span class="co"># &lt;1&gt;</span></span>
<span id="cb14-384"><a href="#cb14-384"></a>  <span class="fu">gg_day</span>(<span class="at">y.axis =</span> Dis, <span class="at">y.axis.label =</span> <span class="st">"Distance (cm)"</span>, <span class="at">geom =</span> <span class="st">"line"</span>,</span>
<span id="cb14-385"><a href="#cb14-385"></a>         <span class="at">y.scale =</span> <span class="st">"identity"</span>, <span class="at">y.axis.breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">100</span>, <span class="at">by =</span> <span class="dv">20</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb14-386"><a href="#cb14-386"></a>  <span class="fu">gg_photoperiod</span>(coordinates) <span class="sc">|&gt;</span><span class="co"># &lt;2&gt;</span></span>
<span id="cb14-387"><a href="#cb14-387"></a>  <span class="fu">gg_state</span>(state, <span class="at">fill =</span> <span class="st">"red"</span>) <span class="sc">+</span> <span class="co"># &lt;3&gt;</span></span>
<span id="cb14-388"><a href="#cb14-388"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">60</span>), <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb14-389"><a href="#cb14-389"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">100</span>))</span>
<span id="cb14-390"><a href="#cb14-390"></a><span class="in">```</span></span>
<span id="cb14-391"><a href="#cb14-391"></a></span>
<span id="cb14-392"><a href="#cb14-392"></a><span class="ss">1. </span>As in code cell above</span>
<span id="cb14-393"><a href="#cb14-393"></a><span class="ss">2. </span>Add photoperiod information</span>
<span id="cb14-394"><a href="#cb14-394"></a><span class="ss">2. </span>Add state bands</span>
<span id="cb14-395"><a href="#cb14-395"></a></span>
<span id="cb14-396"><a href="#cb14-396"></a></span>
<span id="cb14-399"><a href="#cb14-399"></a><span class="in">```{r}</span></span>
<span id="cb14-400"><a href="#cb14-400"></a><span class="co">#| echo: false</span></span>
<span id="cb14-401"><a href="#cb14-401"></a><span class="co">#| output: false</span></span>
<span id="cb14-402"><a href="#cb14-402"></a><span class="fu">ggsave</span>(<span class="st">"manuscript/figures/Figure2.png"</span>,</span>
<span id="cb14-403"><a href="#cb14-403"></a>                <span class="at">width =</span> <span class="dv">9</span>,</span>
<span id="cb14-404"><a href="#cb14-404"></a>                <span class="at">height =</span> <span class="dv">9</span>)</span>
<span id="cb14-405"><a href="#cb14-405"></a><span class="in">```</span></span>
<span id="cb14-406"><a href="#cb14-406"></a></span>
<span id="cb14-407"><a href="#cb14-407"></a><span class="fu">#### Near-work episodes</span></span>
<span id="cb14-408"><a href="#cb14-408"></a></span>
<span id="cb14-409"><a href="#cb14-409"></a>Beyond frequency, we can characterize near-work episodes by their duration and typical viewing distance. This section extracts all near-work episodes (using a 5-second minimum duration to capture more routine near-work bouts) and summarizes three aspects: </span>
<span id="cb14-410"><a href="#cb14-410"></a></span>
<span id="cb14-411"><a href="#cb14-411"></a><span class="ss">1. </span>frequency (count of episodes per day), </span>
<span id="cb14-412"><a href="#cb14-412"></a><span class="ss">2. </span>average duration of episodes, and </span>
<span id="cb14-413"><a href="#cb14-413"></a><span class="ss">3. </span>average distance during those episodes. </span>
<span id="cb14-414"><a href="#cb14-414"></a></span>
<span id="cb14-415"><a href="#cb14-415"></a>These results are combined in @tbl-nearworkepisodes.</span>
<span id="cb14-416"><a href="#cb14-416"></a></span>
<span id="cb14-419"><a href="#cb14-419"></a><span class="in">```{r}</span></span>
<span id="cb14-420"><a href="#cb14-420"></a><span class="co">#| label: tbl-nearworkepisodes</span></span>
<span id="cb14-421"><a href="#cb14-421"></a><span class="co">#| filename: Calculate near-work episodes</span></span>
<span id="cb14-422"><a href="#cb14-422"></a><span class="co">#| tbl-cap: "Near-work episodes: frequency, mean duration, and mean viewing distance"</span></span>
<span id="cb14-423"><a href="#cb14-423"></a>dataCC <span class="sc">|&gt;</span> </span>
<span id="cb14-424"><a href="#cb14-424"></a>  <span class="fu">extract_clusters</span>(</span>
<span id="cb14-425"><a href="#cb14-425"></a>    Dis <span class="sc">&gt;=</span> <span class="dv">20</span> <span class="sc">&amp;</span> Dis <span class="sc">&lt;</span> <span class="dv">60</span>,</span>
<span id="cb14-426"><a href="#cb14-426"></a>    <span class="at">cluster.duration =</span> <span class="st">"5 secs"</span>,    <span class="co"># &lt;1&gt;</span></span>
<span id="cb14-427"><a href="#cb14-427"></a>    <span class="at">interruption.duration =</span> <span class="st">"20 secs"</span>,</span>
<span id="cb14-428"><a href="#cb14-428"></a>    <span class="at">drop.empty.groups =</span> <span class="cn">FALSE</span></span>
<span id="cb14-429"><a href="#cb14-429"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb14-430"><a href="#cb14-430"></a>  <span class="fu">extract_metric</span>(dataCC, <span class="at">distance =</span> <span class="fu">mean</span>(Dis, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span>  <span class="co"># &lt;2&gt;</span></span>
<span id="cb14-431"><a href="#cb14-431"></a>  <span class="fu">summarize_numeric</span>(<span class="at">remove =</span> <span class="fu">c</span>(<span class="st">"start"</span>, <span class="st">"end"</span>, <span class="st">"epoch"</span>), <span class="co"># &lt;3&gt;</span></span>
<span id="cb14-432"><a href="#cb14-432"></a>                    <span class="at">prefix =</span> <span class="st">""</span>, <span class="co">#&lt;3&gt;</span></span>
<span id="cb14-433"><a href="#cb14-433"></a>                    <span class="at">add.total.duration =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span>  <span class="co">#&lt;3&gt;</span></span>
<span id="cb14-434"><a href="#cb14-434"></a>  <span class="fu">mean_daily</span>(<span class="at">prefix =</span> <span class="st">""</span>) <span class="sc">|&gt;</span>    <span class="co"># &lt;4&gt;</span></span>
<span id="cb14-435"><a href="#cb14-435"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span> <span class="co"># &lt;5&gt;</span></span>
<span id="cb14-436"><a href="#cb14-436"></a>  <span class="fu">fmt_number</span>(<span class="fu">c</span>(distance, episodes), <span class="at">decimals =</span> <span class="dv">0</span>) <span class="sc">|&gt;</span> <span class="co"># &lt;5&gt;</span></span>
<span id="cb14-437"><a href="#cb14-437"></a>  <span class="fu">cols_units</span>(<span class="at">distance =</span> <span class="st">"cm"</span>) <span class="co"># &lt;5&gt;</span></span>
<span id="cb14-438"><a href="#cb14-438"></a><span class="in">```</span></span>
<span id="cb14-439"><a href="#cb14-439"></a></span>
<span id="cb14-440"><a href="#cb14-440"></a><span class="ss">1. </span>Minimal duration to count as an episode (set to interval level of <span class="in">`dataCC`</span>)</span>
<span id="cb14-441"><a href="#cb14-441"></a><span class="ss">2. </span>Calculate mean distance during each episode</span>
<span id="cb14-442"><a href="#cb14-442"></a><span class="ss">3. </span>Calculate averages for all numeric columns per group</span>
<span id="cb14-443"><a href="#cb14-443"></a><span class="ss">4. </span>Daily averages for each metric</span>
<span id="cb14-444"><a href="#cb14-444"></a><span class="ss">5. </span>Table generation</span>
<span id="cb14-445"><a href="#cb14-445"></a></span>
<span id="cb14-446"><a href="#cb14-446"></a><span class="at">&gt; In the code cell above, </span><span class="in">`extract_metric(..., distance = mean(Dis, ...))`</span><span class="at"> computes the mean viewing distance during each episode, and the subsequent </span><span class="in">`summarize_numeric`</span><span class="at"> and </span><span class="in">`mean_daily`</span><span class="at"> steps derive daily averages of episode count, duration, and distance.</span></span>
<span id="cb14-447"><a href="#cb14-447"></a></span>
<span id="cb14-448"><a href="#cb14-448"></a><span class="fu">#### Visual breaks</span></span>
<span id="cb14-449"><a href="#cb14-449"></a></span>
<span id="cb14-450"><a href="#cb14-450"></a><span class="in">`Visual breaks`</span> as defined in this article, require a minimum break-length, and the previous episode is important. This leads to a two step process, where we first extract instances of <span class="in">`Distance`</span> above 100 cm for at least 20 seconds, before we filter for a previous duration of at maximum 20 minutes. @tbl-visualbreaks provides the daily frequency of visual breaks.</span>
<span id="cb14-451"><a href="#cb14-451"></a></span>
<span id="cb14-454"><a href="#cb14-454"></a><span class="in">```{r}</span></span>
<span id="cb14-455"><a href="#cb14-455"></a><span class="co">#| label: tbl-visualbreaks</span></span>
<span id="cb14-456"><a href="#cb14-456"></a><span class="co">#| filename: Calculate visual breaks</span></span>
<span id="cb14-457"><a href="#cb14-457"></a><span class="co">#| tbl-cap: "Frequency of visual breaks"</span></span>
<span id="cb14-458"><a href="#cb14-458"></a>dataCC <span class="sc">|&gt;</span> </span>
<span id="cb14-459"><a href="#cb14-459"></a>  <span class="fu">extract_clusters</span>(Dis <span class="sc">&gt;=</span> <span class="dv">100</span>, <span class="co"># &lt;1&gt;</span></span>
<span id="cb14-460"><a href="#cb14-460"></a>                   <span class="at">cluster.duration =</span> <span class="st">"20 secs"</span>, <span class="co">#&lt;2&gt;</span></span>
<span id="cb14-461"><a href="#cb14-461"></a>                   <span class="at">return.only.clusters =</span> <span class="cn">FALSE</span>, <span class="co">#&lt;3&gt;</span></span>
<span id="cb14-462"><a href="#cb14-462"></a>                   <span class="at">drop.empty.groups =</span> <span class="cn">FALSE</span> <span class="co"># &lt;4&gt;</span></span>
<span id="cb14-463"><a href="#cb14-463"></a>                   ) <span class="sc">|&gt;</span> </span>
<span id="cb14-464"><a href="#cb14-464"></a>  <span class="fu">filter</span>((start <span class="sc">-</span> <span class="fu">lag</span>(end) <span class="sc">&lt;=</span> <span class="fu">duration</span>(<span class="st">"20 mins"</span>)), is.cluster) <span class="sc">|&gt;</span> <span class="co">#&lt;5&gt;</span></span>
<span id="cb14-465"><a href="#cb14-465"></a>  <span class="fu">summarize_numeric</span>(<span class="at">remove =</span> <span class="fu">c</span>(<span class="st">"start"</span>, <span class="st">"end"</span>, <span class="st">"epoch"</span>, <span class="st">"is.cluster"</span>, <span class="st">"duration"</span>), <span class="co">#&lt;6&gt;</span></span>
<span id="cb14-466"><a href="#cb14-466"></a>                    <span class="at">prefix =</span> <span class="st">""</span>, <span class="co">#&lt;6&gt;</span></span>
<span id="cb14-467"><a href="#cb14-467"></a>                    <span class="at">add.total.duration =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span>  <span class="co">#&lt;6&gt;</span></span>
<span id="cb14-468"><a href="#cb14-468"></a>  <span class="fu">mean_daily</span>(<span class="at">prefix =</span> <span class="st">"Daily "</span>) <span class="sc">|&gt;</span> <span class="co"># &lt;7&gt;</span></span>
<span id="cb14-469"><a href="#cb14-469"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span> <span class="co">#&lt;8&gt;</span></span>
<span id="cb14-470"><a href="#cb14-470"></a>  <span class="fu">fmt_number</span>(<span class="at">decimals =</span> <span class="dv">1</span>) <span class="co">#&lt;8&gt;</span></span>
<span id="cb14-471"><a href="#cb14-471"></a><span class="in">```</span></span>
<span id="cb14-472"><a href="#cb14-472"></a></span>
<span id="cb14-473"><a href="#cb14-473"></a><span class="ss">1. </span>Define the condition, greater 100 cm away</span>
<span id="cb14-474"><a href="#cb14-474"></a><span class="ss">2. </span>Define the minimum duration</span>
<span id="cb14-475"><a href="#cb14-475"></a><span class="ss">3. </span>Return non-clusters as well</span>
<span id="cb14-476"><a href="#cb14-476"></a><span class="ss">4. </span>Keep all days, even without clusters</span>
<span id="cb14-477"><a href="#cb14-477"></a><span class="ss">5. </span>Return only clusters with previous episode lengths of maximum 20 minutes</span>
<span id="cb14-478"><a href="#cb14-478"></a><span class="ss">6. </span>Count the number of episodes</span>
<span id="cb14-479"><a href="#cb14-479"></a><span class="ss">7. </span>Calculate daily means</span>
<span id="cb14-480"><a href="#cb14-480"></a><span class="ss">8. </span>Table generation</span>
<span id="cb14-481"><a href="#cb14-481"></a></span>
<span id="cb14-484"><a href="#cb14-484"></a><span class="in">```{r}</span></span>
<span id="cb14-485"><a href="#cb14-485"></a><span class="co">#| label: fig-cluster</span></span>
<span id="cb14-486"><a href="#cb14-486"></a><span class="co">#| filename: Plot visual breaks</span></span>
<span id="cb14-487"><a href="#cb14-487"></a><span class="co">#| fig-cap: "Plot of visual breaks (red dots). Black traces show distance measurement data. Grey shaded areas show nighttime between civil dusk and civil dawn"</span></span>
<span id="cb14-488"><a href="#cb14-488"></a><span class="co">#| warning: false</span></span>
<span id="cb14-489"><a href="#cb14-489"></a><span class="co">#| fig-height: 8</span></span>
<span id="cb14-490"><a href="#cb14-490"></a>dataCC <span class="sc">|&gt;</span> <span class="co"># &lt;1&gt;</span></span>
<span id="cb14-491"><a href="#cb14-491"></a>    <span class="fu">extract_clusters</span>(Dis <span class="sc">&gt;=</span> <span class="dv">100</span>, <span class="co"># &lt;1&gt;</span></span>
<span id="cb14-492"><a href="#cb14-492"></a>                   <span class="at">cluster.duration =</span> <span class="st">"20 secs"</span>, <span class="co"># &lt;1&gt;</span></span>
<span id="cb14-493"><a href="#cb14-493"></a>                   <span class="at">return.only.clusters =</span> <span class="cn">FALSE</span>, <span class="co"># &lt;1&gt;</span></span>
<span id="cb14-494"><a href="#cb14-494"></a>                   <span class="at">drop.empty.groups =</span> <span class="cn">FALSE</span> <span class="co"># &lt;1&gt;</span></span>
<span id="cb14-495"><a href="#cb14-495"></a>                   ) <span class="sc">|&gt;</span> <span class="co"># &lt;1&gt;</span></span>
<span id="cb14-496"><a href="#cb14-496"></a>  <span class="fu">filter</span>((start <span class="sc">-</span> <span class="fu">lag</span>(end) <span class="sc">&lt;=</span> <span class="fu">duration</span>(<span class="st">"20 mins"</span>)), is.cluster) <span class="sc">%&gt;%</span> <span class="co"># &lt;1&gt;</span></span>
<span id="cb14-497"><a href="#cb14-497"></a>  <span class="fu">add_states</span>(dataCC, ., ) <span class="sc">|&gt;</span>  <span class="co"># &lt;2&gt;</span></span>
<span id="cb14-498"><a href="#cb14-498"></a>  <span class="fu">gg_day</span>(<span class="at">y.axis =</span> Dis, <span class="at">y.axis.label =</span> <span class="st">"Distance (cm)"</span>, <span class="at">geom =</span> <span class="st">"line"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb14-499"><a href="#cb14-499"></a>  <span class="fu">gg_photoperiod</span>(coordinates) <span class="sc">+</span> <span class="co"># &lt;3&gt;</span></span>
<span id="cb14-500"><a href="#cb14-500"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> \(x) <span class="fu">filter</span>(x, is.cluster), <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb14-501"><a href="#cb14-501"></a><span class="in">```</span></span>
<span id="cb14-502"><a href="#cb14-502"></a></span>
<span id="cb14-503"><a href="#cb14-503"></a><span class="ss">1. </span>As in the code cell above</span>
<span id="cb14-504"><a href="#cb14-504"></a><span class="ss">2. </span>Add the resulting states</span>
<span id="cb14-505"><a href="#cb14-505"></a><span class="ss">3. </span>Add photoperiod information to the plot</span>
<span id="cb14-506"><a href="#cb14-506"></a></span>
<span id="cb14-509"><a href="#cb14-509"></a><span class="in">```{r}</span></span>
<span id="cb14-510"><a href="#cb14-510"></a><span class="co">#| echo: false</span></span>
<span id="cb14-511"><a href="#cb14-511"></a><span class="co">#| output: false</span></span>
<span id="cb14-512"><a href="#cb14-512"></a><span class="fu">ggsave</span>(<span class="st">"manuscript/figures/Figure3.png"</span>,</span>
<span id="cb14-513"><a href="#cb14-513"></a>                <span class="at">width =</span> <span class="dv">9</span>,</span>
<span id="cb14-514"><a href="#cb14-514"></a>                <span class="at">height =</span> <span class="dv">9</span>)</span>
<span id="cb14-515"><a href="#cb14-515"></a><span class="in">```</span></span>
<span id="cb14-516"><a href="#cb14-516"></a></span>
<span id="cb14-517"><a href="#cb14-517"></a><span class="fu">#### Distance with spatial distribution</span></span>
<span id="cb14-518"><a href="#cb14-518"></a></span>
<span id="cb14-519"><a href="#cb14-519"></a>The <span class="in">`Clouclip`</span> device outputs a singular measure for distance, while the visual environment in natural conditions contains many distances, depending on the solid angle and direction of the measurement. A device like the <span class="in">`VEET`</span> increases the spatial resolution of these measurements, allowing for more in-depth analyses of the size and position of an object within the field of view. In the case of the <span class="in">`VEET`</span>, data are collected from an 8x8 measurement grid, spanning 52° vertically and 41° horizontally. Here are sample observations from six different days at the same time.</span>
<span id="cb14-520"><a href="#cb14-520"></a></span>
<span id="cb14-523"><a href="#cb14-523"></a><span class="in">```{r}</span></span>
<span id="cb14-524"><a href="#cb14-524"></a><span class="co">#| filename: Collect plot partials to plot the spatial distance grids</span></span>
<span id="cb14-525"><a href="#cb14-525"></a>extras <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb14-526"><a href="#cb14-526"></a>  <span class="fu">geom_tile</span>(),</span>
<span id="cb14-527"><a href="#cb14-527"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">200</span>),</span>
<span id="cb14-528"><a href="#cb14-528"></a>                       <span class="at">oob =</span> scales<span class="sc">::</span>oob_squish_any),</span>
<span id="cb14-529"><a href="#cb14-529"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"black"</span>, <span class="st">"white"</span>)),</span>
<span id="cb14-530"><a href="#cb14-530"></a>  <span class="fu">theme_minimal</span>(),</span>
<span id="cb14-531"><a href="#cb14-531"></a>  <span class="fu">guides</span>(<span class="at">colour =</span> <span class="st">"none"</span>),</span>
<span id="cb14-532"><a href="#cb14-532"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> (dist1<span class="sc">/</span><span class="dv">10</span>) <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">0</span>), <span class="at">colour =</span> dist1<span class="sc">&gt;</span><span class="dv">1000</span>), <span class="at">size =</span> <span class="fl">2.5</span>),</span>
<span id="cb14-533"><a href="#cb14-533"></a>  <span class="fu">coord_fixed</span>(),<span class="co">#&lt;2&gt;</span></span>
<span id="cb14-534"><a href="#cb14-534"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"X position (°)"</span>, <span class="at">y =</span> <span class="st">"Y position (°)"</span>,</span>
<span id="cb14-535"><a href="#cb14-535"></a>       <span class="at">fill =</span> <span class="st">"Distance (cm)"</span>, <span class="at">alpha =</span> <span class="st">"Confidence (0-255)"</span>))</span>
<span id="cb14-536"><a href="#cb14-536"></a><span class="in">```</span></span>
<span id="cb14-537"><a href="#cb14-537"></a></span>
<span id="cb14-540"><a href="#cb14-540"></a><span class="in">```{r}</span></span>
<span id="cb14-541"><a href="#cb14-541"></a><span class="co">#| label: fig-VEET-distance</span></span>
<span id="cb14-542"><a href="#cb14-542"></a><span class="co">#| filename: Plot spatial distance grids for different days</span></span>
<span id="cb14-543"><a href="#cb14-543"></a><span class="co">#| fig-cap: "Example observations of the measurement grid at 1:14 p.m. for each measurement day. Text values show distance in cm. Empty grid points show values with low confidence. Zero-distance values were replaced with infinite distance and plotted despite low confidence."</span></span>
<span id="cb14-544"><a href="#cb14-544"></a><span class="co">#| fig-height: 5</span></span>
<span id="cb14-545"><a href="#cb14-545"></a><span class="co">#| message: false</span></span>
<span id="cb14-546"><a href="#cb14-546"></a><span class="co">#| warning: false</span></span>
<span id="cb14-547"><a href="#cb14-547"></a><span class="co">#| fig-width: 12</span></span>
<span id="cb14-548"><a href="#cb14-548"></a>dataVEET3 <span class="sc">|&gt;</span> </span>
<span id="cb14-549"><a href="#cb14-549"></a>  <span class="fu">filter_Time</span>(<span class="at">start =</span> <span class="st">"13:14:02"</span>, <span class="at">length =</span> <span class="st">"00:00:05"</span>) <span class="sc">|&gt;</span> <span class="co">#&lt;1&gt;</span></span>
<span id="cb14-550"><a href="#cb14-550"></a>  <span class="fu">mutate</span>(<span class="at">dist1 =</span> <span class="fu">ifelse</span>(dist1 <span class="sc">==</span> <span class="dv">0</span>, <span class="cn">Inf</span>, dist1)) <span class="sc">|&gt;</span> <span class="co">#&lt;2&gt;</span></span>
<span id="cb14-551"><a href="#cb14-551"></a>  <span class="fu">filter</span>(conf1 <span class="sc">&gt;=</span> <span class="fl">0.1</span> <span class="sc">|</span> dist1 <span class="sc">==</span> <span class="cn">Inf</span>) <span class="sc">|&gt;</span> <span class="co">#&lt;3&gt;</span></span>
<span id="cb14-552"><a href="#cb14-552"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>x.pos, <span class="at">y=</span>y.pos, <span class="at">fill =</span> dist1<span class="sc">/</span><span class="dv">10</span>))<span class="sc">+</span> <span class="co">#&lt;4&gt;</span></span>
<span id="cb14-553"><a href="#cb14-553"></a>  extras <span class="sc">+</span> <span class="co">#&lt;4&gt;</span></span>
<span id="cb14-554"><a href="#cb14-554"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Datetime) <span class="co">#&lt;5&gt;</span></span>
<span id="cb14-555"><a href="#cb14-555"></a><span class="in">```</span></span>
<span id="cb14-556"><a href="#cb14-556"></a></span>
<span id="cb14-557"><a href="#cb14-557"></a><span class="ss">1. </span>Choose a particular observation</span>
<span id="cb14-558"><a href="#cb14-558"></a><span class="ss">2. </span>Replace 0 distances with infinity</span>
<span id="cb14-559"><a href="#cb14-559"></a><span class="ss">3. </span>Remove data that has less than 10% confidence</span>
<span id="cb14-560"><a href="#cb14-560"></a><span class="ss">4. </span>Plot the data and add the plot partials from the code cell above</span>
<span id="cb14-561"><a href="#cb14-561"></a><span class="ss">5. </span>Show one plot per day</span>
<span id="cb14-562"><a href="#cb14-562"></a></span>
<span id="cb14-565"><a href="#cb14-565"></a><span class="in">```{r}</span></span>
<span id="cb14-566"><a href="#cb14-566"></a><span class="co">#| echo: false</span></span>
<span id="cb14-567"><a href="#cb14-567"></a><span class="co">#| output: false</span></span>
<span id="cb14-568"><a href="#cb14-568"></a><span class="fu">ggsave</span>(<span class="st">"manuscript/figures/Figure4.png"</span>,</span>
<span id="cb14-569"><a href="#cb14-569"></a>                <span class="at">width =</span> <span class="dv">8</span>,</span>
<span id="cb14-570"><a href="#cb14-570"></a>                <span class="at">height =</span> <span class="dv">6</span>)</span>
<span id="cb14-571"><a href="#cb14-571"></a><span class="in">```</span></span>
<span id="cb14-572"><a href="#cb14-572"></a></span>
<span id="cb14-573"><a href="#cb14-573"></a>To use these distance data in the framework shown above for the <span class="in">`Clouclip`</span> device, a sensible method to condense the data has to be applied. There are many ways how a spatially resolved distance measure could be utilized for analysis:</span>
<span id="cb14-574"><a href="#cb14-574"></a></span>
<span id="cb14-575"><a href="#cb14-575"></a><span class="ss">- </span>Where in the field of view are objects in close range?</span>
<span id="cb14-576"><a href="#cb14-576"></a><span class="ss">- </span>How large are near objects in the field of view?</span>
<span id="cb14-577"><a href="#cb14-577"></a><span class="ss">- </span>How varied are distances within the field of view?</span>
<span id="cb14-578"><a href="#cb14-578"></a><span class="ss">- </span>How close are objects / is viewing distance in a region of interest within the field of view?</span>
<span id="cb14-579"><a href="#cb14-579"></a></span>
<span id="cb14-580"><a href="#cb14-580"></a>Possible methods include:</span>
<span id="cb14-581"><a href="#cb14-581"></a></span>
<span id="cb14-582"><a href="#cb14-582"></a><span class="ss">- </span>average across all (high confidence) distance values within the grid</span>
<span id="cb14-583"><a href="#cb14-583"></a><span class="ss">- </span>closest (high confidence) distance within the grid</span>
<span id="cb14-584"><a href="#cb14-584"></a><span class="ss">- </span>(high confidence) values at or around a given grid position, e.g., ±10 degrees around the central view (0°)</span>
<span id="cb14-585"><a href="#cb14-585"></a></span>
<span id="cb14-586"><a href="#cb14-586"></a>Many more options are available based on the spatial dataset, e.g., condensation rules based on the number of points in the grid with a given condition, or the variation within the grid.</span>
<span id="cb14-587"><a href="#cb14-587"></a></span>
<span id="cb14-588"><a href="#cb14-588"></a>We will demonstrate these three methods for a single day (<span class="in">`2024-06-10`</span>), all leading to a data structure akin to the <span class="in">`Clouclip`</span>, i.e., to be used for further calculation of visual experience metrics.</span>
<span id="cb14-589"><a href="#cb14-589"></a></span>
<span id="cb14-592"><a href="#cb14-592"></a><span class="in">```{r}</span></span>
<span id="cb14-593"><a href="#cb14-593"></a><span class="co">#| label: fig-VEET-distance_methods</span></span>
<span id="cb14-594"><a href="#cb14-594"></a><span class="co">#| filename: Calculating and plotting method results</span></span>
<span id="cb14-595"><a href="#cb14-595"></a><span class="co">#| fig-cap: "Comparison of condensation methods for spatial grid of distance measurements. The lines represent an average across all data points (yellow), the minimum distance (grey), or the central 10° (blue). Data points with confidence less than 10% were removed prior to calculation."</span></span>
<span id="cb14-596"><a href="#cb14-596"></a><span class="co">#| fig-height: 5 </span></span>
<span id="cb14-597"><a href="#cb14-597"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb14-598"><a href="#cb14-598"></a>dataVEET3_part <span class="ot">&lt;-</span> <span class="co">#&lt;1&gt;</span></span>
<span id="cb14-599"><a href="#cb14-599"></a>dataVEET3 <span class="sc">|&gt;</span> <span class="co">#&lt;1&gt;</span></span>
<span id="cb14-600"><a href="#cb14-600"></a>  <span class="fu">filter_Date</span>(<span class="at">start =</span> <span class="st">"2024-06-10"</span>, <span class="at">length =</span> <span class="st">"1 day"</span>) <span class="co">#&lt;1&gt;</span></span>
<span id="cb14-601"><a href="#cb14-601"></a></span>
<span id="cb14-602"><a href="#cb14-602"></a>dataVEET3_condensed <span class="ot">&lt;-</span> </span>
<span id="cb14-603"><a href="#cb14-603"></a>dataVEET3_part <span class="sc">|&gt;</span> </span>
<span id="cb14-604"><a href="#cb14-604"></a>  <span class="fu">group_by</span>(Datetime, <span class="at">.add =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> <span class="co">#&lt;2&gt;</span></span>
<span id="cb14-605"><a href="#cb14-605"></a>  <span class="fu">filter</span>(conf1 <span class="sc">&gt;=</span> <span class="fl">0.1</span>) <span class="sc">|&gt;</span> <span class="co">#&lt;3&gt;</span></span>
<span id="cb14-606"><a href="#cb14-606"></a>  <span class="fu">summarize</span>(</span>
<span id="cb14-607"><a href="#cb14-607"></a>    <span class="at">distance_mean =</span> <span class="fu">mean</span>(dist1), <span class="co">#&lt;4&gt;</span></span>
<span id="cb14-608"><a href="#cb14-608"></a>    <span class="at">distance_min =</span> <span class="fu">min</span>(dist1), <span class="co">#&lt;5&gt;</span></span>
<span id="cb14-609"><a href="#cb14-609"></a>    <span class="at">distance_central =</span> <span class="fu">mean</span>(dist1[<span class="fu">between</span>(x.pos, <span class="sc">-</span><span class="dv">10</span>,<span class="dv">10</span>) <span class="sc">&amp;</span> <span class="fu">between</span>(y.pos, <span class="sc">-</span><span class="dv">10</span>,<span class="dv">10</span>)]), <span class="co">#&lt;6&gt;</span></span>
<span id="cb14-610"><a href="#cb14-610"></a>    <span class="at">n =</span> <span class="fu">n</span>(), <span class="co">#&lt;7&gt;</span></span>
<span id="cb14-611"><a href="#cb14-611"></a>    <span class="at">.groups =</span> <span class="st">"drop_last"</span></span>
<span id="cb14-612"><a href="#cb14-612"></a>  )</span>
<span id="cb14-613"><a href="#cb14-613"></a></span>
<span id="cb14-614"><a href="#cb14-614"></a>dataVEET3_condensed <span class="sc">|&gt;</span> </span>
<span id="cb14-615"><a href="#cb14-615"></a>  <span class="fu">aggregate_Datetime</span>(<span class="st">"15 mins"</span>, <span class="at">numeric.handler =</span> \(x) <span class="fu">mean</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> <span class="co">#&lt;8&gt;</span></span>
<span id="cb14-616"><a href="#cb14-616"></a>  <span class="fu">remove_partial_data</span>(<span class="at">by.date =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> <span class="co">#&lt;9&gt;</span></span>
<span id="cb14-617"><a href="#cb14-617"></a>  <span class="fu">pivot_longer</span>(<span class="fu">contains</span>(<span class="st">"distance"</span>), <span class="co">#&lt;10&gt;</span></span>
<span id="cb14-618"><a href="#cb14-618"></a>               <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">".value"</span>, <span class="st">"method"</span>), <span class="co">#&lt;10&gt;</span></span>
<span id="cb14-619"><a href="#cb14-619"></a>    <span class="at">names_pattern =</span> <span class="st">"(distance)_(mean|min|max|central)"</span> <span class="co">#&lt;10&gt;</span></span>
<span id="cb14-620"><a href="#cb14-620"></a>    ) <span class="sc">|&gt;</span> <span class="co">#&lt;10&gt;</span></span>
<span id="cb14-621"><a href="#cb14-621"></a>  <span class="fu">gg_day</span>(<span class="at">y.axis =</span> distance<span class="sc">/</span><span class="dv">10</span>, <span class="co">#&lt;11&gt;</span></span>
<span id="cb14-622"><a href="#cb14-622"></a>         <span class="at">geom =</span> <span class="st">"line"</span>, <span class="co">#&lt;11&gt;</span></span>
<span id="cb14-623"><a href="#cb14-623"></a>         <span class="at">aes_col =</span> method,<span class="co">#&lt;11&gt;</span></span>
<span id="cb14-624"><a href="#cb14-624"></a>         <span class="at">group =</span> method,<span class="co">#&lt;11&gt;</span></span>
<span id="cb14-625"><a href="#cb14-625"></a>         <span class="at">linewidth =</span> <span class="dv">1</span>, <span class="co">#&lt;11&gt;</span></span>
<span id="cb14-626"><a href="#cb14-626"></a>         <span class="at">alpha =</span> <span class="fl">0.75</span>, <span class="co">#&lt;11&gt;</span></span>
<span id="cb14-627"><a href="#cb14-627"></a>         <span class="at">y.scale =</span> <span class="st">"identity"</span>,<span class="co">#&lt;11&gt;</span></span>
<span id="cb14-628"><a href="#cb14-628"></a>         <span class="at">y.axis.breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">150</span>, <span class="at">by =</span> <span class="dv">20</span>), <span class="co">#&lt;11&gt;</span></span>
<span id="cb14-629"><a href="#cb14-629"></a>         <span class="at">y.axis.label =</span> <span class="st">"Distance (cm)"</span><span class="co">#&lt;11&gt;</span></span>
<span id="cb14-630"><a href="#cb14-630"></a>         ) <span class="sc">|&gt;</span> <span class="co">#&lt;11&gt;</span></span>
<span id="cb14-631"><a href="#cb14-631"></a>  <span class="fu">gg_photoperiod</span>(coordinates) <span class="co">#&lt;11&gt;</span></span>
<span id="cb14-632"><a href="#cb14-632"></a><span class="in">```</span></span>
<span id="cb14-633"><a href="#cb14-633"></a></span>
<span id="cb14-634"><a href="#cb14-634"></a><span class="ss">1. </span>Filter one day</span>
<span id="cb14-635"><a href="#cb14-635"></a><span class="ss">2. </span>Group additionally by every observation</span>
<span id="cb14-636"><a href="#cb14-636"></a><span class="ss">3. </span>Remove data with low confidence</span>
<span id="cb14-637"><a href="#cb14-637"></a><span class="ss">4. </span>Average across all distance values</span>
<span id="cb14-638"><a href="#cb14-638"></a><span class="ss">5. </span>Closest across all distance values</span>
<span id="cb14-639"><a href="#cb14-639"></a><span class="ss">6. </span>Central distance</span>
<span id="cb14-640"><a href="#cb14-640"></a><span class="ss">7. </span>Number of (valid) grid points</span>
<span id="cb14-641"><a href="#cb14-641"></a><span class="ss">8. </span>Aggregate to 15 minute data</span>
<span id="cb14-642"><a href="#cb14-642"></a><span class="ss">9. </span>Remove data points that fall exactly on midnight of the following day</span>
<span id="cb14-643"><a href="#cb14-643"></a><span class="ss">10. </span>Pivoting the method results from wide to long for plotting</span>
<span id="cb14-644"><a href="#cb14-644"></a><span class="ss">11. </span>Setting up the plot for distance.</span>
<span id="cb14-645"><a href="#cb14-645"></a></span>
<span id="cb14-648"><a href="#cb14-648"></a><span class="in">```{r}</span></span>
<span id="cb14-649"><a href="#cb14-649"></a><span class="co">#| echo: false</span></span>
<span id="cb14-650"><a href="#cb14-650"></a><span class="co">#| output: false</span></span>
<span id="cb14-651"><a href="#cb14-651"></a><span class="fu">ggsave</span>(<span class="st">"manuscript/figures/Figure5.png"</span>,</span>
<span id="cb14-652"><a href="#cb14-652"></a>                <span class="at">width =</span> <span class="dv">7</span>,</span>
<span id="cb14-653"><a href="#cb14-653"></a>                <span class="at">height =</span> <span class="dv">4</span>)</span>
<span id="cb14-654"><a href="#cb14-654"></a><span class="in">```</span></span>
<span id="cb14-655"><a href="#cb14-655"></a></span>
<span id="cb14-656"><a href="#cb14-656"></a>As can be seen in @fig-VEET-distance_methods, while the overall pattern is similar regardless of the used method, there are notable differences between the methods, which will consequently affect downstream analyses. Most importantly, the process of condensation has to be well documented and reproducible, as shown above. Any of these data could now be used to calculate the <span class="in">`frequency of continuous near work`</span>, <span class="in">`visual breaks`</span>, or <span class="in">`near-work episodes`</span> as described above.</span>
<span id="cb14-657"><a href="#cb14-657"></a></span>
<span id="cb14-658"><a href="#cb14-658"></a><span class="fu">### Light {#light}</span></span>
<span id="cb14-659"><a href="#cb14-659"></a></span>
<span id="cb14-660"><a href="#cb14-660"></a>The <span class="in">`Clouclip`</span> illuminance data in our example cover indoor environments and are thus comparatively low, which would make certain daylight exposure summaries trivial or not meaningful. To better illustrate light exposure metrics, we turn to a different dataset, this one taken from the <span class="in">`VEET`</span> device’s illuminance data, which capture a broader range of lighting conditions (though both device types are able to capture broadly the same range of illuminance). We import the <span class="in">`VEET`</span> ambient light data (already preprocessed to have regular 5-second intervals as described above) and briefly examine its distribution.</span>
<span id="cb14-661"><a href="#cb14-661"></a></span>
<span id="cb14-662"><a href="#cb14-662"></a>**Illuminance distribution**: The illuminance values from the <span class="in">`Clouclip`</span> were comparatively low, while the <span class="in">`VEET`</span> data include outdoor exposures up to several thousand lux. The contrast is evident from comparing histograms of the two datasets’ lux values (<span class="in">`Clouclip`</span> vs. <span class="in">`VEET`</span>), where the main peak is similarly positioned between 10 and 100 lx, but the tails differ. The <span class="in">`VEET`</span> illuminance histogram (see @fig-hist-VEETlight) shows a heavily skewed distribution with a considerable number of zero lx values (indicating intervals of complete darkness or the sensor being covered) and a long tail extending to very high lux values. Such zero-inflated and skewed data are common in wearable light measurements <span class="co">[</span><span class="ot">@ZaunerEtAl2025JBR</span><span class="co">]</span>. </span>
<span id="cb14-663"><a href="#cb14-663"></a></span>
<span id="cb14-666"><a href="#cb14-666"></a><span class="in">```{r}</span></span>
<span id="cb14-667"><a href="#cb14-667"></a><span class="co">#| label: fig-hist-CClight</span></span>
<span id="cb14-668"><a href="#cb14-668"></a><span class="co">#| column: margin</span></span>
<span id="cb14-669"><a href="#cb14-669"></a><span class="co">#| warning: false</span></span>
<span id="cb14-670"><a href="#cb14-670"></a><span class="co">#| echo: false</span></span>
<span id="cb14-671"><a href="#cb14-671"></a><span class="co">#| fig-cap: "Histogram of illuminance values from the Clouclip dataset (5-second data). The values are typical of indoor conditions."</span></span>
<span id="cb14-672"><a href="#cb14-672"></a>dataCC <span class="sc">|&gt;</span> </span>
<span id="cb14-673"><a href="#cb14-673"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Lux)) <span class="sc">+</span> </span>
<span id="cb14-674"><a href="#cb14-674"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Photopic illuminance (lx)"</span>, <span class="at">y =</span> <span class="st">"Relative count"</span>) <span class="sc">+</span></span>
<span id="cb14-675"><a href="#cb14-675"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.05</span>, <span class="fu">aes</span>(<span class="at">y=</span><span class="fu">after_stat</span>(ncount))) <span class="sc">+</span> </span>
<span id="cb14-676"><a href="#cb14-676"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb14-677"><a href="#cb14-677"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans =</span> <span class="st">"symlog"</span>, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">100</span>, <span class="dv">1000</span>, <span class="dv">10000</span>)) <span class="sc">+</span></span>
<span id="cb14-678"><a href="#cb14-678"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="sc">~</span><span class="fu">vec_fmt_percent</span>(.x, <span class="at">decimals =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb14-679"><a href="#cb14-679"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">5</span><span class="sc">*</span><span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb14-680"><a href="#cb14-680"></a><span class="fu">ggsave</span>(<span class="st">"manuscript/figures/Figure6.png"</span>,</span>
<span id="cb14-681"><a href="#cb14-681"></a>                <span class="at">width =</span> <span class="dv">7</span>,</span>
<span id="cb14-682"><a href="#cb14-682"></a>                <span class="at">height =</span> <span class="dv">4</span>)</span>
<span id="cb14-683"><a href="#cb14-683"></a><span class="in">```</span></span>
<span id="cb14-684"><a href="#cb14-684"></a></span>
<span id="cb14-685"><a href="#cb14-685"></a></span>
<span id="cb14-686"><a href="#cb14-686"></a></span>
<span id="cb14-689"><a href="#cb14-689"></a><span class="in">```{r}</span></span>
<span id="cb14-690"><a href="#cb14-690"></a><span class="co">#| label: fig-hist-VEETlight</span></span>
<span id="cb14-691"><a href="#cb14-691"></a><span class="co">#| column: margin</span></span>
<span id="cb14-692"><a href="#cb14-692"></a><span class="co">#| echo: false</span></span>
<span id="cb14-693"><a href="#cb14-693"></a><span class="co">#| warning: false</span></span>
<span id="cb14-694"><a href="#cb14-694"></a><span class="co">#| fig-cap: "Histogram of illuminance values from the VEET dataset (aggregated to 5&nbsp;s). Note the logarithmic x-axis: the distribution is highly skewed with many low values (including zeros) and a long tail of high lux readings. Outdoor light exposures in bright conditions are distinguishable around 10^3 to 10^4 lx."</span></span>
<span id="cb14-695"><a href="#cb14-695"></a>dataVEET <span class="sc">|&gt;</span> </span>
<span id="cb14-696"><a href="#cb14-696"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Lux)) <span class="sc">+</span> </span>
<span id="cb14-697"><a href="#cb14-697"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Photopic illuminance (lx)"</span>, <span class="at">y =</span> <span class="st">"Relative count"</span>) <span class="sc">+</span></span>
<span id="cb14-698"><a href="#cb14-698"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.05</span>, <span class="fu">aes</span>(<span class="at">y=</span><span class="fu">after_stat</span>(ncount))) <span class="sc">+</span> </span>
<span id="cb14-699"><a href="#cb14-699"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb14-700"><a href="#cb14-700"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans =</span> <span class="st">"symlog"</span>, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">100</span>, <span class="dv">1000</span>, <span class="dv">10000</span>)) <span class="sc">+</span></span>
<span id="cb14-701"><a href="#cb14-701"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="sc">~</span><span class="fu">vec_fmt_percent</span>(.x, <span class="at">decimals =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb14-702"><a href="#cb14-702"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">5</span><span class="sc">*</span><span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb14-703"><a href="#cb14-703"></a><span class="fu">ggsave</span>(<span class="st">"manuscript/figures/Figure7.png"</span>,</span>
<span id="cb14-704"><a href="#cb14-704"></a>                <span class="at">width =</span> <span class="dv">7</span>,</span>
<span id="cb14-705"><a href="#cb14-705"></a>                <span class="at">height =</span> <span class="dv">4</span>)</span>
<span id="cb14-706"><a href="#cb14-706"></a><span class="in">```</span></span>
<span id="cb14-707"><a href="#cb14-707"></a></span>
<span id="cb14-708"><a href="#cb14-708"></a>After confirming that the <span class="in">`VEET`</span> data cover a broad dynamic range of lighting, we proceed with calculating light exposure metrics. (The VEET data had been cleaned for gaps and irregularities as described earlier, and non-wear times were removed; see <span class="co">[</span><span class="ot">Supplement&nbsp;1</span><span class="co">](supplement.qmd)</span> for the details.)</span>
<span id="cb14-709"><a href="#cb14-709"></a></span>
<span id="cb14-710"><a href="#cb14-710"></a><span class="fu">#### Average light exposure {#sec-avelight}</span></span>
<span id="cb14-711"><a href="#cb14-711"></a></span>
<span id="cb14-712"><a href="#cb14-712"></a>A basic metric is the average illuminance over the day. @tbl-lightexposure shows the mean illuminance (in lux) for weekdays, weekends, and the overall daily mean, calculated directly from the raw lux values.</span>
<span id="cb14-713"><a href="#cb14-713"></a></span>
<span id="cb14-716"><a href="#cb14-716"></a><span class="in">```{r}</span></span>
<span id="cb14-717"><a href="#cb14-717"></a><span class="co">#| label: tbl-lightexposure</span></span>
<span id="cb14-718"><a href="#cb14-718"></a><span class="co">#| filename: Calculating mean light exposure per day</span></span>
<span id="cb14-719"><a href="#cb14-719"></a><span class="co">#| tbl-cap: "Mean light exposure (illuminance) per day"</span></span>
<span id="cb14-720"><a href="#cb14-720"></a>dataVEET <span class="sc">|&gt;</span> </span>
<span id="cb14-721"><a href="#cb14-721"></a>  <span class="fu">select</span>(Id, Date, Datetime, Lux) <span class="sc">|&gt;</span> </span>
<span id="cb14-722"><a href="#cb14-722"></a>  <span class="fu">summarize_numeric</span>(<span class="at">prefix =</span> <span class="st">"mean "</span>, <span class="at">remove =</span> <span class="fu">c</span>(<span class="st">"Datetime"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb14-723"><a href="#cb14-723"></a>  <span class="fu">to_mean_daily</span>() <span class="sc">|&gt;</span></span>
<span id="cb14-724"><a href="#cb14-724"></a>  <span class="fu">fmt_number</span>(<span class="at">decimals =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb14-725"><a href="#cb14-725"></a>  <span class="fu">cols_hide</span>(<span class="st">`</span><span class="at">average episodes</span><span class="st">`</span>) <span class="sc">|&gt;</span></span>
<span id="cb14-726"><a href="#cb14-726"></a>  <span class="fu">cols_label</span>(<span class="st">`</span><span class="at">average mean Lux</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"Mean photopic illuminance (lx)"</span>)</span>
<span id="cb14-727"><a href="#cb14-727"></a><span class="in">```</span></span>
<span id="cb14-728"><a href="#cb14-728"></a></span>
<span id="cb14-729"><a href="#cb14-729"></a>However, because illuminance data tend to be extremely skewed and contain many zero values (periods of darkness), the arithmetic mean can be <span class="co">[</span><span class="ot">misleading</span><span class="co">](https://tscnlab.github.io/LightLogR/articles/log.html)</span>. A common approach is to apply a logarithmic transform to illuminance before averaging, which down-weights extreme values and accounts for the multiplicative nature of light intensity effects. LightLogR provides helper functions <span class="co">[</span><span class="ot">`log_zero_inflated()`</span><span class="co">]</span>((https://tscnlab.github.io/LightLogR/reference/log_zero_inflated.html)) and its inverse <span class="co">[</span><span class="ot">`exp_zero_inflated()`</span><span class="co">](https://tscnlab.github.io/LightLogR/reference/log_zero_inflated.html)</span> to handle log-transformation when zeros are present (by adding a small offset before log, and back-transforming after averaging). Using this approach, we recompute the daily mean illuminance. The results in @tbl-lightexposure2 show that the log-transformed mean (back-transformed to lux) is much lower, reflecting the fact that for much of the time illuminance was near zero. This transformed mean is often more representative of typical exposure for skewed data.</span>
<span id="cb14-730"><a href="#cb14-730"></a></span>
<span id="cb14-733"><a href="#cb14-733"></a><span class="in">```{r}</span></span>
<span id="cb14-734"><a href="#cb14-734"></a><span class="co">#| label: tbl-lightexposure2</span></span>
<span id="cb14-735"><a href="#cb14-735"></a><span class="co">#| filename: Calculating mean light exposure per day with log transformation</span></span>
<span id="cb14-736"><a href="#cb14-736"></a><span class="co">#| tbl-cap: "Mean light exposure per day (after logarithmic transformation to account for zero inflation and skewness)"</span></span>
<span id="cb14-737"><a href="#cb14-737"></a>dataVEET <span class="sc">|&gt;</span> </span>
<span id="cb14-738"><a href="#cb14-738"></a>  <span class="fu">select</span>(Id, Date, Datetime, Lux) <span class="sc">|&gt;</span> </span>
<span id="cb14-739"><a href="#cb14-739"></a>  <span class="fu">mutate</span>(<span class="at">Lux =</span> Lux <span class="sc">|&gt;</span> <span class="fu">log_zero_inflated</span>()) <span class="sc">|&gt;</span>        <span class="co"># &lt;1&gt;</span></span>
<span id="cb14-740"><a href="#cb14-740"></a>  <span class="fu">summarize_numeric</span>(<span class="at">prefix =</span> <span class="st">"mean "</span>, <span class="at">remove =</span> <span class="fu">c</span>(<span class="st">"Datetime"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb14-741"><a href="#cb14-741"></a>  <span class="fu">mean_daily</span>(<span class="at">prefix =</span> <span class="st">""</span>) <span class="sc">|&gt;</span>                         <span class="co"># &lt;2&gt;</span></span>
<span id="cb14-742"><a href="#cb14-742"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">mean Lux</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">mean Lux</span><span class="st">`</span> <span class="sc">|&gt;</span> <span class="fu">exp_zero_inflated</span>()) <span class="sc">|&gt;</span>  <span class="co"># &lt;3&gt;</span></span>
<span id="cb14-743"><a href="#cb14-743"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span> <span class="fu">fmt_number</span>(<span class="at">decimals =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span> <span class="fu">cols_hide</span>(episodes) <span class="sc">|&gt;</span> </span>
<span id="cb14-744"><a href="#cb14-744"></a>  <span class="fu">cols_label</span>(<span class="st">`</span><span class="at">mean Lux</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"Mean photopic illuminance (lx)"</span>)</span>
<span id="cb14-745"><a href="#cb14-745"></a><span class="in">```</span></span>
<span id="cb14-746"><a href="#cb14-746"></a></span>
<span id="cb14-747"><a href="#cb14-747"></a><span class="ss">1. </span>Log transform with zero handling (base 10)</span>
<span id="cb14-748"><a href="#cb14-748"></a><span class="ss">2. </span>Calculate daily mean of log-lux</span>
<span id="cb14-749"><a href="#cb14-749"></a><span class="ss">3. </span>Back-transform to lux</span>
<span id="cb14-750"><a href="#cb14-750"></a></span>
<span id="cb14-751"><a href="#cb14-751"></a><span class="fu">#### Duration in high-light (outdoor) conditions {#sec-outdoorlight}</span></span>
<span id="cb14-752"><a href="#cb14-752"></a></span>
<span id="cb14-753"><a href="#cb14-753"></a>Another important metric is the amount of time spent under bright light, often used as a proxy for outdoor exposure. We define thresholds corresponding to outdoor light levels (e.g. 1000&nbsp;lx and above). Here, we categorize each 5-second interval of illuminance into bands: Outdoor bright (≥1000&nbsp;lx), Outdoor very bright (≥2000&nbsp;lx), and Outdoor extremely bright (≥3000&nbsp;lx). We then sum the duration in each category per day. </span>
<span id="cb14-754"><a href="#cb14-754"></a></span>
<span id="cb14-755"><a href="#cb14-755"></a>While daylight levels can far exceed the recorded light levels, those are usually recorded with direct sunlight and without obstruction. Under normal viewing conditions, at eye level, and avoiding glare, daylight levels of a few thousand lux are at the higher end of the distribution <span class="co">[</span><span class="ot">@murukesu2025ADID</span><span class="co">]</span>. @fig-hist-VEETlight shows a bimodal distribution, with the right mode representing outdoor lighting conditions. In a 2023 review of light dosimeters to investigate the light-myopia relationship <span class="co">[</span><span class="ot">@Honekopp2023ClinOphthalmol</span><span class="co">]</span>, 1000 lx was the predominant cutoff value to distinguish indoor vs. outdoor environments. It is not, however, without critique, and both other thresholds <span class="co">[</span><span class="ot">@pattersongentile2025</span><span class="co">]</span> and classification methods are proposed <span class="co">[</span><span class="ot">@tabandeh2025</span><span class="co">]</span>.</span>
<span id="cb14-756"><a href="#cb14-756"></a></span>
<span id="cb14-759"><a href="#cb14-759"></a><span class="in">```{r}</span></span>
<span id="cb14-760"><a href="#cb14-760"></a><span class="co">#| filename: Define outdoor illuminance thresholds (in lux)</span></span>
<span id="cb14-761"><a href="#cb14-761"></a>out_breaks <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1e3</span>, <span class="fl">2e3</span>, <span class="fl">3e3</span>, <span class="cn">Inf</span>)</span>
<span id="cb14-762"><a href="#cb14-762"></a>out_labels <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb14-763"><a href="#cb14-763"></a>    <span class="st">"Indoor"</span>,                  <span class="co"># [0, 1000) lx</span></span>
<span id="cb14-764"><a href="#cb14-764"></a>    <span class="st">"Outdoor bright"</span>,          <span class="co"># [1000, 2000) lx</span></span>
<span id="cb14-765"><a href="#cb14-765"></a>    <span class="st">"Outdoor very bright"</span>,     <span class="co"># [2000, 3000) lx</span></span>
<span id="cb14-766"><a href="#cb14-766"></a>    <span class="st">"Outdoor extremely bright"</span> <span class="co"># [3000, ∞) lx</span></span>
<span id="cb14-767"><a href="#cb14-767"></a>  )</span>
<span id="cb14-768"><a href="#cb14-768"></a></span>
<span id="cb14-769"><a href="#cb14-769"></a>dataVEET <span class="ot">&lt;-</span> dataVEET <span class="sc">|&gt;</span> </span>
<span id="cb14-770"><a href="#cb14-770"></a>  <span class="fu">mutate</span>(<span class="at">Lux_range =</span> <span class="fu">cut</span>(Lux, <span class="at">breaks =</span> out_breaks, <span class="at">labels =</span> out_labels))</span>
<span id="cb14-771"><a href="#cb14-771"></a><span class="in">```</span></span>
<span id="cb14-772"><a href="#cb14-772"></a></span>
<span id="cb14-773"><a href="#cb14-773"></a>Now we compute the mean daily duration spent in each of these outdoor light ranges (@tbl-outdoor):</span>
<span id="cb14-774"><a href="#cb14-774"></a></span>
<span id="cb14-777"><a href="#cb14-777"></a><span class="in">```{r}</span></span>
<span id="cb14-778"><a href="#cb14-778"></a><span class="co">#| label: tbl-outdoor</span></span>
<span id="cb14-779"><a href="#cb14-779"></a><span class="co">#| filename: Calculate the mean daily duration spent in each light range</span></span>
<span id="cb14-780"><a href="#cb14-780"></a><span class="co">#| tbl-cap: "Average daily duration in outdoor-equivalent light conditions"</span></span>
<span id="cb14-781"><a href="#cb14-781"></a>dataVEET <span class="sc">|&gt;</span> </span>
<span id="cb14-782"><a href="#cb14-782"></a>  <span class="fu">drop_na</span>(Lux_range) <span class="sc">|&gt;</span> </span>
<span id="cb14-783"><a href="#cb14-783"></a>  <span class="fu">group_by</span>(Lux_range, <span class="at">.add =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb14-784"><a href="#cb14-784"></a>  <span class="fu">durations</span>(Lux) <span class="sc">|&gt;</span>                         </span>
<span id="cb14-785"><a href="#cb14-785"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> Lux_range, <span class="at">values_from =</span> duration) <span class="sc">|&gt;</span> </span>
<span id="cb14-786"><a href="#cb14-786"></a>  <span class="fu">to_mean_daily</span>(<span class="st">""</span>) <span class="sc">|&gt;</span> </span>
<span id="cb14-787"><a href="#cb14-787"></a>  <span class="fu">fmt_duration</span>(<span class="at">input_units =</span> <span class="st">"seconds"</span>, <span class="at">output_units =</span> <span class="st">"minutes"</span>)</span>
<span id="cb14-788"><a href="#cb14-788"></a><span class="in">```</span></span>
<span id="cb14-789"><a href="#cb14-789"></a></span>
<span id="cb14-790"><a href="#cb14-790"></a>It is also informative to visualize when these high-light conditions occurred. @fig-outdoor shows a timeline plot with periods of outdoor-level illuminance highlighted in color. In this example, violet denotes ≥1000&nbsp;lx, green ≥2000&nbsp;lx, and yellow ≥3000&nbsp;lx. Grey shading indicates nighttime (from civil dusk to dawn) for context.</span>
<span id="cb14-791"><a href="#cb14-791"></a></span>
<span id="cb14-794"><a href="#cb14-794"></a><span class="in">```{r}</span></span>
<span id="cb14-795"><a href="#cb14-795"></a><span class="co">#| fig-height: 8</span></span>
<span id="cb14-796"><a href="#cb14-796"></a><span class="co">#| fig-width: 9</span></span>
<span id="cb14-797"><a href="#cb14-797"></a><span class="co">#| warning: false</span></span>
<span id="cb14-798"><a href="#cb14-798"></a><span class="co">#| filename: Visualize time spent outdoors</span></span>
<span id="cb14-799"><a href="#cb14-799"></a><span class="co">#| label: fig-outdoor</span></span>
<span id="cb14-800"><a href="#cb14-800"></a><span class="co">#| fig-cap: "Outdoor light exposure over time. Colored bands indicate periods when illuminance exceeded outdoor thresholds: violet for ≥1000&nbsp;lx, green for ≥2000&nbsp;lx, and yellow for ≥3000&nbsp;lx. Grey shaded regions denote night (from civil dusk to dawn)."</span></span>
<span id="cb14-801"><a href="#cb14-801"></a>dataVEET <span class="sc">|&gt;</span> </span>
<span id="cb14-802"><a href="#cb14-802"></a>  <span class="fu">aggregate_Datetime</span>(<span class="st">"2 mins"</span>, <span class="at">type =</span> <span class="st">"floor"</span>) <span class="sc">|&gt;</span> <span class="co">#&lt;1&gt;</span></span>
<span id="cb14-803"><a href="#cb14-803"></a>  <span class="fu">mutate</span>(<span class="at">Lux_range =</span> <span class="fu">na_if</span>(Lux_range, <span class="st">"Indoor"</span>)) <span class="sc">|&gt;</span> <span class="co">#&lt;2&gt;</span></span>
<span id="cb14-804"><a href="#cb14-804"></a>  <span class="fu">gg_day</span>(<span class="at">y.axis =</span> Lux, <span class="co">#&lt;3&gt;</span></span>
<span id="cb14-805"><a href="#cb14-805"></a>         <span class="at">y.axis.label =</span> <span class="st">"Photopic illuminance (lx)"</span>, <span class="co">#&lt;3&gt;</span></span>
<span id="cb14-806"><a href="#cb14-806"></a>         <span class="at">geom =</span> <span class="st">"line"</span>, <span class="co">#&lt;3&gt;</span></span>
<span id="cb14-807"><a href="#cb14-807"></a>         <span class="at">jco_color =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span> <span class="co">#&lt;3&gt;</span></span>
<span id="cb14-808"><a href="#cb14-808"></a>  <span class="fu">gg_state</span>(Lux_range, <span class="at">aes_fill =</span> Lux_range, <span class="co">#&lt;4&gt;</span></span>
<span id="cb14-809"><a href="#cb14-809"></a>           <span class="at">alpha =</span> <span class="fl">0.75</span>, <span class="at">ymin =</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">3</span>, <span class="at">ymax =</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>) <span class="sc">+</span> <span class="co">#&lt;4&gt;</span></span>
<span id="cb14-810"><a href="#cb14-810"></a>  <span class="fu">scale_fill_viridis_d</span>() <span class="sc">+</span></span>
<span id="cb14-811"><a href="#cb14-811"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">"Illuminance range"</span>) <span class="sc">+</span></span>
<span id="cb14-812"><a href="#cb14-812"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span></span>
<span id="cb14-813"><a href="#cb14-813"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">8</span>, <span class="fl">19.5</span>)<span class="sc">*</span><span class="dv">3600</span>) <span class="co">#&lt;5&gt;</span></span>
<span id="cb14-814"><a href="#cb14-814"></a><span class="in">```</span></span>
<span id="cb14-815"><a href="#cb14-815"></a></span>
<span id="cb14-816"><a href="#cb14-816"></a><span class="ss">1. </span>Aggregating data to 5-minute bins</span>
<span id="cb14-817"><a href="#cb14-817"></a><span class="ss">2. </span>Removing the indoor condition</span>
<span id="cb14-818"><a href="#cb14-818"></a><span class="ss">3. </span>Setting up the basic plot</span>
<span id="cb14-819"><a href="#cb14-819"></a><span class="ss">4. </span>Adding state information on the illuminance ranges</span>
<span id="cb14-820"><a href="#cb14-820"></a><span class="ss">5. </span>Setting the x-axis limits to cover daytime hours</span>
<span id="cb14-821"><a href="#cb14-821"></a></span>
<span id="cb14-824"><a href="#cb14-824"></a><span class="in">```{r}</span></span>
<span id="cb14-825"><a href="#cb14-825"></a><span class="co">#| echo: false</span></span>
<span id="cb14-826"><a href="#cb14-826"></a><span class="co">#| output: false</span></span>
<span id="cb14-827"><a href="#cb14-827"></a><span class="fu">ggsave</span>(<span class="st">"manuscript/figures/Figure8.png"</span>,</span>
<span id="cb14-828"><a href="#cb14-828"></a>                <span class="at">width =</span> <span class="dv">9</span>,</span>
<span id="cb14-829"><a href="#cb14-829"></a>                <span class="at">height =</span> <span class="dv">9</span>)</span>
<span id="cb14-830"><a href="#cb14-830"></a><span class="in">```</span></span>
<span id="cb14-831"><a href="#cb14-831"></a></span>
<span id="cb14-832"><a href="#cb14-832"></a><span class="fu">#### Frequency of transitions from indoor to outdoor light</span></span>
<span id="cb14-833"><a href="#cb14-833"></a></span>
<span id="cb14-834"><a href="#cb14-834"></a>We next consider how often the subject moved from an indoor light environment to an outdoor-equivalent environment. We operationally define an "outdoor transition" as a change from &lt;1000&nbsp;lx to ≥1000&nbsp;lx. Using the cleaned <span class="in">`VEET`</span> data, we extract all instances where illuminance crosses that threshold from below to above. </span>
<span id="cb14-835"><a href="#cb14-835"></a></span>
<span id="cb14-836"><a href="#cb14-836"></a>@tbl-changesoutdoor shows the average number of such transitions per day. Note that if data are recorded at a fine temporal resolution (5&nbsp;s here), very brief excursions above 1000&nbsp;lx could count as transitions and inflate this number. Indeed, the initial count is fairly high, reflecting fleeting spikes above 1000&nbsp;lx that might not represent meaningful outdoor exposures.</span>
<span id="cb14-837"><a href="#cb14-837"></a></span>
<span id="cb14-840"><a href="#cb14-840"></a><span class="in">```{r}</span></span>
<span id="cb14-841"><a href="#cb14-841"></a><span class="co">#| label: tbl-changesoutdoor</span></span>
<span id="cb14-842"><a href="#cb14-842"></a><span class="co">#| filename: Calculate the number of transitions from indoor to outdoor</span></span>
<span id="cb14-843"><a href="#cb14-843"></a><span class="co">#| tbl-cap: "Average daily count of transitions from indoor (&lt;1000 lx) to outdoor (≥1000 lx) lighting when looking at 5-second epochs"</span></span>
<span id="cb14-844"><a href="#cb14-844"></a>dataVEET <span class="sc">|&gt;</span> </span>
<span id="cb14-845"><a href="#cb14-845"></a>  <span class="fu">extract_states</span>(Outdoor, Lux <span class="sc">&gt;=</span> <span class="dv">1000</span>, <span class="at">group.by.state =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span>  <span class="co"># &lt;1&gt;</span></span>
<span id="cb14-846"><a href="#cb14-846"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">lead</span>(Outdoor) <span class="sc">&amp;</span> Outdoor) <span class="sc">|&gt;</span>   <span class="co">#&lt;2&gt;</span></span>
<span id="cb14-847"><a href="#cb14-847"></a>  <span class="fu">summarize_numeric</span>(<span class="at">prefix =</span> <span class="st">"mean "</span>,</span>
<span id="cb14-848"><a href="#cb14-848"></a>    <span class="at">remove =</span> <span class="fu">c</span>(<span class="st">"Datetime"</span>, <span class="st">"Outdoor"</span>, <span class="st">"start"</span>, <span class="st">"end"</span>, <span class="st">"duration"</span>),</span>
<span id="cb14-849"><a href="#cb14-849"></a>    <span class="at">add.total.duration =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb14-850"><a href="#cb14-850"></a>  <span class="fu">mean_daily</span>(<span class="at">prefix =</span> <span class="st">""</span>) <span class="sc">|&gt;</span> </span>
<span id="cb14-851"><a href="#cb14-851"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span> </span>
<span id="cb14-852"><a href="#cb14-852"></a>  <span class="fu">fmt_number</span>(episodes, <span class="at">decimals =</span> <span class="dv">0</span>) <span class="sc">|&gt;</span> </span>
<span id="cb14-853"><a href="#cb14-853"></a>  <span class="fu">fmt_duration</span>(<span class="st">`</span><span class="at">mean epoch</span><span class="st">`</span>, <span class="at">input_units =</span> <span class="st">"seconds"</span>, <span class="at">output_units =</span> <span class="st">"seconds"</span>)</span>
<span id="cb14-854"><a href="#cb14-854"></a><span class="in">```</span></span>
<span id="cb14-855"><a href="#cb14-855"></a></span>
<span id="cb14-856"><a href="#cb14-856"></a><span class="ss">1. </span>Label each interval as Outdoor (Lux≥1000) or not</span>
<span id="cb14-857"><a href="#cb14-857"></a><span class="ss">2. </span>Find instances where the previous interval was "indoor" and current is "outdoor"</span>
<span id="cb14-858"><a href="#cb14-858"></a></span>
<span id="cb14-859"><a href="#cb14-859"></a>To obtain a more meaningful measure, we can require that the outdoor state persists for some minimum duration to count as a true transition (filtering out momentary fluctuations around the 1000&nbsp;lx mark). For example, we can require that once ≥1000&nbsp;lx is reached, it continues for at least 5&nbsp;minutes (allowing short interruptions up to 20&nbsp;s). @tbl-changesoutdoor2 applies this criterion, resulting in a lower, more plausible transition count.</span>
<span id="cb14-860"><a href="#cb14-860"></a></span>
<span id="cb14-863"><a href="#cb14-863"></a><span class="in">```{r}</span></span>
<span id="cb14-864"><a href="#cb14-864"></a><span class="co">#| label: tbl-changesoutdoor2</span></span>
<span id="cb14-865"><a href="#cb14-865"></a><span class="co">#| filename: Calculate the number of transitions from indoor to outdoor with clusters</span></span>
<span id="cb14-866"><a href="#cb14-866"></a><span class="co">#| tbl-cap: "Daily indoor-to-outdoor transition count (requiring ≥5&nbsp;min duration of ≥1000&nbsp;lx to count)"</span></span>
<span id="cb14-867"><a href="#cb14-867"></a>dataVEET <span class="sc">|&gt;</span> </span>
<span id="cb14-868"><a href="#cb14-868"></a>  <span class="fu">extract_clusters</span>(Lux <span class="sc">&gt;=</span> <span class="dv">1000</span>,</span>
<span id="cb14-869"><a href="#cb14-869"></a>                   <span class="at">cluster.duration =</span> <span class="st">"5 min"</span>, </span>
<span id="cb14-870"><a href="#cb14-870"></a>                   <span class="at">interruption.duration =</span> <span class="st">"20 secs"</span>,</span>
<span id="cb14-871"><a href="#cb14-871"></a>                   <span class="at">return.only.clusters =</span> <span class="cn">FALSE</span>,</span>
<span id="cb14-872"><a href="#cb14-872"></a>                   <span class="at">drop.empty.groups =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb14-873"><a href="#cb14-873"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">lead</span>(is.cluster) <span class="sc">&amp;</span> is.cluster) <span class="sc">|&gt;</span> </span>
<span id="cb14-874"><a href="#cb14-874"></a>  <span class="fu">summarize_numeric</span>(<span class="at">prefix =</span> <span class="st">"mean "</span>,</span>
<span id="cb14-875"><a href="#cb14-875"></a>    <span class="at">remove =</span> <span class="fu">c</span>(<span class="st">"Datetime"</span>, <span class="st">"start"</span>, <span class="st">"end"</span>, <span class="st">"duration"</span>),</span>
<span id="cb14-876"><a href="#cb14-876"></a>    <span class="at">add.total.duration =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb14-877"><a href="#cb14-877"></a>  <span class="fu">mean_daily</span>(<span class="at">prefix =</span> <span class="st">""</span>) <span class="sc">|&gt;</span> </span>
<span id="cb14-878"><a href="#cb14-878"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span> <span class="fu">fmt_number</span>(episodes, <span class="at">decimals =</span> <span class="dv">0</span>)</span>
<span id="cb14-879"><a href="#cb14-879"></a><span class="in">```</span></span>
<span id="cb14-880"><a href="#cb14-880"></a></span>
<span id="cb14-881"><a href="#cb14-881"></a><span class="fu">#### Longest sustained bright-light period</span></span>
<span id="cb14-882"><a href="#cb14-882"></a></span>
<span id="cb14-883"><a href="#cb14-883"></a>The final light exposure metric we illustrate is the longest continuous period above a certain illuminance threshold (often termed longest period above threshold, e.g. PAT<span class="dt">&lt;</span><span class="kw">sub</span><span class="dt">&gt;</span>1000<span class="dt">&lt;/</span><span class="kw">sub</span><span class="dt">&gt;</span> for 1000&nbsp;lx). This gives us a sense of the longest outdoor exposure in a day. Along with it, one might report the total duration above that threshold in the day (TAT<span class="dt">&lt;</span><span class="kw">sub</span><span class="dt">&gt;</span>1000<span class="dt">&lt;/</span><span class="kw">sub</span><span class="dt">&gt;</span>). While we could derive these from the earlier analyses, LightLogR provides dedicated <span class="co">[</span><span class="ot">metric</span><span class="co">](https://tscnlab.github.io/LightLogR/articles/Metrics.html)</span> functions for such calculations, which can compute multiple related metrics at once. </span>
<span id="cb14-884"><a href="#cb14-884"></a></span>
<span id="cb14-885"><a href="#cb14-885"></a>Using the function <span class="co">[</span><span class="ot">period_above_threshold()</span><span class="co">](https://tscnlab.github.io/LightLogR/reference/period_above_threshold.html)</span> for PAT and <span class="co">[</span><span class="ot">duration_above_threshold()</span><span class="co">](https://tscnlab.github.io/LightLogR/reference/duration_above_threshold.html)</span> for TAT, we calculate both metrics for the 1000&nbsp;lx threshold. @tbl-periodoutdoor shows the mean of these metrics across days (i.e., average longest bright period and average total bright time per day).</span>
<span id="cb14-886"><a href="#cb14-886"></a></span>
<span id="cb14-889"><a href="#cb14-889"></a><span class="in">```{r}</span></span>
<span id="cb14-890"><a href="#cb14-890"></a><span class="co">#| label: tbl-periodoutdoor</span></span>
<span id="cb14-891"><a href="#cb14-891"></a><span class="co">#| filename: Calculate PAT1000 and TAT1000</span></span>
<span id="cb14-892"><a href="#cb14-892"></a><span class="co">#| tbl-cap: "Longest period and total duration illuminance above 1000&nbsp;lx (PAT1000 and TAT1000)"</span></span>
<span id="cb14-893"><a href="#cb14-893"></a>dataVEET <span class="sc">|&gt;</span> </span>
<span id="cb14-894"><a href="#cb14-894"></a>  <span class="fu">summarize</span>(</span>
<span id="cb14-895"><a href="#cb14-895"></a>    <span class="fu">period_above_threshold</span>(</span>
<span id="cb14-896"><a href="#cb14-896"></a>      Lux, Datetime, <span class="at">threshold =</span> <span class="dv">1000</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">as.df =</span> <span class="cn">TRUE</span>),</span>
<span id="cb14-897"><a href="#cb14-897"></a>    <span class="fu">duration_above_threshold</span>(</span>
<span id="cb14-898"><a href="#cb14-898"></a>      Lux, Datetime, <span class="at">threshold =</span> <span class="dv">1000</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">as.df =</span> <span class="cn">TRUE</span>),</span>
<span id="cb14-899"><a href="#cb14-899"></a>    <span class="at">.groups =</span> <span class="st">"keep"</span></span>
<span id="cb14-900"><a href="#cb14-900"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb14-901"><a href="#cb14-901"></a>  <span class="fu">to_mean_daily</span>(<span class="st">""</span>)</span>
<span id="cb14-902"><a href="#cb14-902"></a><span class="in">```</span></span>
<span id="cb14-903"><a href="#cb14-903"></a></span>
<span id="cb14-904"><a href="#cb14-904"></a><span class="fu">#### Merging data streams</span></span>
<span id="cb14-905"><a href="#cb14-905"></a></span>
<span id="cb14-906"><a href="#cb14-906"></a>Note that while imports from different devices can be <span class="co">[</span><span class="ot">merged</span><span class="co">](https://tscnlab.github.io/LightLogR/reference/join_datasets.html)</span>, devices differ in their sensors, electronics, housing or diffuser form factors, and on-device data-processing pipelines. All of these factors affect the comparability of measurements, even when devices output the same variable (e.g., illuminance or distance). If data from different devices with the same measurement variable are to be merged, the corresponding variable names should be standardized beforehand - for example, renaming <span class="in">`Lux`</span> and <span class="in">`LIGHT`</span> to <span class="in">`illuminance`</span>. If we wanted to analyse the <span class="in">`VEET`</span> data together with the <span class="in">`Clouclip`</span> data, for example, we would not have to rename anything, as both carry their illuminance measurements in the variable <span class="in">`Lux`</span>. The following example shows how the combination of datasets would lead to a combined dataset, and how that would affect analysis outcomes. **It is the responsibility of the researcher to perform device calibration and/or checks for a similar measurement fidelity.**</span>
<span id="cb14-907"><a href="#cb14-907"></a></span>
<span id="cb14-910"><a href="#cb14-910"></a><span class="in">```{r}</span></span>
<span id="cb14-911"><a href="#cb14-911"></a><span class="co">#| filename: Merge Clouclip and VEET data</span></span>
<span id="cb14-912"><a href="#cb14-912"></a><span class="co">#| label: tbl-merge</span></span>
<span id="cb14-913"><a href="#cb14-913"></a><span class="co">#| tbl-cap: "Overview of the merged dataset"</span></span>
<span id="cb14-914"><a href="#cb14-914"></a>data <span class="ot">&lt;-</span> <span class="fu">join_datasets</span>(dataCC, dataVEET)</span>
<span id="cb14-915"><a href="#cb14-915"></a>data <span class="sc">|&gt;</span> <span class="fu">summary_overview</span>(Lux, <span class="at">threshold.missing =</span> <span class="fl">0.5</span>) <span class="sc">|&gt;</span> <span class="fu">gt</span>()</span>
<span id="cb14-916"><a href="#cb14-916"></a><span class="in">```</span></span>
<span id="cb14-917"><a href="#cb14-917"></a></span>
<span id="cb14-918"><a href="#cb14-918"></a>We will reuse the example from @sec-avelight, but instead of one participant, we now have data from two devices and participants</span>
<span id="cb14-919"><a href="#cb14-919"></a></span>
<span id="cb14-922"><a href="#cb14-922"></a><span class="in">```{r}</span></span>
<span id="cb14-923"><a href="#cb14-923"></a><span class="co">#| label: tbl-relight</span></span>
<span id="cb14-924"><a href="#cb14-924"></a><span class="co">#| tbl-cap: "Recalculation of the mean light exposure per day (after logarithmic transformation to account for zero inflation and skewness) with the merged dataset"</span></span>
<span id="cb14-925"><a href="#cb14-925"></a><span class="co">#| filename: Re-calculate mean photopic illuminance with the merged dataset</span></span>
<span id="cb14-926"><a href="#cb14-926"></a>data <span class="sc">|&gt;</span> <span class="co"># &lt;1&gt;</span></span>
<span id="cb14-927"><a href="#cb14-927"></a>  <span class="fu">select</span>(Id, Date, Datetime, Lux) <span class="sc">|&gt;</span> <span class="co"># &lt;2&gt;</span></span>
<span id="cb14-928"><a href="#cb14-928"></a>  <span class="fu">mutate</span>(<span class="at">Lux =</span> Lux <span class="sc">|&gt;</span> <span class="fu">log_zero_inflated</span>()) <span class="sc">|&gt;</span> <span class="co"># &lt;2&gt;       </span></span>
<span id="cb14-929"><a href="#cb14-929"></a>  <span class="fu">summarize_numeric</span>(<span class="at">prefix =</span> <span class="st">"mean "</span>, <span class="at">remove =</span> <span class="fu">c</span>(<span class="st">"Datetime"</span>)) <span class="sc">|&gt;</span> <span class="co"># &lt;2&gt;</span></span>
<span id="cb14-930"><a href="#cb14-930"></a>  <span class="fu">mean_daily</span>(<span class="at">prefix =</span> <span class="st">""</span>) <span class="sc">|&gt;</span>                         <span class="co"># &lt;2&gt;</span></span>
<span id="cb14-931"><a href="#cb14-931"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">mean Lux</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">mean Lux</span><span class="st">`</span> <span class="sc">|&gt;</span> <span class="fu">exp_zero_inflated</span>()) <span class="sc">|&gt;</span>  <span class="co"># &lt;2&gt;</span></span>
<span id="cb14-932"><a href="#cb14-932"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span> <span class="fu">fmt_number</span>(<span class="at">decimals =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span> <span class="fu">cols_hide</span>(episodes) <span class="sc">|&gt;</span> <span class="co"># &lt;2&gt;</span></span>
<span id="cb14-933"><a href="#cb14-933"></a>  <span class="fu">cols_label</span>(<span class="st">`</span><span class="at">mean Lux</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"Mean photopic illuminance (lx)"</span>)<span class="co"># &lt;2&gt;</span></span>
<span id="cb14-934"><a href="#cb14-934"></a><span class="in">```</span></span>
<span id="cb14-935"><a href="#cb14-935"></a></span>
<span id="cb14-936"><a href="#cb14-936"></a><span class="ss">1. </span>Instead of <span class="in">`dataVEET`</span> we now supply the merged <span class="in">`data`</span> object</span>
<span id="cb14-937"><a href="#cb14-937"></a><span class="ss">2. </span>Verbatim from @sec-avelight</span>
<span id="cb14-938"><a href="#cb14-938"></a></span>
<span id="cb14-939"><a href="#cb14-939"></a><span class="fu">### Spectrum</span></span>
<span id="cb14-940"><a href="#cb14-940"></a></span>
<span id="cb14-941"><a href="#cb14-941"></a>The <span class="in">`VEET`</span> device’s spectral sensor provides multimodal data beyond simple lux values, but it requires reconstruction of the actual light spectrum from raw sensor counts. We processed the spectral sensor data in order to compute two example spectrum-based metrics. Detailed data import, normalization, and spectral reconstruction steps are given in <span class="co">[</span><span class="ot">Supplement&nbsp;1</span><span class="co">](supplement.qmd)</span>; here we present the resulting metrics. Briefly, the <span class="in">`VEET`</span>’s spectral sensor recorded counts in ten wavelength bands (roughly 415&nbsp;nm to 910&nbsp;nm), plus a <span class="in">`Dark`</span> and a <span class="in">`Clear`</span> channel<span class="ot">[^fw]</span>. After normalizing by sensor gain and applying the calibration matrix, we obtained an estimated spectral irradiance distribution for each 5-minute interval in the recording. With these reconstructed spectra, we can derive novel metrics that consider spectral content of the light. </span>
<span id="cb14-942"><a href="#cb14-942"></a></span>
<span id="cb14-943"><a href="#cb14-943"></a><span class="ot">[^fw]: </span>Note that older firmware versions of the <span class="in">`VEET`</span> prior to *2.1.7* contained two <span class="in">`Clear`</span> channels and the highest spectral channel was indicated as 940&nbsp;nm. Data collected with this early firmware version are not suitable for spectral reconstruction in the context of research projects.</span>
<span id="cb14-944"><a href="#cb14-944"></a></span>
<span id="cb14-945"><a href="#cb14-945"></a>::: {.callout-note}</span>
<span id="cb14-946"><a href="#cb14-946"></a></span>
<span id="cb14-947"><a href="#cb14-947"></a>Spectrum-based metrics in wearable data are relatively new and less established compared to distance or broadband light metrics. The following examples illustrate potential uses of spectral data in a theoretical sense, which can be adapted as needed for specific research questions.</span>
<span id="cb14-948"><a href="#cb14-948"></a></span>
<span id="cb14-949"><a href="#cb14-949"></a>:::</span>
<span id="cb14-950"><a href="#cb14-950"></a></span>
<span id="cb14-951"><a href="#cb14-951"></a><span class="fu">#### Ratio of short- vs. long-wavelength light</span></span>
<span id="cb14-952"><a href="#cb14-952"></a></span>
<span id="cb14-953"><a href="#cb14-953"></a>Our first spectral metric is the ratio of short-wavelength light to long-wavelength light, which is relevant, for example, in assessing the blue-light content of exposure. We define "short" wavelengths as 400–500&nbsp;nm and "long" as 600–700&nbsp;nm (which are not standardized threshold and can be freely adjusted). Using the list-column of spectra in our dataset, we integrate each spectrum over these ranges (using <span class="co">[</span><span class="ot">`spectral_integration()`</span><span class="co">](https://tscnlab.github.io/LightLogR/reference/spectral_integration.html)</span>), and then compute the ratio short/long for each time interval. We then summarize these ratios per day.</span>
<span id="cb14-954"><a href="#cb14-954"></a></span>
<span id="cb14-957"><a href="#cb14-957"></a><span class="in">```{r}</span></span>
<span id="cb14-958"><a href="#cb14-958"></a><span class="co">#| filename: Extract wavelength sections and integrate over them</span></span>
<span id="cb14-959"><a href="#cb14-959"></a>dataVEET <span class="ot">&lt;-</span> dataVEET2 <span class="sc">|&gt;</span> </span>
<span id="cb14-960"><a href="#cb14-960"></a>  <span class="fu">select</span>(Id, Date, Datetime, Spectrum) <span class="sc">|&gt;</span>    <span class="co"># &lt;1&gt;</span></span>
<span id="cb14-961"><a href="#cb14-961"></a>  <span class="fu">mutate</span>(</span>
<span id="cb14-962"><a href="#cb14-962"></a>    <span class="at">short =</span> </span>
<span id="cb14-963"><a href="#cb14-963"></a>      Spectrum <span class="sc">|&gt;</span> <span class="fu">map_dbl</span>(spectral_integration, <span class="at">wavelength.range =</span> <span class="fu">c</span>(<span class="dv">400</span>, <span class="dv">500</span>)),</span>
<span id="cb14-964"><a href="#cb14-964"></a>    <span class="at">long  =</span> </span>
<span id="cb14-965"><a href="#cb14-965"></a>      Spectrum <span class="sc">|&gt;</span> <span class="fu">map_dbl</span>(spectral_integration, <span class="at">wavelength.range =</span> <span class="fu">c</span>(<span class="dv">600</span>, <span class="dv">700</span>)),</span>
<span id="cb14-966"><a href="#cb14-966"></a>    <span class="st">`</span><span class="at">sl ratio</span><span class="st">`</span> <span class="ot">=</span> </span>
<span id="cb14-967"><a href="#cb14-967"></a>      <span class="fu">ifelse</span>(<span class="fu">is.nan</span>(short <span class="sc">/</span> long), <span class="cn">NA</span>, short <span class="sc">/</span> long)   <span class="co"># &lt;2&gt;</span></span>
<span id="cb14-968"><a href="#cb14-968"></a>  )</span>
<span id="cb14-969"><a href="#cb14-969"></a><span class="in">```</span></span>
<span id="cb14-970"><a href="#cb14-970"></a></span>
<span id="cb14-971"><a href="#cb14-971"></a><span class="ss">1. </span>Focus on ID, date, time, and spectrum</span>
<span id="cb14-972"><a href="#cb14-972"></a><span class="ss">2. </span>Compute short-to-long wavelength ratio</span>
<span id="cb14-973"><a href="#cb14-973"></a></span>
<span id="cb14-974"><a href="#cb14-974"></a>@tbl-ratio shows the average short/long wavelength ratio, averaged over each day (and then as weekday/weekend means if applicable). In this dataset, the values give an indication of the spectral balance of the light the individual was exposed to (higher values mean relatively more short-wavelength content).</span>
<span id="cb14-975"><a href="#cb14-975"></a></span>
<span id="cb14-978"><a href="#cb14-978"></a><span class="in">```{r}</span></span>
<span id="cb14-979"><a href="#cb14-979"></a><span class="co">#| label: tbl-ratio</span></span>
<span id="cb14-980"><a href="#cb14-980"></a><span class="co">#| filename: Calculate daily average values of short and long wavelength content</span></span>
<span id="cb14-981"><a href="#cb14-981"></a><span class="co">#| tbl-cap: "Average (mW/m²) and ratio of short-wavelength (400–500&nbsp;nm) to long-wavelength (600–700&nbsp;nm) light"</span></span>
<span id="cb14-982"><a href="#cb14-982"></a>dataVEET <span class="sc">|&gt;</span> </span>
<span id="cb14-983"><a href="#cb14-983"></a>  <span class="fu">summarize_numeric</span>(<span class="at">prefix =</span> <span class="st">""</span>, <span class="at">remove =</span> <span class="fu">c</span>(<span class="st">"Datetime"</span>, <span class="st">"Spectrum"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb14-984"><a href="#cb14-984"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span> </span>
<span id="cb14-985"><a href="#cb14-985"></a>  <span class="fu">fmt_number</span>(<span class="at">decimals =</span> <span class="dv">1</span>, <span class="at">scale_by =</span> <span class="dv">1000</span>) <span class="sc">|&gt;</span></span>
<span id="cb14-986"><a href="#cb14-986"></a>  <span class="fu">fmt_number</span>(<span class="st">`</span><span class="at">sl ratio</span><span class="st">`</span>, <span class="at">decimals =</span> <span class="dv">3</span>) <span class="sc">|&gt;</span></span>
<span id="cb14-987"><a href="#cb14-987"></a>  <span class="fu">cols_hide</span>(episodes)</span>
<span id="cb14-988"><a href="#cb14-988"></a><span class="in">```</span></span>
<span id="cb14-989"><a href="#cb14-989"></a></span>
<span id="cb14-990"><a href="#cb14-990"></a><span class="fu">#### Melanopic daylight efficacy ratio (MDER)</span></span>
<span id="cb14-991"><a href="#cb14-991"></a></span>
<span id="cb14-992"><a href="#cb14-992"></a>The same idea is behind calculating the melanopic daylight efficacy ratio (or MDER), which is defined by the CIE <span class="co">[</span><span class="ot">@CIE_S026_2018</span><span class="co">]</span> as the melanopic EDI divided by the photopic illuminance <span class="co">[</span><span class="ot">@Hartmeyer2023LightResTechnol</span><span class="co">]</span>. Results are shown in @tbl-mder. In this case, instead of a simple integration over a wavelength band, we apply an action spectrum to the spectral power distribution (SPD), integrate over the weighted SPD, and apply a correction factor. All alphaopic action spectra are implemented in the <span class="in">`spectral_integration()`</span> function. These will result in photopic illuminance and melanopic equivalent daylight illuminance (melEDI).</span>
<span id="cb14-993"><a href="#cb14-993"></a></span>
<span id="cb14-996"><a href="#cb14-996"></a><span class="in">```{r}</span></span>
<span id="cb14-997"><a href="#cb14-997"></a><span class="co">#| filename: Calculate melEDI and illumiance</span></span>
<span id="cb14-998"><a href="#cb14-998"></a><span class="co">#| tbl-cap: "Average (mW/m²) and ratio of short-wavelength (400–500&nbsp;nm) to long-wavelength (600–700&nbsp;nm) light"</span></span>
<span id="cb14-999"><a href="#cb14-999"></a>dataVEET <span class="ot">&lt;-</span> </span>
<span id="cb14-1000"><a href="#cb14-1000"></a>  dataVEET <span class="sc">|&gt;</span> </span>
<span id="cb14-1001"><a href="#cb14-1001"></a>  <span class="fu">select</span>(Id, Date, Datetime, Spectrum, short, long, <span class="st">`</span><span class="at">sl ratio</span><span class="st">`</span>) <span class="sc">|&gt;</span></span>
<span id="cb14-1002"><a href="#cb14-1002"></a>  <span class="fu">mutate</span>(</span>
<span id="cb14-1003"><a href="#cb14-1003"></a>    <span class="at">melEDI =</span> <span class="co">#&lt;1&gt;</span></span>
<span id="cb14-1004"><a href="#cb14-1004"></a>      Spectrum <span class="sc">|&gt;</span> <span class="fu">map_dbl</span>(spectral_integration, <span class="at">action.spectrum =</span> <span class="st">"melanopic"</span>),<span class="co">#&lt;1&gt;</span></span>
<span id="cb14-1005"><a href="#cb14-1005"></a>    <span class="at">illuminance  =</span> <span class="co">#&lt;2&gt;</span></span>
<span id="cb14-1006"><a href="#cb14-1006"></a>      Spectrum <span class="sc">|&gt;</span> <span class="fu">map_dbl</span>(spectral_integration, <span class="at">action.spectrum =</span> <span class="st">"photopic"</span>)<span class="co">#&lt;2&gt;</span></span>
<span id="cb14-1007"><a href="#cb14-1007"></a>  )</span>
<span id="cb14-1008"><a href="#cb14-1008"></a><span class="in">```</span></span>
<span id="cb14-1009"><a href="#cb14-1009"></a></span>
<span id="cb14-1010"><a href="#cb14-1010"></a><span class="ss">1.  </span>Calculate melanopic EDI by applying the $s_{mel (\lambda)}$ action spectrum, integrating, and weighing</span>
<span id="cb14-1011"><a href="#cb14-1011"></a><span class="ss">2.  </span>Calculate photopic illuminance by applying the $V_{(\lambda)}$ action spectrum, integrating, and weighing</span>
<span id="cb14-1012"><a href="#cb14-1012"></a></span>
<span id="cb14-1015"><a href="#cb14-1015"></a><span class="in">```{r}</span></span>
<span id="cb14-1016"><a href="#cb14-1016"></a><span class="co">#| label: tbl-mder</span></span>
<span id="cb14-1017"><a href="#cb14-1017"></a><span class="co">#| filename: Calculate MDER</span></span>
<span id="cb14-1018"><a href="#cb14-1018"></a><span class="co">#| tbl-cap: "Average melanopic daylight efficacy ratio (MDER)"</span></span>
<span id="cb14-1019"><a href="#cb14-1019"></a>dataVEET  <span class="sc">|&gt;</span> </span>
<span id="cb14-1020"><a href="#cb14-1020"></a>  <span class="fu">summarize_numeric</span>(<span class="at">prefix =</span> <span class="st">""</span>, <span class="at">remove =</span> <span class="fu">c</span>(<span class="st">"Datetime"</span>, <span class="st">"Spectrum"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb14-1021"><a href="#cb14-1021"></a>  <span class="fu">mutate</span>(<span class="at">MDER =</span> melEDI <span class="sc">/</span> illuminance) <span class="sc">|&gt;</span></span>
<span id="cb14-1022"><a href="#cb14-1022"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span> </span>
<span id="cb14-1023"><a href="#cb14-1023"></a>  <span class="fu">fmt_number</span>(<span class="sc">-</span><span class="st">`</span><span class="at">sl ratio</span><span class="st">`</span>, <span class="at">decimals =</span> <span class="dv">1</span>, <span class="at">scale_by =</span> <span class="dv">1000</span>) <span class="sc">|&gt;</span></span>
<span id="cb14-1024"><a href="#cb14-1024"></a>  <span class="fu">fmt_number</span>(<span class="fu">c</span>(MDER, <span class="st">`</span><span class="at">sl ratio</span><span class="st">`</span>), <span class="at">decimals =</span> <span class="dv">3</span>) <span class="sc">|&gt;</span></span>
<span id="cb14-1025"><a href="#cb14-1025"></a>  <span class="fu">cols_hide</span>(episodes)</span>
<span id="cb14-1026"><a href="#cb14-1026"></a><span class="in">```</span></span>
<span id="cb14-1027"><a href="#cb14-1027"></a></span>
<span id="cb14-1028"><a href="#cb14-1028"></a><span class="fu">#### Short-wavelength light at specific times of day</span></span>
<span id="cb14-1029"><a href="#cb14-1029"></a></span>
<span id="cb14-1030"><a href="#cb14-1030"></a>The third spectral example examines short-wavelength light exposure as a function of time of day. Certain studies might be interested in, for instance, blue-light exposure during midday versus morning or night. We demonstrate three approaches: (a) filtering the data to a specific local time window, and (b) aggregating by hour of day to see a daily profile of short-wavelength exposure. Additionally, we (c) look at differences between day and night periods. </span>
<span id="cb14-1031"><a href="#cb14-1031"></a></span>
<span id="cb14-1032"><a href="#cb14-1032"></a>::: panel-tabset</span>
<span id="cb14-1033"><a href="#cb14-1033"></a><span class="fu">##### Local morning exposure</span></span>
<span id="cb14-1034"><a href="#cb14-1034"></a></span>
<span id="cb14-1035"><a href="#cb14-1035"></a>@tbl-shortfilter isolates the time window between 7:00 and 11:00 each day and computes the average short-wavelength irradiance in that interval. This represents a straightforward query: “How much blue light does the subject get in the morning on average?”</span>
<span id="cb14-1036"><a href="#cb14-1036"></a></span>
<span id="cb14-1039"><a href="#cb14-1039"></a><span class="in">```{r}</span></span>
<span id="cb14-1040"><a href="#cb14-1040"></a><span class="co">#| label: tbl-shortfilter</span></span>
<span id="cb14-1041"><a href="#cb14-1041"></a><span class="co">#| filename: Calculate short-wavelength light before noon</span></span>
<span id="cb14-1042"><a href="#cb14-1042"></a><span class="co">#| tbl-cap: "Average short-wavelength light (400–500&nbsp;nm) exposure between 7:00 and 11:00 each day"</span></span>
<span id="cb14-1043"><a href="#cb14-1043"></a>dataVEET <span class="sc">|&gt;</span> </span>
<span id="cb14-1044"><a href="#cb14-1044"></a>  <span class="fu">filter_Time</span>(<span class="at">start =</span> <span class="st">"7:00:00"</span>, <span class="at">end =</span> <span class="st">"11:00:00"</span>) <span class="sc">|&gt;</span>    <span class="co">#&lt;1&gt;</span></span>
<span id="cb14-1045"><a href="#cb14-1045"></a>  <span class="fu">select</span>(<span class="fu">c</span>(Id, Date, short)) <span class="sc">|&gt;</span></span>
<span id="cb14-1046"><a href="#cb14-1046"></a>  <span class="fu">summarize_numeric</span>(<span class="at">prefix =</span> <span class="st">""</span>) <span class="sc">|&gt;</span> </span>
<span id="cb14-1047"><a href="#cb14-1047"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span> </span>
<span id="cb14-1048"><a href="#cb14-1048"></a>  <span class="fu">fmt_number</span>(short, <span class="at">scale_by =</span> <span class="dv">1000</span>) <span class="sc">|&gt;</span> </span>
<span id="cb14-1049"><a href="#cb14-1049"></a>  <span class="fu">cols_label</span>(<span class="at">short =</span> <span class="st">"Short-wavelength irradiance (mW/m²)"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb14-1050"><a href="#cb14-1050"></a>  <span class="fu">cols_hide</span>(episodes)</span>
<span id="cb14-1051"><a href="#cb14-1051"></a><span class="in">```</span></span>
<span id="cb14-1052"><a href="#cb14-1052"></a></span>
<span id="cb14-1053"><a href="#cb14-1053"></a><span class="ss">1. </span>Filter data to local 7am–11am</span>
<span id="cb14-1054"><a href="#cb14-1054"></a></span>
<span id="cb14-1055"><a href="#cb14-1055"></a><span class="fu">##### Hourly profile across the day</span></span>
<span id="cb14-1056"><a href="#cb14-1056"></a></span>
<span id="cb14-1057"><a href="#cb14-1057"></a>To visualize short-wavelength exposure over the course of a day, we aggregate the data into hourly bins. We cut the timeline into 1-hour segments (using local time), compute the mean short-wavelength irradiance in each hour for each day. @fig-shorttime shows the resulting diurnal profile, with short-wavelength exposure expressed as a fraction of the daily maximum for easier comparison.</span>
<span id="cb14-1058"><a href="#cb14-1058"></a></span>
<span id="cb14-1061"><a href="#cb14-1061"></a><span class="in">```{r}</span></span>
<span id="cb14-1062"><a href="#cb14-1062"></a><span class="co">#| label: fig-shorttime</span></span>
<span id="cb14-1063"><a href="#cb14-1063"></a><span class="co">#| filename: Plot a diurnal profile</span></span>
<span id="cb14-1064"><a href="#cb14-1064"></a><span class="co">#| fig-cap: "Diurnal profile of short-wavelength light exposure. Each bar represents the average short-wavelength irradiance at that hour of the day (0–23 h), normalized to the daily maximum."</span></span>
<span id="cb14-1065"><a href="#cb14-1065"></a>dataVEETtime <span class="ot">&lt;-</span> dataVEET <span class="sc">|&gt;</span> <span class="co">#&lt;1&gt;</span></span>
<span id="cb14-1066"><a href="#cb14-1066"></a>  <span class="fu">cut_Datetime</span>(<span class="at">unit =</span> <span class="st">"1 hour"</span>, <span class="at">type =</span> <span class="st">"floor"</span>, <span class="at">group_by =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span>  <span class="co">#&lt;2&gt;</span></span>
<span id="cb14-1067"><a href="#cb14-1067"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(Spectrum, long, Datetime)) <span class="sc">|&gt;</span></span>
<span id="cb14-1068"><a href="#cb14-1068"></a>  <span class="fu">summarize_numeric</span>(<span class="at">prefix =</span> <span class="st">""</span>) <span class="sc">|&gt;</span> </span>
<span id="cb14-1069"><a href="#cb14-1069"></a>  <span class="fu">add_Time_col</span>(Datetime.rounded)  <span class="sc">|&gt;</span>   <span class="co"># &lt;3&gt;</span></span>
<span id="cb14-1070"><a href="#cb14-1070"></a>  <span class="fu">mutate</span>(<span class="at">rel_short =</span> short <span class="sc">/</span> <span class="fu">max</span>(short))</span>
<span id="cb14-1071"><a href="#cb14-1071"></a></span>
<span id="cb14-1072"><a href="#cb14-1072"></a>dataVEETtime <span class="sc">|&gt;</span> <span class="co">#&lt;4&gt;</span></span>
<span id="cb14-1073"><a href="#cb14-1073"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>Time, <span class="at">y =</span> rel_short)) <span class="sc">+</span></span>
<span id="cb14-1074"><a href="#cb14-1074"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">factor</span>(Date)), <span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb14-1075"><a href="#cb14-1075"></a>  ggsci<span class="sc">::</span><span class="fu">scale_fill_jco</span>() <span class="sc">+</span></span>
<span id="cb14-1076"><a href="#cb14-1076"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb14-1077"><a href="#cb14-1077"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Normalized short-wavelength irradiance"</span>, </span>
<span id="cb14-1078"><a href="#cb14-1078"></a>       <span class="at">x =</span> <span class="st">"Local time (HH:MM)"</span>,</span>
<span id="cb14-1079"><a href="#cb14-1079"></a>       <span class="at">fill =</span> <span class="st">"Date"</span>) <span class="sc">+</span> </span>
<span id="cb14-1080"><a href="#cb14-1080"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_percent</span>()) <span class="sc">+</span></span>
<span id="cb14-1081"><a href="#cb14-1081"></a>  <span class="fu">scale_x_time</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_time</span>(<span class="at">format =</span> <span class="st">"%H:%M"</span>))</span>
<span id="cb14-1082"><a href="#cb14-1082"></a><span class="in">```</span></span>
<span id="cb14-1083"><a href="#cb14-1083"></a></span>
<span id="cb14-1084"><a href="#cb14-1084"></a><span class="ss">1. </span>Prepare hourly binned data</span>
<span id="cb14-1085"><a href="#cb14-1085"></a><span class="ss">2. </span>Bin timestamps by hour</span>
<span id="cb14-1086"><a href="#cb14-1086"></a><span class="ss">3. </span>Add a Time column (hour of day)</span>
<span id="cb14-1087"><a href="#cb14-1087"></a><span class="ss">4. </span>Creating the plot</span>
<span id="cb14-1088"><a href="#cb14-1088"></a></span>
<span id="cb14-1091"><a href="#cb14-1091"></a><span class="in">```{r}</span></span>
<span id="cb14-1092"><a href="#cb14-1092"></a><span class="co">#| echo: false</span></span>
<span id="cb14-1093"><a href="#cb14-1093"></a><span class="co">#| output: false</span></span>
<span id="cb14-1094"><a href="#cb14-1094"></a><span class="fu">ggsave</span>(<span class="st">"manuscript/figures/Figure9.png"</span>,</span>
<span id="cb14-1095"><a href="#cb14-1095"></a>                <span class="at">width =</span> <span class="dv">5</span>,</span>
<span id="cb14-1096"><a href="#cb14-1096"></a>                <span class="at">height =</span> <span class="dv">4</span>)</span>
<span id="cb14-1097"><a href="#cb14-1097"></a><span class="in">```</span></span>
<span id="cb14-1098"><a href="#cb14-1098"></a></span>
<span id="cb14-1099"><a href="#cb14-1099"></a></span>
<span id="cb14-1100"><a href="#cb14-1100"></a><span class="fu">##### Day vs. night (photoperiod)</span></span>
<span id="cb14-1101"><a href="#cb14-1101"></a></span>
<span id="cb14-1102"><a href="#cb14-1102"></a>Finally, we compare short-wavelength exposure during daytime vs. nighttime. Using civil dawn and dusk information (based on geographic coordinates, here set for Houston, TX, USA), we label each measurement as day or night and then compute the total short-wavelength exposure in each period. @tbl-daytime summarizes the daily short-wavelength dose received during the day vs. during the night.</span>
<span id="cb14-1103"><a href="#cb14-1103"></a></span>
<span id="cb14-1106"><a href="#cb14-1106"></a><span class="in">```{r}</span></span>
<span id="cb14-1107"><a href="#cb14-1107"></a><span class="co">#| label: tbl-daytime</span></span>
<span id="cb14-1108"><a href="#cb14-1108"></a><span class="co">#| filename: Calculate photoperiod dependent measures</span></span>
<span id="cb14-1109"><a href="#cb14-1109"></a><span class="co">#| tbl-cap: "Short wavelength light exposure (mW/m²) during the day and at night"</span></span>
<span id="cb14-1110"><a href="#cb14-1110"></a>dataVEET <span class="sc">|&gt;</span></span>
<span id="cb14-1111"><a href="#cb14-1111"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(Spectrum, long, <span class="st">`</span><span class="at">sl ratio</span><span class="st">`</span>, melEDI, illuminance)) <span class="sc">|&gt;</span></span>
<span id="cb14-1112"><a href="#cb14-1112"></a>  <span class="fu">add_photoperiod</span>(coordinates) <span class="sc">|&gt;</span> </span>
<span id="cb14-1113"><a href="#cb14-1113"></a>  <span class="fu">group_by</span>(photoperiod.state, <span class="at">.add =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb14-1114"><a href="#cb14-1114"></a>  <span class="fu">summarize_numeric</span>(<span class="at">prefix =</span> <span class="st">""</span>, </span>
<span id="cb14-1115"><a href="#cb14-1115"></a>                    <span class="at">remove =</span> <span class="fu">c</span>(<span class="st">"dawn"</span>, <span class="st">"dusk"</span>, <span class="st">"photoperiod"</span>, <span class="st">"Datetime"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb14-1116"><a href="#cb14-1116"></a>  <span class="fu">group_by</span>(Id, photoperiod.state) <span class="sc">|&gt;</span> </span>
<span id="cb14-1117"><a href="#cb14-1117"></a>  <span class="fu">select</span>(<span class="sc">-</span>episodes) <span class="sc">|&gt;</span> </span>
<span id="cb14-1118"><a href="#cb14-1118"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span>photoperiod.state, <span class="at">values_from =</span> short) <span class="sc">|&gt;</span> </span>
<span id="cb14-1119"><a href="#cb14-1119"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span> </span>
<span id="cb14-1120"><a href="#cb14-1120"></a>  <span class="fu">fmt_number</span>(<span class="at">scale_by =</span> <span class="dv">1000</span>, <span class="at">decimals =</span> <span class="dv">1</span>)</span>
<span id="cb14-1121"><a href="#cb14-1121"></a><span class="in">```</span></span>
<span id="cb14-1122"><a href="#cb14-1122"></a></span>
<span id="cb14-1123"><a href="#cb14-1123"></a>::: {.callout-note}</span>
<span id="cb14-1124"><a href="#cb14-1124"></a></span>
<span id="cb14-1125"><a href="#cb14-1125"></a>In the code cell above, <span class="in">`add_photoperiod(coordinates)`</span> is used as a convenient way to add columns to the data frame, indicating for each timestamp whether it was day or night, given the latitude/longitude.</span>
<span id="cb14-1126"><a href="#cb14-1126"></a></span>
<span id="cb14-1127"><a href="#cb14-1127"></a>:::</span>
<span id="cb14-1128"><a href="#cb14-1128"></a></span>
<span id="cb14-1129"><a href="#cb14-1129"></a>:::</span>
<span id="cb14-1130"><a href="#cb14-1130"></a></span>
<span id="cb14-1131"><a href="#cb14-1131"></a><span class="fu">## Discussion and conclusion</span></span>
<span id="cb14-1132"><a href="#cb14-1132"></a></span>
<span id="cb14-1133"><a href="#cb14-1133"></a>This tutorial demonstrates a standardized, step-by-step pipeline to calculate a variety of visual experience metrics. We illustrated how a combination of LightLogR functions and tidyverse workflows can yield clear and reproducible analyses for wearable device data. While the full pipeline is detailed, each metric is computed through a dedicated sequence of well-documented steps, yet remains configurable to realize different metric definitions or thresholds. </span>
<span id="cb14-1134"><a href="#cb14-1134"></a></span>
<span id="cb14-1135"><a href="#cb14-1135"></a>By leveraging LightLogR’s framework alongside common data analysis approaches, the process remains transparent and relatively easy to follow. The overall goal is to make analysis transparent (with open-source functions), accessible (through thorough documentation, tutorials, and human-readable function naming, all under an MIT license), robust (the package includes &gt;900 unit tests and continuous integration with bug tracking on GitHub), and community-driven (open feature requests and contributions via GitHub).</span>
<span id="cb14-1136"><a href="#cb14-1136"></a></span>
<span id="cb14-1137"><a href="#cb14-1137"></a>Even with standardized pipelines, researchers must still make and document many decisions during data cleaning, time-series handling, and metric calculations — especially for complex metrics that involve grouping data in multiple ways (for example, grouping by distance range as well as by duration for cluster metrics). We have highlighted these decision points in the tutorial (such as how to handle irregular intervals, choosing thresholds for “near” distances or “outdoor” light, and deciding on minimum durations for sustained events). Explicitly considering and reporting these choices is important for reproducibility and for comparing results across studies.</span>
<span id="cb14-1138"><a href="#cb14-1138"></a></span>
<span id="cb14-1139"><a href="#cb14-1139"></a>The broad set of features in LightLogR — ranging from data import and cleaning tools (for handling time gaps and irregularities) to visualization functions and metric calculators — make it a powerful toolkit for visual experience research. Our examples spanned circadian-light metrics and myopia-related metrics, demonstrating the versatility of a unified analysis approach. By using community-supported tools and workflows, researchers in vision science, chronobiology, myopia, and related fields can reduce time spent on low-level data wrangling and focus more on interpreting results and advancing scientific understanding.</span>
<span id="cb14-1140"><a href="#cb14-1140"></a></span>
<span id="cb14-1141"><a href="#cb14-1141"></a><span class="fu">## Session info {#sessioninfo}</span></span>
<span id="cb14-1142"><a href="#cb14-1142"></a></span>
<span id="cb14-1145"><a href="#cb14-1145"></a><span class="in">```{r}</span></span>
<span id="cb14-1146"><a href="#cb14-1146"></a><span class="fu">sessionInfo</span>()</span>
<span id="cb14-1147"><a href="#cb14-1147"></a><span class="in">```</span></span>
<span id="cb14-1148"><a href="#cb14-1148"></a></span>
<span id="cb14-1149"><a href="#cb14-1149"></a><span class="fu">## Statements</span></span>
<span id="cb14-1150"><a href="#cb14-1150"></a></span>
<span id="cb14-1151"><a href="#cb14-1151"></a><span class="fu">### Data availability statement</span></span>
<span id="cb14-1152"><a href="#cb14-1152"></a></span>
<span id="cb14-1153"><a href="#cb14-1153"></a>All data and code in this tutorial and Supplement 1 are available from the GitHub repository: https://github.com/tscnlab/ZaunerEtAl_JVis_2026/, archived on Zenodo: https://doi.org/10.5281/zenodo.16566014 under a MIT license (data under CC-BY license).</span>
<span id="cb14-1154"><a href="#cb14-1154"></a></span>
<span id="cb14-1155"><a href="#cb14-1155"></a><span class="fu">### Funding statement</span></span>
<span id="cb14-1156"><a href="#cb14-1156"></a></span>
<span id="cb14-1157"><a href="#cb14-1157"></a>JZ's position is funded by the MeLiDos project. The project has received funding from the European Partnership on Metrology (22NRM05 MeLiDos), co-financed from the European Union’s Horizon Europe Research and Innovation Programme and by the Participating States. Views and opinions expressed are however those of the author(s) only and do not necessarily reflect those of the European Union or EURAMET. Neither the European Union nor the granting authority can be held responsible for them. JZ, LAO, and MS received research funding from Reality Labs Research. The funders had no role in study design, data collection and analysis, decision to publish or preparation of the manuscript.</span>
<span id="cb14-1158"><a href="#cb14-1158"></a></span>
<span id="cb14-1159"><a href="#cb14-1159"></a><span class="fu">### Conflict of interest statement</span></span>
<span id="cb14-1160"><a href="#cb14-1160"></a></span>
<span id="cb14-1161"><a href="#cb14-1161"></a>JZ declares the following potential conflict of interest in the past five years (2021-2025). Funding: Received research funding from Reality Labs Research.</span>
<span id="cb14-1162"><a href="#cb14-1162"></a></span>
<span id="cb14-1163"><a href="#cb14-1163"></a>AN declares the following potential conflicts of interest in the past five years (2021-2025). none</span>
<span id="cb14-1164"><a href="#cb14-1164"></a></span>
<span id="cb14-1165"><a href="#cb14-1165"></a>LAO declares the following potential conflict of interest in the past five years (2021-2025). Consultancy: Zeiss, Alcon, EssilorLuxottica; Research support: Topcon, Meta, LLC; Patents: US 11375890 B2</span>
<span id="cb14-1166"><a href="#cb14-1166"></a></span>
<span id="cb14-1167"><a href="#cb14-1167"></a>MS declares the following potential conflicts of interest in the past five years (2021–2025). Academic roles: Member of the Board of Directors, Society of Light, Rhythms, and Circadian Health (SLRCH); Chair of Joint Technical Committee 20 (JTC20) of the International Commission on Illumination (CIE); Member of the Daylight Academy; Chair of Research Data Alliance Working Group Optical Radiation and Visual Experience Data. Remunerated roles: Speaker of the Steering Committee of the Daylight Academy; Ad-hoc reviewer for the Health and Digital Executive Agency of the European Commission; Ad-hoc reviewer for the Swedish Research Council; Associate Editor for LEUKOS, journal of the Illuminating Engineering Society; Examiner, University of Manchester; Examiner, Flinders University; Examiner, University of Southern Norway. Funding: Received research funding and support from the Max Planck Society, Max Planck Foundation, Max Planck Innovation, Technical University of Munich, Wellcome Trust, National Research Foundation Singapore, European Partnership on Metrology, VELUX Foundation, Bayerisch-Tschechische Hochschulagentur (BTHA), BayFrance (Bayerisch-Französisches Hochschulzentrum), BayFOR (Bayerische Forschungsallianz), and Reality Labs Research. Honoraria for talks: Received honoraria from the ISGlobal, Research Foundation of the City University of New York and the Stadt Ebersberg, Museum Wald und Umwelt. Travel reimbursements: Daimler und Benz Stiftung. Patents: Named on European Patent Application EP23159999.4A (“System and method for corneal-plane physiologically-relevant light logging with an application to personalized light interventions related to health and well-being”). With the exception of the funding source supporting this work, M.S. declares no influence of the disclosed roles or relationships on the work presented herein.</span>
<span id="cb14-1168"><a href="#cb14-1168"></a></span>
<span id="cb14-1169"><a href="#cb14-1169"></a><span class="fu">### Statement of generative AI and AI-assisted technologies in the writing process</span></span>
<span id="cb14-1170"><a href="#cb14-1170"></a></span>
<span id="cb14-1171"><a href="#cb14-1171"></a>The authors used ChatGPT during the preparation of this work. After using this tool, the authors reviewed and edited the content as needed and take full responsibility for the content of the publication.</span>
<span id="cb14-1172"><a href="#cb14-1172"></a></span>
<span id="cb14-1173"><a href="#cb14-1173"></a>Use of AI in contributor roles <span class="ot">[^3]</span>:</span>
<span id="cb14-1174"><a href="#cb14-1174"></a>Conceptualization: no</span>
<span id="cb14-1175"><a href="#cb14-1175"></a>Data curation: no</span>
<span id="cb14-1176"><a href="#cb14-1176"></a>Formal analysis: bug fixing</span>
<span id="cb14-1177"><a href="#cb14-1177"></a>Methodology: no</span>
<span id="cb14-1178"><a href="#cb14-1178"></a>Software: bug fixing</span>
<span id="cb14-1179"><a href="#cb14-1179"></a>Validation: no</span>
<span id="cb14-1180"><a href="#cb14-1180"></a>Visualization: tweaking of options</span>
<span id="cb14-1181"><a href="#cb14-1181"></a>Writing – original draft: abstract refinement</span>
<span id="cb14-1182"><a href="#cb14-1182"></a>Writing – review &amp; editing: improve readability and language</span>
<span id="cb14-1183"><a href="#cb14-1183"></a></span>
<span id="cb14-1184"><a href="#cb14-1184"></a><span class="ot">[^3]: </span>Based on the CRediT taxonomy. Funding acquisition, investigation, project administration, resources, and supervision were deemed irrelevant in this context and thus removed.</span>
<span id="cb14-1185"><a href="#cb14-1185"></a></span>
<span id="cb14-1186"><a href="#cb14-1186"></a><span class="fu">## References</span></span>
</code></pre></div><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/tscnlab/ZaunerEtAl_JVis_2026/edit/main/index.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/tscnlab/ZaunerEtAl_JVis_2026/issues" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div></div></footer><script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




</body></html>